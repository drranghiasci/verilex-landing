"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/intake/submit";
exports.ids = ["pages/api/intake/submit"];
exports.modules = {

/***/ "(api-node)/../../lib/intake/normalizePayload.ts":
/*!********************************************!*\
  !*** ../../lib/intake/normalizePayload.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   normalizePayloadToDocxV1: () => (/* binding */ normalizePayloadToDocxV1)\n/* harmony export */ });\n/* harmony import */ var _schema_gaDivorceCustodyV1__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./schema/gaDivorceCustodyV1 */ \"(api-node)/../../lib/intake/schema/gaDivorceCustodyV1.ts\");\n\nconst canonicalKeys = new Set(_schema_gaDivorceCustodyV1__WEBPACK_IMPORTED_MODULE_0__.GA_DIVORCE_CUSTODY_V1.sections.flatMap((section)=>section.fields.map((field)=>field.key)));\nfunction isPlainObject(value) {\n    return Boolean(value) && typeof value === 'object' && !Array.isArray(value);\n}\nfunction toTrimmedString(value) {\n    if (typeof value !== 'string') return undefined;\n    const trimmed = value.trim();\n    return trimmed.length > 0 ? trimmed : undefined;\n}\nfunction buildAddressValue(value, extras) {\n    const address = {};\n    if (isPlainObject(value)) {\n        const record = value;\n        const fields = [\n            'line1',\n            'line2',\n            'city',\n            'state',\n            'zip'\n        ];\n        for (const field of fields){\n            const entry = toTrimmedString(record[field]);\n            if (entry) address[field] = entry;\n        }\n        if (!address.line1) {\n            const freeform = toTrimmedString(record.freeform);\n            if (freeform) address.line1 = freeform;\n        }\n    } else {\n        const line1 = toTrimmedString(value);\n        if (line1) address.line1 = line1;\n    }\n    if (extras) {\n        const city = toTrimmedString(extras.city);\n        const state = toTrimmedString(extras.state);\n        const zip = toTrimmedString(extras.zip);\n        if (city && !address.city) address.city = city;\n        if (state && !address.state) address.state = state;\n        if (zip && !address.zip) address.zip = zip;\n    }\n    return Object.keys(address).length > 0 ? address : null;\n}\nfunction normalizePayloadToDocxV1(input) {\n    if (!isPlainObject(input)) return {};\n    const payload = input;\n    const result = {};\n    const legacyNotes = {\n        ...isPlainObject(payload._legacy) ? payload._legacy : {},\n        ...isPlainObject(payload._legacy_notes) ? payload._legacy_notes : {}\n    };\n    const addLegacy = (key, value)=>{\n        if (value === undefined) return;\n        if (legacyNotes[key] === undefined) {\n            legacyNotes[key] = value;\n        }\n    };\n    for (const [key, value] of Object.entries(payload)){\n        if (canonicalKeys.has(key)) {\n            result[key] = value;\n        }\n    }\n    if (result.opposing_address_known === undefined && payload.opposing_known_address !== undefined) {\n        result.opposing_address_known = payload.opposing_known_address;\n    }\n    if (result.opposing_last_known_address === undefined) {\n        const address = buildAddressValue(payload.opposing_address);\n        if (address) result.opposing_last_known_address = address;\n    } else if (isPlainObject(result.opposing_last_known_address) && payload.opposing_address) {\n        const address = buildAddressValue(payload.opposing_address);\n        if (address) {\n            result.opposing_last_known_address = {\n                ...address,\n                ...result.opposing_last_known_address\n            };\n        }\n    }\n    if (result.client_address === undefined) {\n        const address = buildAddressValue(payload.client_address, {\n            city: payload.client_city,\n            state: payload.client_state,\n            zip: payload.client_zip\n        });\n        if (address) result.client_address = address;\n    } else if (isPlainObject(result.client_address)) {\n        const address = buildAddressValue(payload.client_address, {\n            city: payload.client_city,\n            state: payload.client_state,\n            zip: payload.client_zip\n        });\n        if (address) {\n            result.client_address = {\n                ...address,\n                ...result.client_address\n            };\n        }\n    }\n    if (result.special_needs === undefined && payload.child_special_needs !== undefined) {\n        result.special_needs = payload.child_special_needs;\n    }\n    if (result.prior_custody_orders === undefined && payload.prior_custody_cases !== undefined) {\n        result.prior_custody_orders = payload.prior_custody_cases;\n    }\n    if (result.amount === undefined && payload.estimated_balance !== undefined) {\n        result.amount = payload.estimated_balance;\n    }\n    if (result.opposing_income_known === undefined && payload.opposing_income_estimated !== undefined) {\n        const estimate = payload.opposing_income_estimated;\n        if (typeof estimate === 'number' && !Number.isNaN(estimate)) {\n            result.opposing_income_known = true;\n            addLegacy('opposing_income_estimated', estimate);\n        } else {\n            addLegacy('opposing_income_estimated', estimate);\n        }\n    }\n    if (result.support_requested === undefined && typeof payload.support_type === 'string') {\n        result.support_requested = payload.support_type;\n    }\n    if (typeof payload.support_requested === 'boolean') {\n        addLegacy('support_requested_boolean', payload.support_requested);\n        if (typeof result.support_requested !== 'string') {\n            result.support_requested = null;\n        }\n    }\n    if (payload.opposing_phone !== undefined) addLegacy('opposing_phone', payload.opposing_phone);\n    if (payload.opposing_email !== undefined) addLegacy('opposing_email', payload.opposing_email);\n    if (payload.marriage_notes !== undefined) addLegacy('marriage_notes', payload.marriage_notes);\n    if (payload.fault_ground_detail !== undefined) addLegacy('fault_ground_detail', payload.fault_ground_detail);\n    if (payload.separation_status !== undefined) addLegacy('separation_status', payload.separation_status);\n    if (payload.child_school_info !== undefined) addLegacy('child_school_info', payload.child_school_info);\n    if (payload.current_order_exists !== undefined) addLegacy('current_order_exists', payload.current_order_exists);\n    if (payload.other_parent_involvement !== undefined) {\n        addLegacy('other_parent_involvement', payload.other_parent_involvement);\n    }\n    if (payload.asset_description !== undefined) addLegacy('asset_description', payload.asset_description);\n    if (payload.documentation_provided !== undefined) {\n        addLegacy('documentation_provided', payload.documentation_provided);\n    }\n    if (payload.ownership_dispute !== undefined) addLegacy('ownership_dispute', payload.ownership_dispute);\n    if (payload.income_notes !== undefined) addLegacy('income_notes', payload.income_notes);\n    if (payload.debt_description !== undefined) addLegacy('debt_description', payload.debt_description);\n    if (payload.estimated_balance !== undefined) addLegacy('estimated_balance', payload.estimated_balance);\n    if (payload.joint_debt !== undefined) addLegacy('joint_debt', payload.joint_debt);\n    if (payload.dv_description !== undefined) addLegacy('dv_description', payload.dv_description);\n    if (payload.weapons_present !== undefined) addLegacy('weapons_present', payload.weapons_present);\n    if (payload.venue_notes !== undefined) addLegacy('venue_notes', payload.venue_notes);\n    if (payload.prior_protective_orders !== undefined) {\n        addLegacy('prior_protective_orders', payload.prior_protective_orders);\n    }\n    if (payload.prior_case_notes !== undefined) addLegacy('prior_case_notes', payload.prior_case_notes);\n    if (payload.desired_custody_outcome !== undefined) {\n        addLegacy('desired_custody_outcome', payload.desired_custody_outcome);\n    }\n    if (payload.desired_property_outcome !== undefined) {\n        addLegacy('desired_property_outcome', payload.desired_property_outcome);\n    }\n    if (payload.other_requests !== undefined) addLegacy('other_requests', payload.other_requests);\n    if (payload.uploaded_document_links !== undefined) {\n        addLegacy('uploaded_document_links', payload.uploaded_document_links);\n    }\n    if (payload.evidence_notes !== undefined) addLegacy('evidence_notes', payload.evidence_notes);\n    if (payload.client_city !== undefined) addLegacy('client_city', payload.client_city);\n    if (payload.client_state !== undefined) addLegacy('client_state', payload.client_state);\n    if (payload.client_zip !== undefined) addLegacy('client_zip', payload.client_zip);\n    if (payload.opposing_known_address !== undefined) {\n        addLegacy('opposing_known_address', payload.opposing_known_address);\n    }\n    if (payload.opposing_address !== undefined) addLegacy('opposing_address', payload.opposing_address);\n    for (const [key, value] of Object.entries(payload)){\n        if (!canonicalKeys.has(key) && key !== '_legacy_notes' && key !== '_legacy') {\n            addLegacy(key, value);\n        }\n    }\n    if (Object.keys(legacyNotes).length > 0) {\n        result._legacy = legacyNotes;\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9saWIvaW50YWtlL25vcm1hbGl6ZVBheWxvYWQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBb0U7QUFJcEUsTUFBTUMsZ0JBQWdCLElBQUlDLElBQ3hCRiw2RUFBcUJBLENBQUNHLFFBQVEsQ0FBQ0MsT0FBTyxDQUFDLENBQUNDLFVBQVlBLFFBQVFDLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLFFBQVVBLE1BQU1DLEdBQUc7QUFHN0YsU0FBU0MsY0FBY0MsS0FBYztJQUNuQyxPQUFPQyxRQUFRRCxVQUFVLE9BQU9BLFVBQVUsWUFBWSxDQUFDRSxNQUFNQyxPQUFPLENBQUNIO0FBQ3ZFO0FBRUEsU0FBU0ksZ0JBQWdCSixLQUFjO0lBQ3JDLElBQUksT0FBT0EsVUFBVSxVQUFVLE9BQU9LO0lBQ3RDLE1BQU1DLFVBQVVOLE1BQU1PLElBQUk7SUFDMUIsT0FBT0QsUUFBUUUsTUFBTSxHQUFHLElBQUlGLFVBQVVEO0FBQ3hDO0FBRUEsU0FBU0ksa0JBQWtCVCxLQUFjLEVBQUVVLE1BQWdDO0lBQ3pFLE1BQU1DLFVBQWtDLENBQUM7SUFDekMsSUFBSVosY0FBY0MsUUFBUTtRQUN4QixNQUFNWSxTQUFTWjtRQUNmLE1BQU1MLFNBQVM7WUFBQztZQUFTO1lBQVM7WUFBUTtZQUFTO1NBQU07UUFDekQsS0FBSyxNQUFNRSxTQUFTRixPQUFRO1lBQzFCLE1BQU1rQixRQUFRVCxnQkFBZ0JRLE1BQU0sQ0FBQ2YsTUFBTTtZQUMzQyxJQUFJZ0IsT0FBT0YsT0FBTyxDQUFDZCxNQUFNLEdBQUdnQjtRQUM5QjtRQUNBLElBQUksQ0FBQ0YsUUFBUUcsS0FBSyxFQUFFO1lBQ2xCLE1BQU1DLFdBQVdYLGdCQUFnQlEsT0FBT0csUUFBUTtZQUNoRCxJQUFJQSxVQUFVSixRQUFRRyxLQUFLLEdBQUdDO1FBQ2hDO0lBQ0YsT0FBTztRQUNMLE1BQU1ELFFBQVFWLGdCQUFnQko7UUFDOUIsSUFBSWMsT0FBT0gsUUFBUUcsS0FBSyxHQUFHQTtJQUM3QjtJQUVB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QUFVLGNBQWNMLFFBQVFlLFVBQVU7SUFDaEYsSUFBSWYsUUFBUVMsc0JBQXNCLEtBQUszQixXQUFXO1FBQ2hEdUIsVUFBVSwwQkFBMEJMLFFBQVFTLHNCQUFzQjtJQUNwRTtJQUNBLElBQUlULFFBQVFXLGdCQUFnQixLQUFLN0IsV0FBV3VCLFVBQVUsb0JBQW9CTCxRQUFRVyxnQkFBZ0I7SUFFbEcsS0FBSyxNQUFNLENBQUNwQyxLQUFLRSxNQUFNLElBQUltQixPQUFPVSxPQUFPLENBQUNOLFNBQVU7UUFDbEQsSUFBSSxDQUFDakMsY0FBY3dDLEdBQUcsQ0FBQ2hDLFFBQVFBLFFBQVEsbUJBQW1CQSxRQUFRLFdBQVc7WUFDM0U4QixVQUFVOUIsS0FBS0U7UUFDakI7SUFDRjtJQUVBLElBQUltQixPQUFPQyxJQUFJLENBQUNLLGFBQWFqQixNQUFNLEdBQUcsR0FBRztRQUN2Q2dCLE9BQU9FLE9BQU8sR0FBR0Q7SUFDbkI7SUFFQSxPQUFPRDtBQUNUIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL2xpYi9pbnRha2Uvbm9ybWFsaXplUGF5bG9hZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHQV9ESVZPUkNFX0NVU1RPRFlfVjEgfSBmcm9tICcuL3NjaGVtYS9nYURpdm9yY2VDdXN0b2R5VjEnO1xuXG50eXBlIFBheWxvYWQgPSBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcblxuY29uc3QgY2Fub25pY2FsS2V5cyA9IG5ldyBTZXQoXG4gIEdBX0RJVk9SQ0VfQ1VTVE9EWV9WMS5zZWN0aW9ucy5mbGF0TWFwKChzZWN0aW9uKSA9PiBzZWN0aW9uLmZpZWxkcy5tYXAoKGZpZWxkKSA9PiBmaWVsZC5rZXkpKSxcbik7XG5cbmZ1bmN0aW9uIGlzUGxhaW5PYmplY3QodmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gIHJldHVybiBCb29sZWFuKHZhbHVlKSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICFBcnJheS5pc0FycmF5KHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gdG9UcmltbWVkU3RyaW5nKHZhbHVlOiB1bmtub3duKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHJldHVybiB1bmRlZmluZWQ7XG4gIGNvbnN0IHRyaW1tZWQgPSB2YWx1ZS50cmltKCk7XG4gIHJldHVybiB0cmltbWVkLmxlbmd0aCA+IDAgPyB0cmltbWVkIDogdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBidWlsZEFkZHJlc3NWYWx1ZSh2YWx1ZTogdW5rbm93biwgZXh0cmFzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgbnVsbCB7XG4gIGNvbnN0IGFkZHJlc3M6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgaWYgKGlzUGxhaW5PYmplY3QodmFsdWUpKSB7XG4gICAgY29uc3QgcmVjb3JkID0gdmFsdWUgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgY29uc3QgZmllbGRzID0gWydsaW5lMScsICdsaW5lMicsICdjaXR5JywgJ3N0YXRlJywgJ3ppcCddO1xuICAgIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XG4gICAgICBjb25zdCBlbnRyeSA9IHRvVHJpbW1lZFN0cmluZyhyZWNvcmRbZmllbGRdKTtcbiAgICAgIGlmIChlbnRyeSkgYWRkcmVzc1tmaWVsZF0gPSBlbnRyeTtcbiAgICB9XG4gICAgaWYgKCFhZGRyZXNzLmxpbmUxKSB7XG4gICAgICBjb25zdCBmcmVlZm9ybSA9IHRvVHJpbW1lZFN0cmluZyhyZWNvcmQuZnJlZWZvcm0pO1xuICAgICAgaWYgKGZyZWVmb3JtKSBhZGRyZXNzLmxpbmUxID0gZnJlZWZvcm07XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IGxpbmUxID0gdG9UcmltbWVkU3RyaW5nKHZhbHVlKTtcbiAgICBpZiAobGluZTEpIGFkZHJlc3MubGluZTEgPSBsaW5lMTtcbiAgfVxuXG4gIGlmIChleHRyYXMpIHtcbiAgICBjb25zdCBjaXR5ID0gdG9UcmltbWVkU3RyaW5nKGV4dHJhcy5jaXR5KTtcbiAgICBjb25zdCBzdGF0ZSA9IHRvVHJpbW1lZFN0cmluZyhleHRyYXMuc3RhdGUpO1xuICAgIGNvbnN0IHppcCA9IHRvVHJpbW1lZFN0cmluZyhleHRyYXMuemlwKTtcbiAgICBpZiAoY2l0eSAmJiAhYWRkcmVzcy5jaXR5KSBhZGRyZXNzLmNpdHkgPSBjaXR5O1xuICAgIGlmIChzdGF0ZSAmJiAhYWRkcmVzcy5zdGF0ZSkgYWRkcmVzcy5zdGF0ZSA9IHN0YXRlO1xuICAgIGlmICh6aXAgJiYgIWFkZHJlc3MuemlwKSBhZGRyZXNzLnppcCA9IHppcDtcbiAgfVxuXG4gIHJldHVybiBPYmplY3Qua2V5cyhhZGRyZXNzKS5sZW5ndGggPiAwID8gYWRkcmVzcyA6IG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVQYXlsb2FkVG9Eb2N4VjEoaW5wdXQ6IHVua25vd24pOiBQYXlsb2FkIHtcbiAgaWYgKCFpc1BsYWluT2JqZWN0KGlucHV0KSkgcmV0dXJuIHt9O1xuICBjb25zdCBwYXlsb2FkID0gaW5wdXQgYXMgUGF5bG9hZDtcbiAgY29uc3QgcmVzdWx0OiBQYXlsb2FkID0ge307XG4gIGNvbnN0IGxlZ2FjeU5vdGVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHtcbiAgICAuLi4oaXNQbGFpbk9iamVjdChwYXlsb2FkLl9sZWdhY3kpID8gcGF5bG9hZC5fbGVnYWN5IDoge30pLFxuICAgIC4uLihpc1BsYWluT2JqZWN0KHBheWxvYWQuX2xlZ2FjeV9ub3RlcykgPyBwYXlsb2FkLl9sZWdhY3lfbm90ZXMgOiB7fSksXG4gIH07XG5cbiAgY29uc3QgYWRkTGVnYWN5ID0gKGtleTogc3RyaW5nLCB2YWx1ZTogdW5rbm93bikgPT4ge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG4gICAgaWYgKGxlZ2FjeU5vdGVzW2tleV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgbGVnYWN5Tm90ZXNba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgfTtcblxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhwYXlsb2FkKSkge1xuICAgIGlmIChjYW5vbmljYWxLZXlzLmhhcyhrZXkpKSB7XG4gICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChyZXN1bHQub3Bwb3NpbmdfYWRkcmVzc19rbm93biA9PT0gdW5kZWZpbmVkICYmIHBheWxvYWQub3Bwb3Npbmdfa25vd25fYWRkcmVzcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmVzdWx0Lm9wcG9zaW5nX2FkZHJlc3Nfa25vd24gPSBwYXlsb2FkLm9wcG9zaW5nX2tub3duX2FkZHJlc3M7XG4gIH1cblxuICBpZiAocmVzdWx0Lm9wcG9zaW5nX2xhc3Rfa25vd25fYWRkcmVzcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgYWRkcmVzcyA9IGJ1aWxkQWRkcmVzc1ZhbHVlKHBheWxvYWQub3Bwb3NpbmdfYWRkcmVzcyk7XG4gICAgaWYgKGFkZHJlc3MpIHJlc3VsdC5vcHBvc2luZ19sYXN0X2tub3duX2FkZHJlc3MgPSBhZGRyZXNzO1xuICB9IGVsc2UgaWYgKGlzUGxhaW5PYmplY3QocmVzdWx0Lm9wcG9zaW5nX2xhc3Rfa25vd25fYWRkcmVzcykgJiYgcGF5bG9hZC5vcHBvc2luZ19hZGRyZXNzKSB7XG4gICAgY29uc3QgYWRkcmVzcyA9IGJ1aWxkQWRkcmVzc1ZhbHVlKHBheWxvYWQub3Bwb3NpbmdfYWRkcmVzcyk7XG4gICAgaWYgKGFkZHJlc3MpIHtcbiAgICAgIHJlc3VsdC5vcHBvc2luZ19sYXN0X2tub3duX2FkZHJlc3MgPSB7IC4uLmFkZHJlc3MsIC4uLnJlc3VsdC5vcHBvc2luZ19sYXN0X2tub3duX2FkZHJlc3MgfTtcbiAgICB9XG4gIH1cblxuICBpZiAocmVzdWx0LmNsaWVudF9hZGRyZXNzID09PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBhZGRyZXNzID0gYnVpbGRBZGRyZXNzVmFsdWUocGF5bG9hZC5jbGllbnRfYWRkcmVzcywge1xuICAgICAgY2l0eTogcGF5bG9hZC5jbGllbnRfY2l0eSxcbiAgICAgIHN0YXRlOiBwYXlsb2FkLmNsaWVudF9zdGF0ZSxcbiAgICAgIHppcDogcGF5bG9hZC5jbGllbnRfemlwLFxuICAgIH0pO1xuICAgIGlmIChhZGRyZXNzKSByZXN1bHQuY2xpZW50X2FkZHJlc3MgPSBhZGRyZXNzO1xuICB9IGVsc2UgaWYgKGlzUGxhaW5PYmplY3QocmVzdWx0LmNsaWVudF9hZGRyZXNzKSkge1xuICAgIGNvbnN0IGFkZHJlc3MgPSBidWlsZEFkZHJlc3NWYWx1ZShwYXlsb2FkLmNsaWVudF9hZGRyZXNzLCB7XG4gICAgICBjaXR5OiBwYXlsb2FkLmNsaWVudF9jaXR5LFxuICAgICAgc3RhdGU6IHBheWxvYWQuY2xpZW50X3N0YXRlLFxuICAgICAgemlwOiBwYXlsb2FkLmNsaWVudF96aXAsXG4gICAgfSk7XG4gICAgaWYgKGFkZHJlc3MpIHtcbiAgICAgIHJlc3VsdC5jbGllbnRfYWRkcmVzcyA9IHsgLi4uYWRkcmVzcywgLi4ucmVzdWx0LmNsaWVudF9hZGRyZXNzIH07XG4gICAgfVxuICB9XG5cbiAgaWYgKHJlc3VsdC5zcGVjaWFsX25lZWRzID09PSB1bmRlZmluZWQgJiYgcGF5bG9hZC5jaGlsZF9zcGVjaWFsX25lZWRzICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXN1bHQuc3BlY2lhbF9uZWVkcyA9IHBheWxvYWQuY2hpbGRfc3BlY2lhbF9uZWVkcztcbiAgfVxuXG4gIGlmIChyZXN1bHQucHJpb3JfY3VzdG9keV9vcmRlcnMgPT09IHVuZGVmaW5lZCAmJiBwYXlsb2FkLnByaW9yX2N1c3RvZHlfY2FzZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIHJlc3VsdC5wcmlvcl9jdXN0b2R5X29yZGVycyA9IHBheWxvYWQucHJpb3JfY3VzdG9keV9jYXNlcztcbiAgfVxuXG4gIGlmIChyZXN1bHQuYW1vdW50ID09PSB1bmRlZmluZWQgJiYgcGF5bG9hZC5lc3RpbWF0ZWRfYmFsYW5jZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmVzdWx0LmFtb3VudCA9IHBheWxvYWQuZXN0aW1hdGVkX2JhbGFuY2U7XG4gIH1cblxuICBpZiAocmVzdWx0Lm9wcG9zaW5nX2luY29tZV9rbm93biA9PT0gdW5kZWZpbmVkICYmIHBheWxvYWQub3Bwb3NpbmdfaW5jb21lX2VzdGltYXRlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgZXN0aW1hdGUgPSBwYXlsb2FkLm9wcG9zaW5nX2luY29tZV9lc3RpbWF0ZWQ7XG4gICAgaWYgKHR5cGVvZiBlc3RpbWF0ZSA9PT0gJ251bWJlcicgJiYgIU51bWJlci5pc05hTihlc3RpbWF0ZSkpIHtcbiAgICAgIHJlc3VsdC5vcHBvc2luZ19pbmNvbWVfa25vd24gPSB0cnVlO1xuICAgICAgYWRkTGVnYWN5KCdvcHBvc2luZ19pbmNvbWVfZXN0aW1hdGVkJywgZXN0aW1hdGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhZGRMZWdhY3koJ29wcG9zaW5nX2luY29tZV9lc3RpbWF0ZWQnLCBlc3RpbWF0ZSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHJlc3VsdC5zdXBwb3J0X3JlcXVlc3RlZCA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBwYXlsb2FkLnN1cHBvcnRfdHlwZSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXN1bHQuc3VwcG9ydF9yZXF1ZXN0ZWQgPSBwYXlsb2FkLnN1cHBvcnRfdHlwZTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcGF5bG9hZC5zdXBwb3J0X3JlcXVlc3RlZCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgYWRkTGVnYWN5KCdzdXBwb3J0X3JlcXVlc3RlZF9ib29sZWFuJywgcGF5bG9hZC5zdXBwb3J0X3JlcXVlc3RlZCk7XG4gICAgaWYgKHR5cGVvZiByZXN1bHQuc3VwcG9ydF9yZXF1ZXN0ZWQgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXN1bHQuc3VwcG9ydF9yZXF1ZXN0ZWQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwYXlsb2FkLm9wcG9zaW5nX3Bob25lICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnb3Bwb3NpbmdfcGhvbmUnLCBwYXlsb2FkLm9wcG9zaW5nX3Bob25lKTtcbiAgaWYgKHBheWxvYWQub3Bwb3NpbmdfZW1haWwgIT09IHVuZGVmaW5lZCkgYWRkTGVnYWN5KCdvcHBvc2luZ19lbWFpbCcsIHBheWxvYWQub3Bwb3NpbmdfZW1haWwpO1xuXG4gIGlmIChwYXlsb2FkLm1hcnJpYWdlX25vdGVzICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnbWFycmlhZ2Vfbm90ZXMnLCBwYXlsb2FkLm1hcnJpYWdlX25vdGVzKTtcbiAgaWYgKHBheWxvYWQuZmF1bHRfZ3JvdW5kX2RldGFpbCAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ2ZhdWx0X2dyb3VuZF9kZXRhaWwnLCBwYXlsb2FkLmZhdWx0X2dyb3VuZF9kZXRhaWwpO1xuICBpZiAocGF5bG9hZC5zZXBhcmF0aW9uX3N0YXR1cyAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ3NlcGFyYXRpb25fc3RhdHVzJywgcGF5bG9hZC5zZXBhcmF0aW9uX3N0YXR1cyk7XG5cbiAgaWYgKHBheWxvYWQuY2hpbGRfc2Nob29sX2luZm8gIT09IHVuZGVmaW5lZCkgYWRkTGVnYWN5KCdjaGlsZF9zY2hvb2xfaW5mbycsIHBheWxvYWQuY2hpbGRfc2Nob29sX2luZm8pO1xuICBpZiAocGF5bG9hZC5jdXJyZW50X29yZGVyX2V4aXN0cyAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ2N1cnJlbnRfb3JkZXJfZXhpc3RzJywgcGF5bG9hZC5jdXJyZW50X29yZGVyX2V4aXN0cyk7XG4gIGlmIChwYXlsb2FkLm90aGVyX3BhcmVudF9pbnZvbHZlbWVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYWRkTGVnYWN5KCdvdGhlcl9wYXJlbnRfaW52b2x2ZW1lbnQnLCBwYXlsb2FkLm90aGVyX3BhcmVudF9pbnZvbHZlbWVudCk7XG4gIH1cblxuICBpZiAocGF5bG9hZC5hc3NldF9kZXNjcmlwdGlvbiAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ2Fzc2V0X2Rlc2NyaXB0aW9uJywgcGF5bG9hZC5hc3NldF9kZXNjcmlwdGlvbik7XG4gIGlmIChwYXlsb2FkLmRvY3VtZW50YXRpb25fcHJvdmlkZWQgIT09IHVuZGVmaW5lZCkge1xuICAgIGFkZExlZ2FjeSgnZG9jdW1lbnRhdGlvbl9wcm92aWRlZCcsIHBheWxvYWQuZG9jdW1lbnRhdGlvbl9wcm92aWRlZCk7XG4gIH1cbiAgaWYgKHBheWxvYWQub3duZXJzaGlwX2Rpc3B1dGUgIT09IHVuZGVmaW5lZCkgYWRkTGVnYWN5KCdvd25lcnNoaXBfZGlzcHV0ZScsIHBheWxvYWQub3duZXJzaGlwX2Rpc3B1dGUpO1xuXG4gIGlmIChwYXlsb2FkLmluY29tZV9ub3RlcyAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ2luY29tZV9ub3RlcycsIHBheWxvYWQuaW5jb21lX25vdGVzKTtcblxuICBpZiAocGF5bG9hZC5kZWJ0X2Rlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnZGVidF9kZXNjcmlwdGlvbicsIHBheWxvYWQuZGVidF9kZXNjcmlwdGlvbik7XG4gIGlmIChwYXlsb2FkLmVzdGltYXRlZF9iYWxhbmNlICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnZXN0aW1hdGVkX2JhbGFuY2UnLCBwYXlsb2FkLmVzdGltYXRlZF9iYWxhbmNlKTtcbiAgaWYgKHBheWxvYWQuam9pbnRfZGVidCAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ2pvaW50X2RlYnQnLCBwYXlsb2FkLmpvaW50X2RlYnQpO1xuXG4gIGlmIChwYXlsb2FkLmR2X2Rlc2NyaXB0aW9uICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnZHZfZGVzY3JpcHRpb24nLCBwYXlsb2FkLmR2X2Rlc2NyaXB0aW9uKTtcbiAgaWYgKHBheWxvYWQud2VhcG9uc19wcmVzZW50ICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnd2VhcG9uc19wcmVzZW50JywgcGF5bG9hZC53ZWFwb25zX3ByZXNlbnQpO1xuXG4gIGlmIChwYXlsb2FkLnZlbnVlX25vdGVzICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgndmVudWVfbm90ZXMnLCBwYXlsb2FkLnZlbnVlX25vdGVzKTtcblxuICBpZiAocGF5bG9hZC5wcmlvcl9wcm90ZWN0aXZlX29yZGVycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYWRkTGVnYWN5KCdwcmlvcl9wcm90ZWN0aXZlX29yZGVycycsIHBheWxvYWQucHJpb3JfcHJvdGVjdGl2ZV9vcmRlcnMpO1xuICB9XG4gIGlmIChwYXlsb2FkLnByaW9yX2Nhc2Vfbm90ZXMgIT09IHVuZGVmaW5lZCkgYWRkTGVnYWN5KCdwcmlvcl9jYXNlX25vdGVzJywgcGF5bG9hZC5wcmlvcl9jYXNlX25vdGVzKTtcblxuICBpZiAocGF5bG9hZC5kZXNpcmVkX2N1c3RvZHlfb3V0Y29tZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYWRkTGVnYWN5KCdkZXNpcmVkX2N1c3RvZHlfb3V0Y29tZScsIHBheWxvYWQuZGVzaXJlZF9jdXN0b2R5X291dGNvbWUpO1xuICB9XG4gIGlmIChwYXlsb2FkLmRlc2lyZWRfcHJvcGVydHlfb3V0Y29tZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgYWRkTGVnYWN5KCdkZXNpcmVkX3Byb3BlcnR5X291dGNvbWUnLCBwYXlsb2FkLmRlc2lyZWRfcHJvcGVydHlfb3V0Y29tZSk7XG4gIH1cbiAgaWYgKHBheWxvYWQub3RoZXJfcmVxdWVzdHMgIT09IHVuZGVmaW5lZCkgYWRkTGVnYWN5KCdvdGhlcl9yZXF1ZXN0cycsIHBheWxvYWQub3RoZXJfcmVxdWVzdHMpO1xuXG4gIGlmIChwYXlsb2FkLnVwbG9hZGVkX2RvY3VtZW50X2xpbmtzICE9PSB1bmRlZmluZWQpIHtcbiAgICBhZGRMZWdhY3koJ3VwbG9hZGVkX2RvY3VtZW50X2xpbmtzJywgcGF5bG9hZC51cGxvYWRlZF9kb2N1bWVudF9saW5rcyk7XG4gIH1cbiAgaWYgKHBheWxvYWQuZXZpZGVuY2Vfbm90ZXMgIT09IHVuZGVmaW5lZCkgYWRkTGVnYWN5KCdldmlkZW5jZV9ub3RlcycsIHBheWxvYWQuZXZpZGVuY2Vfbm90ZXMpO1xuXG4gIGlmIChwYXlsb2FkLmNsaWVudF9jaXR5ICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnY2xpZW50X2NpdHknLCBwYXlsb2FkLmNsaWVudF9jaXR5KTtcbiAgaWYgKHBheWxvYWQuY2xpZW50X3N0YXRlICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnY2xpZW50X3N0YXRlJywgcGF5bG9hZC5jbGllbnRfc3RhdGUpO1xuICBpZiAocGF5bG9hZC5jbGllbnRfemlwICE9PSB1bmRlZmluZWQpIGFkZExlZ2FjeSgnY2xpZW50X3ppcCcsIHBheWxvYWQuY2xpZW50X3ppcCk7XG4gIGlmIChwYXlsb2FkLm9wcG9zaW5nX2tub3duX2FkZHJlc3MgIT09IHVuZGVmaW5lZCkge1xuICAgIGFkZExlZ2FjeSgnb3Bwb3Npbmdfa25vd25fYWRkcmVzcycsIHBheWxvYWQub3Bwb3Npbmdfa25vd25fYWRkcmVzcyk7XG4gIH1cbiAgaWYgKHBheWxvYWQub3Bwb3NpbmdfYWRkcmVzcyAhPT0gdW5kZWZpbmVkKSBhZGRMZWdhY3koJ29wcG9zaW5nX2FkZHJlc3MnLCBwYXlsb2FkLm9wcG9zaW5nX2FkZHJlc3MpO1xuXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHBheWxvYWQpKSB7XG4gICAgaWYgKCFjYW5vbmljYWxLZXlzLmhhcyhrZXkpICYmIGtleSAhPT0gJ19sZWdhY3lfbm90ZXMnICYmIGtleSAhPT0gJ19sZWdhY3knKSB7XG4gICAgICBhZGRMZWdhY3koa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKE9iamVjdC5rZXlzKGxlZ2FjeU5vdGVzKS5sZW5ndGggPiAwKSB7XG4gICAgcmVzdWx0Ll9sZWdhY3kgPSBsZWdhY3lOb3RlcztcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG4iXSwibmFtZXMiOlsiR0FfRElWT1JDRV9DVVNUT0RZX1YxIiwiY2Fub25pY2FsS2V5cyIsIlNldCIsInNlY3Rpb25zIiwiZmxhdE1hcCIsInNlY3Rpb24iLCJmaWVsZHMiLCJtYXAiLCJmaWVsZCIsImtleSIsImlzUGxhaW5PYmplY3QiLCJ2YWx1ZSIsIkJvb2xlYW4iLCJBcnJheSIsImlzQXJyYXkiLCJ0b1RyaW1tZWRTdHJpbmciLCJ1bmRlZmluZWQiLCJ0cmltbWVkIiwidHJpbSIsImxlbmd0aCIsImJ1aWxkQWRkcmVzc1ZhbHVlIiwiZXh0cmFzIiwiYWRkcmVzcyIsInJlY29yZCIsImVudHJ5IiwibGluZTEiLCJmcmVlZm9ybSIsImNpdHkiLCJzdGF0ZSIsInppcCIsIk9iamVjdCIsImtleXMiLCJub3JtYWxpemVQYXlsb2FkVG9Eb2N4VjEiLCJpbnB1dCIsInBheWxvYWQiLCJyZXN1bHQiLCJsZWdhY3lOb3RlcyIsIl9sZWdhY3kiLCJfbGVnYWN5X25vdGVzIiwiYWRkTGVnYWN5IiwiZW50cmllcyIsImhhcyIsIm9wcG9zaW5nX2FkZHJlc3Nfa25vd24iLCJvcHBvc2luZ19rbm93bl9hZGRyZXNzIiwib3Bwb3NpbmdfbGFzdF9rbm93bl9hZGRyZXNzIiwib3Bwb3NpbmdfYWRkcmVzcyIsImNsaWVudF9hZGRyZXNzIiwiY2xpZW50X2NpdHkiLCJjbGllbnRfc3RhdGUiLCJjbGllbnRfemlwIiwic3BlY2lhbF9uZWVkcyIsImNoaWxkX3NwZWNpYWxfbmVlZHMiLCJwcmlvcl9jdXN0b2R5X29yZGVycyIsInByaW9yX2N1c3RvZHlfY2FzZXMiLCJhbW91bnQiLCJlc3RpbWF0ZWRfYmFsYW5jZSIsIm9wcG9zaW5nX2luY29tZV9rbm93biIsIm9wcG9zaW5nX2luY29tZV9lc3RpbWF0ZWQiLCJlc3RpbWF0ZSIsIk51bWJlciIsImlzTmFOIiwic3VwcG9ydF9yZXF1ZXN0ZWQiLCJzdXBwb3J0X3R5cGUiLCJvcHBvc2luZ19waG9uZSIsIm9wcG9zaW5nX2VtYWlsIiwibWFycmlhZ2Vfbm90ZXMiLCJmYXVsdF9ncm91bmRfZGV0YWlsIiwic2VwYXJhdGlvbl9zdGF0dXMiLCJjaGlsZF9zY2hvb2xfaW5mbyIsImN1cnJlbnRfb3JkZXJfZXhpc3RzIiwib3RoZXJfcGFyZW50X2ludm9sdmVtZW50IiwiYXNzZXRfZGVzY3JpcHRpb24iLCJkb2N1bWVudGF0aW9uX3Byb3ZpZGVkIiwib3duZXJzaGlwX2Rpc3B1dGUiLCJpbmNvbWVfbm90ZXMiLCJkZWJ0X2Rlc2NyaXB0aW9uIiwiam9pbnRfZGVidCIsImR2X2Rlc2NyaXB0aW9uIiwid2VhcG9uc19wcmVzZW50IiwidmVudWVfbm90ZXMiLCJwcmlvcl9wcm90ZWN0aXZlX29yZGVycyIsInByaW9yX2Nhc2Vfbm90ZXMiLCJkZXNpcmVkX2N1c3RvZHlfb3V0Y29tZSIsImRlc2lyZWRfcHJvcGVydHlfb3V0Y29tZSIsIm90aGVyX3JlcXVlc3RzIiwidXBsb2FkZWRfZG9jdW1lbnRfbGlua3MiLCJldmlkZW5jZV9ub3RlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../../lib/intake/normalizePayload.ts\n");

/***/ }),

/***/ "(api-node)/../../lib/intake/schema/gaDivorceCustodyV1.ts":
/*!*****************************************************!*\
  !*** ../../lib/intake/schema/gaDivorceCustodyV1.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GA_DIVORCE_CUSTODY_V1: () => (/* binding */ GA_DIVORCE_CUSTODY_V1),\n/* harmony export */   GA_DIVORCE_CUSTODY_V1_AI_FLAGS: () => (/* binding */ GA_DIVORCE_CUSTODY_V1_AI_FLAGS)\n/* harmony export */ });\nconst GA_DIVORCE_CUSTODY_V1 = {\n    version: 'v1.0',\n    sections: [\n        {\n            id: 'matter_metadata',\n            title: 'MATTER METADATA (SYSTEM + CLIENT)',\n            fields: [\n                {\n                    key: 'matter_type',\n                    type: 'enum',\n                    required: true,\n                    notes: 'divorce, custody, legitimation, modification',\n                    enumValues: [\n                        'divorce',\n                        'custody',\n                        'legitimation',\n                        'modification'\n                    ]\n                },\n                {\n                    key: 'urgency_level',\n                    type: 'enum',\n                    required: true,\n                    notes: 'routine, urgent, emergency',\n                    enumValues: [\n                        'routine',\n                        'urgent',\n                        'emergency'\n                    ]\n                },\n                {\n                    key: 'intake_channel',\n                    type: 'enum',\n                    required: true,\n                    notes: 'web, referral, phone',\n                    enumValues: [\n                        'web',\n                        'referral',\n                        'phone'\n                    ]\n                },\n                {\n                    key: 'language_preference',\n                    type: 'enum',\n                    required: false,\n                    notes: 'future multilingual support',\n                    enumValues: [\n                        'english',\n                        'spanish',\n                        'other',\n                        'unknown',\n                        'prefer_not_to_say'\n                    ]\n                },\n                {\n                    key: 'date_of_intake',\n                    type: 'date',\n                    required: true,\n                    notes: 'system generated'\n                }\n            ]\n        },\n        {\n            id: 'client_identity',\n            title: 'CLIENT IDENTITY',\n            fields: [\n                {\n                    key: 'client_first_name',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'client_last_name',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'client_dob',\n                    type: 'date',\n                    required: true\n                },\n                {\n                    key: 'client_phone',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'client_email',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'client_address',\n                    type: 'structured',\n                    required: true,\n                    notes: 'structured address'\n                },\n                {\n                    key: 'client_county',\n                    type: 'enum',\n                    required: true,\n                    notes: 'CSV-derived (docs/ga_counties.csv)'\n                },\n                {\n                    key: 'citizenship_status',\n                    type: 'enum',\n                    required: false,\n                    enumValues: [\n                        'us_citizen',\n                        'lawful_permanent_resident',\n                        'nonimmigrant_visa_holder',\n                        'undocumented',\n                        'dual_citizen',\n                        'unknown',\n                        'prefer_not_to_say'\n                    ]\n                },\n                {\n                    key: 'military_status',\n                    type: 'boolean',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'opposing_party',\n            title: 'OPPOSING PARTY (SPOUSE / OTHER PARENT)',\n            fields: [\n                {\n                    key: 'opposing_name',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'opposing_address_known',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'opposing_last_known_address',\n                    type: 'structured',\n                    required: true,\n                    notes: 'structured address; required if opposing_address_known'\n                },\n                {\n                    key: 'service_concerns',\n                    type: 'boolean',\n                    required: false\n                },\n                {\n                    key: 'opposing_employment_status',\n                    type: 'enum',\n                    required: false,\n                    enumValues: [\n                        'employed_full_time',\n                        'employed_part_time',\n                        'self_employed',\n                        'unemployed',\n                        'student',\n                        'retired',\n                        'disabled',\n                        'unknown'\n                    ]\n                }\n            ]\n        },\n        {\n            id: 'marriage_details',\n            title: 'MARRIAGE DETAILS',\n            fields: [\n                {\n                    key: 'date_of_marriage',\n                    type: 'date',\n                    required: true\n                },\n                {\n                    key: 'place_of_marriage',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'date_of_separation',\n                    type: 'date',\n                    required: true,\n                    notes: 'required if separated'\n                },\n                {\n                    key: 'currently_cohabitating',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'marriage_certificate_available',\n                    type: 'boolean',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'separation_grounds',\n            title: 'SEPARATION & GROUNDS (GEORGIA)',\n            fields: [\n                {\n                    key: 'grounds_for_divorce',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'no_fault',\n                        'adultery',\n                        'desertion',\n                        'cruel_treatment',\n                        'habitual_drug_use',\n                        'mental_incapacity',\n                        'impotence',\n                        'pregnancy_by_another',\n                        'incest',\n                        'conviction_of_felony'\n                    ]\n                },\n                {\n                    key: 'fault_allegations',\n                    type: 'multiselect',\n                    required: false,\n                    enumValues: [\n                        'adultery',\n                        'desertion',\n                        'cruel_treatment',\n                        'habitual_drug_use',\n                        'mental_incapacity',\n                        'impotence',\n                        'pregnancy_by_another',\n                        'incest',\n                        'conviction_of_felony'\n                    ]\n                },\n                {\n                    key: 'reconciliation_attempted',\n                    type: 'boolean',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'child_object',\n            title: 'CHILD OBJECT (REPEATABLE)',\n            fields: [\n                {\n                    key: 'child_full_name',\n                    type: 'text',\n                    required: true\n                },\n                {\n                    key: 'child_dob',\n                    type: 'date',\n                    required: true\n                },\n                {\n                    key: 'child_current_residence',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'with_client',\n                        'with_opposing',\n                        'shared',\n                        'third_party',\n                        'other',\n                        'unknown'\n                    ]\n                },\n                {\n                    key: 'biological_relation',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'client',\n                        'opposing',\n                        'both',\n                        'neither',\n                        'unknown'\n                    ]\n                },\n                {\n                    key: 'special_needs',\n                    type: 'boolean',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'children_custody',\n            title: 'CHILDREN & CUSTODY (CUSTODY SETTINGS)',\n            fields: [\n                {\n                    key: 'custody_type_requested',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'legal_custody',\n                        'physical_custody',\n                        'joint_custody',\n                        'sole_custody'\n                    ]\n                },\n                {\n                    key: 'parenting_plan_exists',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'modification_existing_order',\n                    type: 'boolean',\n                    required: false,\n                    notes: 'modification only'\n                },\n                {\n                    key: 'current_parenting_schedule',\n                    type: 'text',\n                    required: false\n                },\n                {\n                    key: 'school_district',\n                    type: 'text',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'asset_object',\n            title: 'ASSET OBJECT (REPEATABLE)',\n            fields: [\n                {\n                    key: 'asset_type',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'real_estate',\n                        'vehicle',\n                        'bank_account',\n                        'retirement_account',\n                        'investment_account',\n                        'business_interest',\n                        'personal_property',\n                        'other'\n                    ]\n                },\n                {\n                    key: 'ownership',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'sole_client',\n                        'sole_opposing',\n                        'joint',\n                        'third_party',\n                        'unknown'\n                    ]\n                },\n                {\n                    key: 'estimated_value',\n                    type: 'number',\n                    required: true\n                },\n                {\n                    key: 'title_holder',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'client',\n                        'opposing',\n                        'both',\n                        'third_party',\n                        'unknown'\n                    ]\n                },\n                {\n                    key: 'acquired_pre_marriage',\n                    type: 'boolean',\n                    required: true\n                }\n            ]\n        },\n        {\n            id: 'income_support',\n            title: 'INCOME & SUPPORT',\n            fields: [\n                {\n                    key: 'client_income_monthly',\n                    type: 'number',\n                    required: true\n                },\n                {\n                    key: 'opposing_income_known',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'support_requested',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'child_support',\n                        'spousal_support',\n                        'both'\n                    ]\n                },\n                {\n                    key: 'child_support_estimate',\n                    type: 'number',\n                    required: false,\n                    isSystem: true,\n                    notes: 'system-only'\n                },\n                {\n                    key: 'alimony_requested',\n                    type: 'boolean',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'debt_object',\n            title: 'DEBT OBJECT (REPEATABLE)',\n            fields: [\n                {\n                    key: 'debt_type',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'credit_card',\n                        'student_loan',\n                        'auto_loan',\n                        'mortgage',\n                        'medical_debt',\n                        'tax_debt',\n                        'personal_loan',\n                        'other'\n                    ]\n                },\n                {\n                    key: 'amount',\n                    type: 'number',\n                    required: true\n                },\n                {\n                    key: 'responsible_party',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'client',\n                        'opposing',\n                        'both',\n                        'third_party',\n                        'unknown'\n                    ]\n                },\n                {\n                    key: 'incurred_during_marriage',\n                    type: 'boolean',\n                    required: true\n                }\n            ]\n        },\n        {\n            id: 'domestic_violence_risk',\n            title: 'DOMESTIC VIOLENCE / RISK',\n            fields: [\n                {\n                    key: 'dv_present',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'protective_order_exists',\n                    type: 'boolean',\n                    required: true,\n                    notes: 'required if dv_present'\n                },\n                {\n                    key: 'immediate_safety_concerns',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'children_exposed',\n                    type: 'boolean',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'jurisdiction_venue',\n            title: 'JURISDICTION & VENUE',\n            fields: [\n                {\n                    key: 'county_of_filing',\n                    type: 'enum',\n                    required: true,\n                    notes: 'CSV-derived (docs/ga_counties.csv)'\n                },\n                {\n                    key: 'residency_duration_months',\n                    type: 'number',\n                    required: true\n                },\n                {\n                    key: 'opposing_resides_in_ga',\n                    type: 'boolean',\n                    required: false\n                },\n                {\n                    key: 'venue_confirmed',\n                    type: 'boolean',\n                    required: false,\n                    isSystem: true\n                }\n            ]\n        },\n        {\n            id: 'prior_legal_actions',\n            title: 'PRIOR LEGAL ACTIONS',\n            fields: [\n                {\n                    key: 'prior_divorce_filings',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'prior_custody_orders',\n                    type: 'boolean',\n                    required: true\n                },\n                {\n                    key: 'case_numbers',\n                    type: 'text',\n                    required: false\n                },\n                {\n                    key: 'existing_attorney',\n                    type: 'boolean',\n                    required: true\n                }\n            ]\n        },\n        {\n            id: 'desired_outcomes',\n            title: 'DESIRED OUTCOMES',\n            fields: [\n                {\n                    key: 'primary_goal',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'divorce_finalization',\n                        'custody_determination',\n                        'custody_modification',\n                        'support_establishment',\n                        'support_modification',\n                        'property_division',\n                        'protective_relief',\n                        'legal_guidance',\n                        'other'\n                    ]\n                },\n                {\n                    key: 'settlement_preference',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'strongly_prefer_settlement',\n                        'prefer_settlement',\n                        'open_to_either',\n                        'prefer_litigation',\n                        'strongly_prefer_litigation',\n                        'unsure'\n                    ]\n                },\n                {\n                    key: 'litigation_tolerance',\n                    type: 'enum',\n                    required: true,\n                    enumValues: [\n                        'low',\n                        'moderate',\n                        'high',\n                        'unknown'\n                    ]\n                },\n                {\n                    key: 'non_negotiables',\n                    type: 'text',\n                    required: false\n                }\n            ]\n        },\n        {\n            id: 'evidence_documents',\n            title: 'EVIDENCE & DOCUMENTS',\n            fields: [\n                {\n                    key: 'document_type',\n                    type: 'enum',\n                    required: false,\n                    enumValues: [\n                        'pay_stub',\n                        'tax_return',\n                        'bank_statement',\n                        'financial_statement',\n                        'real_estate_document',\n                        'vehicle_title',\n                        'retirement_statement',\n                        'business_record',\n                        'text_message',\n                        'email',\n                        'photo',\n                        'video',\n                        'police_report',\n                        'court_order',\n                        'protective_order',\n                        'medical_record',\n                        'school_record',\n                        'other'\n                    ]\n                },\n                {\n                    key: 'uploaded',\n                    type: 'boolean',\n                    required: false\n                },\n                {\n                    key: 'missing_required_docs',\n                    type: 'list',\n                    required: false,\n                    isSystem: true,\n                    notes: 'system-only'\n                }\n            ]\n        }\n    ]\n};\nconst GA_DIVORCE_CUSTODY_V1_AI_FLAGS = [\n    {\n        key: 'jurisdiction_risk',\n        trigger: 'Residency / venue mismatch'\n    },\n    {\n        key: 'dv_risk',\n        trigger: 'DV indicated + weapons present'\n    },\n    {\n        key: 'custody_complexity',\n        trigger: 'Multiple children + special needs'\n    },\n    {\n        key: 'asset_complexity',\n        trigger: 'Business / high-value assets detected'\n    },\n    {\n        key: 'support_complexity',\n        trigger: 'Support requested + income disparity'\n    },\n    {\n        key: 'missing_required',\n        trigger: 'Required fields missing at submission'\n    }\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9saWIvaW50YWtlL3NjaGVtYS9nYURpdm9yY2VDdXN0b2R5VjEudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFTyxNQUFNQSx3QkFBbUM7SUFDOUNDLFNBQVM7SUFDVEMsVUFBVTtRQUNSO1lBQ0VDLElBQUk7WUFDSkMsT0FBTztZQUNQQyxRQUFRO2dCQUNOO29CQUNFQyxLQUFLO29CQUNMQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxPQUFPO29CQUNQQyxZQUFZO3dCQUFDO3dCQUFXO3dCQUFXO3dCQUFnQjtxQkFBZTtnQkFDcEU7Z0JBQ0E7b0JBQ0VKLEtBQUs7b0JBQ0xDLE1BQU07b0JBQ05DLFVBQVU7b0JBQ1ZDLE9BQU87b0JBQ1BDLFlBQVk7d0JBQUM7d0JBQVc7d0JBQVU7cUJBQVk7Z0JBQ2hEO2dCQUNBO29CQUNFSixLQUFLO29CQUNMQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxPQUFPO29CQUNQQyxZQUFZO3dCQUFDO3dCQUFPO3dCQUFZO3FCQUFRO2dCQUMxQztnQkFDQTtvQkFDRUosS0FBSztvQkFDTEMsTUFBTTtvQkFDTkMsVUFBVTtvQkFDVkMsT0FBTztvQkFDUEMsWUFBWTt3QkFBQzt3QkFBVzt3QkFBVzt3QkFBUzt3QkFBVztxQkFBb0I7Z0JBQzdFO2dCQUNBO29CQUNFSixLQUFLO29CQUNMQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxPQUFPO2dCQUNUO2FBQ0Q7UUFDSDtRQUNBO1lBQ0VOLElBQUk7WUFDSkMsT0FBTztZQUNQQyxRQUFRO2dCQUNOO29CQUFFQyxLQUFLO29CQUFxQkMsTUFBTTtvQkFBUUMsVUFBVTtnQkFBSztnQkFDekQ7b0JBQUVGLEtBQUs7b0JBQW9CQyxNQUFNO29CQUFRQyxVQUFVO2dCQUFLO2dCQUN4RDtvQkFBRUYsS0FBSztvQkFBY0MsTUFBTTtvQkFBUUMsVUFBVTtnQkFBSztnQkFDbEQ7b0JBQUVGLEtBQUs7b0JBQWdCQyxNQUFNO29CQUFRQyxVQUFVO2dCQUFLO2dCQUNwRDtvQkFB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QUNQQyxRQUFRO2dCQUNOO29CQUNFQyxLQUFLO29CQUNMQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWRSxZQUFZO3dCQUNWO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3dCQUNBO3FCQUNEO2dCQUNIO2dCQUNBO29CQUFFSixLQUFLO29CQUFZQyxNQUFNO29CQUFXQyxVQUFVO2dCQUFNO2dCQUNwRDtvQkFDRUYsS0FBSztvQkFDTEMsTUFBTTtvQkFDTkMsVUFBVTtvQkFDVkcsVUFBVTtvQkFDVkYsT0FBTztnQkFDVDthQUNEO1FBQ0g7S0FDRDtBQUNILEVBQUU7QUFFSyxNQUFNRyxpQ0FBOEM7SUFDekQ7UUFBRU4sS0FBSztRQUFxQk8sU0FBUztJQUE2QjtJQUNsRTtRQUFFUCxLQUFLO1FBQVdPLFNBQVM7SUFBaUM7SUFDNUQ7UUFBRVAsS0FBSztRQUFzQk8sU0FBUztJQUFvQztJQUMxRTtRQUFFUCxLQUFLO1FBQW9CTyxTQUFTO0lBQXdDO0lBQzVFO1FBQUVQLEtBQUs7UUFBc0JPLFNBQVM7SUFBdUM7SUFDN0U7UUFBRVAsS0FBSztRQUFvQk8sU0FBUztJQUF3QztDQUM3RSxDQUFDIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL2xpYi9pbnRha2Uvc2NoZW1hL2dhRGl2b3JjZUN1c3RvZHlWMS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEFpRmxhZ0RlZiwgU2NoZW1hRGVmIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCBHQV9ESVZPUkNFX0NVU1RPRFlfVjE6IFNjaGVtYURlZiA9IHtcbiAgdmVyc2lvbjogJ3YxLjAnLFxuICBzZWN0aW9uczogW1xuICAgIHtcbiAgICAgIGlkOiAnbWF0dGVyX21ldGFkYXRhJyxcbiAgICAgIHRpdGxlOiAnTUFUVEVSIE1FVEFEQVRBIChTWVNURU0gKyBDTElFTlQpJyxcbiAgICAgIGZpZWxkczogW1xuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnbWF0dGVyX3R5cGUnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBub3RlczogJ2Rpdm9yY2UsIGN1c3RvZHksIGxlZ2l0aW1hdGlvbiwgbW9kaWZpY2F0aW9uJyxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbJ2Rpdm9yY2UnLCAnY3VzdG9keScsICdsZWdpdGltYXRpb24nLCAnbW9kaWZpY2F0aW9uJ10sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBrZXk6ICd1cmdlbmN5X2xldmVsJyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgbm90ZXM6ICdyb3V0aW5lLCB1cmdlbnQsIGVtZXJnZW5jeScsXG4gICAgICAgICAgZW51bVZhbHVlczogWydyb3V0aW5lJywgJ3VyZ2VudCcsICdlbWVyZ2VuY3knXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2ludGFrZV9jaGFubmVsJyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgbm90ZXM6ICd3ZWIsIHJlZmVycmFsLCBwaG9uZScsXG4gICAgICAgICAgZW51bVZhbHVlczogWyd3ZWInLCAncmVmZXJyYWwnLCAncGhvbmUnXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2xhbmd1YWdlX3ByZWZlcmVuY2UnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgbm90ZXM6ICdmdXR1cmUgbXVsdGlsaW5ndWFsIHN1cHBvcnQnLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFsnZW5nbGlzaCcsICdzcGFuaXNoJywgJ290aGVyJywgJ3Vua25vd24nLCAncHJlZmVyX25vdF90b19zYXknXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2RhdGVfb2ZfaW50YWtlJyxcbiAgICAgICAgICB0eXBlOiAnZGF0ZScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgbm90ZXM6ICdzeXN0ZW0gZ2VuZXJhdGVkJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ2NsaWVudF9pZGVudGl0eScsXG4gICAgICB0aXRsZTogJ0NMSUVOVCBJREVOVElUWScsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAgeyBrZXk6ICdjbGllbnRfZmlyc3RfbmFtZScsIHR5cGU6ICd0ZXh0JywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAgeyBrZXk6ICdjbGllbnRfbGFzdF9uYW1lJywgdHlwZTogJ3RleHQnLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7IGtleTogJ2NsaWVudF9kb2InLCB0eXBlOiAnZGF0ZScsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnY2xpZW50X3Bob25lJywgdHlwZTogJ3RleHQnLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7IGtleTogJ2NsaWVudF9lbWFpbCcsIHR5cGU6ICd0ZXh0JywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAgeyBrZXk6ICdjbGllbnRfYWRkcmVzcycsIHR5cGU6ICdzdHJ1Y3R1cmVkJywgcmVxdWlyZWQ6IHRydWUsIG5vdGVzOiAnc3RydWN0dXJlZCBhZGRyZXNzJyB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnY2xpZW50X2NvdW50eScsXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIG5vdGVzOiAnQ1NWLWRlcml2ZWQgKGRvY3MvZ2FfY291bnRpZXMuY3N2KScsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBrZXk6ICdjaXRpemVuc2hpcF9zdGF0dXMnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZW51bVZhbHVlczogW1xuICAgICAgICAgICAgJ3VzX2NpdGl6ZW4nLFxuICAgICAgICAgICAgJ2xhd2Z1bF9wZXJtYW5lbnRfcmVzaWRlbnQnLFxuICAgICAgICAgICAgJ25vbmltbWlncmFudF92aXNhX2hvbGRlcicsXG4gICAgICAgICAgICAndW5kb2N1bWVudGVkJyxcbiAgICAgICAgICAgICdkdWFsX2NpdGl6ZW4nLFxuICAgICAgICAgICAgJ3Vua25vd24nLFxuICAgICAgICAgICAgJ3ByZWZlcl9ub3RfdG9fc2F5JyxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7IGtleTogJ21pbGl0YXJ5X3N0YXR1cycsIHR5cGU6ICdib29sZWFuJywgcmVxdWlyZWQ6IGZhbHNlIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdvcHBvc2luZ19wYXJ0eScsXG4gICAgICB0aXRsZTogJ09QUE9TSU5HIFBBUlRZIChTUE9VU0UgLyBPVEhFUiBQQVJFTlQpJyxcbiAgICAgIGZpZWxkczogW1xuICAgICAgICB7IGtleTogJ29wcG9zaW5nX25hbWUnLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnb3Bwb3NpbmdfYWRkcmVzc19rbm93bicsIHR5cGU6ICdib29sZWFuJywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ29wcG9zaW5nX2xhc3Rfa25vd25fYWRkcmVzcycsXG4gICAgICAgICAgdHlwZTogJ3N0cnVjdHVyZWQnLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIG5vdGVzOiAnc3RydWN0dXJlZCBhZGRyZXNzOyByZXF1aXJlZCBpZiBvcHBvc2luZ19hZGRyZXNzX2tub3duJyxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdzZXJ2aWNlX2NvbmNlcm5zJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogZmFsc2UgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ29wcG9zaW5nX2VtcGxveW1lbnRfc3RhdHVzJyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFtcbiAgICAgICAgICAgICdlbXBsb3llZF9mdWxsX3RpbWUnLFxuICAgICAgICAgICAgJ2VtcGxveWVkX3BhcnRfdGltZScsXG4gICAgICAgICAgICAnc2VsZl9lbXBsb3llZCcsXG4gICAgICAgICAgICAndW5lbXBsb3llZCcsXG4gICAgICAgICAgICAnc3R1ZGVudCcsXG4gICAgICAgICAgICAncmV0aXJlZCcsXG4gICAgICAgICAgICAnZGlzYWJsZWQnLFxuICAgICAgICAgICAgJ3Vua25vd24nLFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdtYXJyaWFnZV9kZXRhaWxzJyxcbiAgICAgIHRpdGxlOiAnTUFSUklBR0UgREVUQUlMUycsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAgeyBrZXk6ICdkYXRlX29mX21hcnJpYWdlJywgdHlwZTogJ2RhdGUnLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7IGtleTogJ3BsYWNlX29mX21hcnJpYWdlJywgdHlwZTogJ3RleHQnLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7IGtleTogJ2RhdGVfb2Zfc2VwYXJhdGlvbicsIHR5cGU6ICdkYXRlJywgcmVxdWlyZWQ6IHRydWUsIG5vdGVzOiAncmVxdWlyZWQgaWYgc2VwYXJhdGVkJyB9LFxuICAgICAgICB7IGtleTogJ2N1cnJlbnRseV9jb2hhYml0YXRpbmcnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnbWFycmlhZ2VfY2VydGlmaWNhdGVfYXZhaWxhYmxlJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogZmFsc2UgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ3NlcGFyYXRpb25fZ3JvdW5kcycsXG4gICAgICB0aXRsZTogJ1NFUEFSQVRJT04gJiBHUk9VTkRTIChHRU9SR0lBKScsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2dyb3VuZHNfZm9yX2Rpdm9yY2UnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbXG4gICAgICAgICAgICAnbm9fZmF1bHQnLFxuICAgICAgICAgICAgJ2FkdWx0ZXJ5JyxcbiAgICAgICAgICAgICdkZXNlcnRpb24nLFxuICAgICAgICAgICAgJ2NydWVsX3RyZWF0bWVudCcsXG4gICAgICAgICAgICAnaGFiaXR1YWxfZHJ1Z191c2UnLFxuICAgICAgICAgICAgJ21lbnRhbF9pbmNhcGFjaXR5JyxcbiAgICAgICAgICAgICdpbXBvdGVuY2UnLFxuICAgICAgICAgICAgJ3ByZWduYW5jeV9ieV9hbm90aGVyJyxcbiAgICAgICAgICAgICdpbmNlc3QnLFxuICAgICAgICAgICAgJ2NvbnZpY3Rpb25fb2ZfZmVsb255JyxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnZmF1bHRfYWxsZWdhdGlvbnMnLFxuICAgICAgICAgIHR5cGU6ICdtdWx0aXNlbGVjdCcsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFtcbiAgICAgICAgICAgICdhZHVsdGVyeScsXG4gICAgICAgICAgICAnZGVzZXJ0aW9uJyxcbiAgICAgICAgICAgICdjcnVlbF90cmVhdG1lbnQnLFxuICAgICAgICAgICAgJ2hhYml0dWFsX2RydWdfdXNlJyxcbiAgICAgICAgICAgICdtZW50YWxfaW5jYXBhY2l0eScsXG4gICAgICAgICAgICAnaW1wb3RlbmNlJyxcbiAgICAgICAgICAgICdwcmVnbmFuY3lfYnlfYW5vdGhlcicsXG4gICAgICAgICAgICAnaW5jZXN0JyxcbiAgICAgICAgICAgICdjb252aWN0aW9uX29mX2ZlbG9ueScsXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdyZWNvbmNpbGlhdGlvbl9hdHRlbXB0ZWQnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiBmYWxzZSB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnY2hpbGRfb2JqZWN0JyxcbiAgICAgIHRpdGxlOiAnQ0hJTEQgT0JKRUNUIChSRVBFQVRBQkxFKScsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAgeyBrZXk6ICdjaGlsZF9mdWxsX25hbWUnLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnY2hpbGRfZG9iJywgdHlwZTogJ2RhdGUnLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnY2hpbGRfY3VycmVudF9yZXNpZGVuY2UnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbJ3dpdGhfY2xpZW50JywgJ3dpdGhfb3Bwb3NpbmcnLCAnc2hhcmVkJywgJ3RoaXJkX3BhcnR5JywgJ290aGVyJywgJ3Vua25vd24nXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2Jpb2xvZ2ljYWxfcmVsYXRpb24nLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbJ2NsaWVudCcsICdvcHBvc2luZycsICdib3RoJywgJ25laXRoZXInLCAndW5rbm93biddLFxuICAgICAgICB9LFxuICAgICAgICB7IGtleTogJ3NwZWNpYWxfbmVlZHMnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiBmYWxzZSB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnY2hpbGRyZW5fY3VzdG9keScsXG4gICAgICB0aXRsZTogJ0NISUxEUkVOICYgQ1VTVE9EWSAoQ1VTVE9EWSBTRVRUSU5HUyknLFxuICAgICAgZmllbGRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBrZXk6ICdjdXN0b2R5X3R5cGVfcmVxdWVzdGVkJyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZW51bVZhbHVlczogWydsZWdhbF9jdXN0b2R5JywgJ3BoeXNpY2FsX2N1c3RvZHknLCAnam9pbnRfY3VzdG9keScsICdzb2xlX2N1c3RvZHknXSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdwYXJlbnRpbmdfcGxhbl9leGlzdHMnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnbW9kaWZpY2F0aW9uX2V4aXN0aW5nX29yZGVyJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogZmFsc2UsIG5vdGVzOiAnbW9kaWZpY2F0aW9uIG9ubHknIH0sXG4gICAgICAgIHsga2V5OiAnY3VycmVudF9wYXJlbnRpbmdfc2NoZWR1bGUnLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiBmYWxzZSB9LFxuICAgICAgICB7IGtleTogJ3NjaG9vbF9kaXN0cmljdCcsIHR5cGU6ICd0ZXh0JywgcmVxdWlyZWQ6IGZhbHNlIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdhc3NldF9vYmplY3QnLFxuICAgICAgdGl0bGU6ICdBU1NFVCBPQkpFQ1QgKFJFUEVBVEFCTEUpJyxcbiAgICAgIGZpZWxkczogW1xuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnYXNzZXRfdHlwZScsXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFtcbiAgICAgICAgICAgICdyZWFsX2VzdGF0ZScsXG4gICAgICAgICAgICAndmVoaWNsZScsXG4gICAgICAgICAgICAnYmFua19hY2NvdW50JyxcbiAgICAgICAgICAgICdyZXRpcmVtZW50X2FjY291bnQnLFxuICAgICAgICAgICAgJ2ludmVzdG1lbnRfYWNjb3VudCcsXG4gICAgICAgICAgICAnYnVzaW5lc3NfaW50ZXJlc3QnLFxuICAgICAgICAgICAgJ3BlcnNvbmFsX3Byb3BlcnR5JyxcbiAgICAgICAgICAgICdvdGhlcicsXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ293bmVyc2hpcCcsXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFsnc29sZV9jbGllbnQnLCAnc29sZV9vcHBvc2luZycsICdqb2ludCcsICd0aGlyZF9wYXJ0eScsICd1bmtub3duJ10sXG4gICAgICAgIH0sXG4gICAgICAgIHsga2V5OiAnZXN0aW1hdGVkX3ZhbHVlJywgdHlwZTogJ251bWJlcicsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBrZXk6ICd0aXRsZV9ob2xkZXInLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbJ2NsaWVudCcsICdvcHBvc2luZycsICdib3RoJywgJ3RoaXJkX3BhcnR5JywgJ3Vua25vd24nXSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdhY3F1aXJlZF9wcmVfbWFycmlhZ2UnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdpbmNvbWVfc3VwcG9ydCcsXG4gICAgICB0aXRsZTogJ0lOQ09NRSAmIFNVUFBPUlQnLFxuICAgICAgZmllbGRzOiBbXG4gICAgICAgIHsga2V5OiAnY2xpZW50X2luY29tZV9tb250aGx5JywgdHlwZTogJ251bWJlcicsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnb3Bwb3NpbmdfaW5jb21lX2tub3duJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnc3VwcG9ydF9yZXF1ZXN0ZWQnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbJ2NoaWxkX3N1cHBvcnQnLCAnc3BvdXNhbF9zdXBwb3J0JywgJ2JvdGgnXSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2NoaWxkX3N1cHBvcnRfZXN0aW1hdGUnLFxuICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBpc1N5c3RlbTogdHJ1ZSxcbiAgICAgICAgICBub3RlczogJ3N5c3RlbS1vbmx5JyxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdhbGltb255X3JlcXVlc3RlZCcsIHR5cGU6ICdib29sZWFuJywgcmVxdWlyZWQ6IGZhbHNlIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdkZWJ0X29iamVjdCcsXG4gICAgICB0aXRsZTogJ0RFQlQgT0JKRUNUIChSRVBFQVRBQkxFKScsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2RlYnRfdHlwZScsXG4gICAgICAgICAgdHlwZTogJ2VudW0nLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFtcbiAgICAgICAgICAgICdjcmVkaXRfY2FyZCcsXG4gICAgICAgICAgICAnc3R1ZGVudF9sb2FuJyxcbiAgICAgICAgICAgICdhdXRvX2xvYW4nLFxuICAgICAgICAgICAgJ21vcnRnYWdlJyxcbiAgICAgICAgICAgICdtZWRpY2FsX2RlYnQnLFxuICAgICAgICAgICAgJ3RheF9kZWJ0JyxcbiAgICAgICAgICAgICdwZXJzb25hbF9sb2FuJyxcbiAgICAgICAgICAgICdvdGhlcicsXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdhbW91bnQnLCB0eXBlOiAnbnVtYmVyJywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ3Jlc3BvbnNpYmxlX3BhcnR5JyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZW51bVZhbHVlczogWydjbGllbnQnLCAnb3Bwb3NpbmcnLCAnYm90aCcsICd0aGlyZF9wYXJ0eScsICd1bmtub3duJ10sXG4gICAgICAgIH0sXG4gICAgICAgIHsga2V5OiAnaW5jdXJyZWRfZHVyaW5nX21hcnJpYWdlJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnZG9tZXN0aWNfdmlvbGVuY2VfcmlzaycsXG4gICAgICB0aXRsZTogJ0RPTUVTVElDIFZJT0xFTkNFIC8gUklTSycsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAgeyBrZXk6ICdkdl9wcmVzZW50JywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgICB7IGtleTogJ3Byb3RlY3RpdmVfb3JkZXJfZXhpc3RzJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogdHJ1ZSwgbm90ZXM6ICdyZXF1aXJlZCBpZiBkdl9wcmVzZW50JyB9LFxuICAgICAgICB7IGtleTogJ2ltbWVkaWF0ZV9zYWZldHlfY29uY2VybnMnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgICAgIHsga2V5OiAnY2hpbGRyZW5fZXhwb3NlZCcsIHR5cGU6ICdib29sZWFuJywgcmVxdWlyZWQ6IGZhbHNlIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgaWQ6ICdqdXJpc2RpY3Rpb25fdmVudWUnLFxuICAgICAgdGl0bGU6ICdKVVJJU0RJQ1RJT04gJiBWRU5VRScsXG4gICAgICBmaWVsZHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGtleTogJ2NvdW50eV9vZl9maWxpbmcnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBub3RlczogJ0NTVi1kZXJpdmVkIChkb2NzL2dhX2NvdW50aWVzLmNzdiknLFxuICAgICAgICB9LFxuICAgICAgICB7IGtleTogJ3Jlc2lkZW5jeV9kdXJhdGlvbl9tb250aHMnLCB0eXBlOiAnbnVtYmVyJywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAgeyBrZXk6ICdvcHBvc2luZ19yZXNpZGVzX2luX2dhJywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogZmFsc2UgfSxcbiAgICAgICAgeyBrZXk6ICd2ZW51ZV9jb25maXJtZWQnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiBmYWxzZSwgaXNTeXN0ZW06IHRydWUgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICBpZDogJ3ByaW9yX2xlZ2FsX2FjdGlvbnMnLFxuICAgICAgdGl0bGU6ICdQUklPUiBMRUdBTCBBQ1RJT05TJyxcbiAgICAgIGZpZWxkczogW1xuICAgICAgICB7IGtleTogJ3ByaW9yX2Rpdm9yY2VfZmlsaW5ncycsIHR5cGU6ICdib29sZWFuJywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAgeyBrZXk6ICdwcmlvcl9jdXN0b2R5X29yZGVycycsIHR5cGU6ICdib29sZWFuJywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICAgICAgeyBrZXk6ICdjYXNlX251bWJlcnMnLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiBmYWxzZSB9LFxuICAgICAgICB7IGtleTogJ2V4aXN0aW5nX2F0dG9ybmV5JywgdHlwZTogJ2Jvb2xlYW4nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnZGVzaXJlZF9vdXRjb21lcycsXG4gICAgICB0aXRsZTogJ0RFU0lSRUQgT1VUQ09NRVMnLFxuICAgICAgZmllbGRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBrZXk6ICdwcmltYXJ5X2dvYWwnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbXG4gICAgICAgICAgICAnZGl2b3JjZV9maW5hbGl6YXRpb24nLFxuICAgICAgICAgICAgJ2N1c3RvZHlfZGV0ZXJtaW5hdGlvbicsXG4gICAgICAgICAgICAnY3VzdG9keV9tb2RpZmljYXRpb24nLFxuICAgICAgICAgICAgJ3N1cHBvcnRfZXN0YWJsaXNobWVudCcsXG4gICAgICAgICAgICAnc3VwcG9ydF9tb2RpZmljYXRpb24nLFxuICAgICAgICAgICAgJ3Byb3BlcnR5X2RpdmlzaW9uJyxcbiAgICAgICAgICAgICdwcm90ZWN0aXZlX3JlbGllZicsXG4gICAgICAgICAgICAnbGVnYWxfZ3VpZGFuY2UnLFxuICAgICAgICAgICAgJ290aGVyJyxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnc2V0dGxlbWVudF9wcmVmZXJlbmNlJyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZW51bVZhbHVlczogW1xuICAgICAgICAgICAgJ3N0cm9uZ2x5X3ByZWZlcl9zZXR0bGVtZW50JyxcbiAgICAgICAgICAgICdwcmVmZXJfc2V0dGxlbWVudCcsXG4gICAgICAgICAgICAnb3Blbl90b19laXRoZXInLFxuICAgICAgICAgICAgJ3ByZWZlcl9saXRpZ2F0aW9uJyxcbiAgICAgICAgICAgICdzdHJvbmdseV9wcmVmZXJfbGl0aWdhdGlvbicsXG4gICAgICAgICAgICAndW5zdXJlJyxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnbGl0aWdhdGlvbl90b2xlcmFuY2UnLFxuICAgICAgICAgIHR5cGU6ICdlbnVtJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBlbnVtVmFsdWVzOiBbJ2xvdycsICdtb2RlcmF0ZScsICdoaWdoJywgJ3Vua25vd24nXSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBrZXk6ICdub25fbmVnb3RpYWJsZXMnLCB0eXBlOiAndGV4dCcsIHJlcXVpcmVkOiBmYWxzZSB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGlkOiAnZXZpZGVuY2VfZG9jdW1lbnRzJyxcbiAgICAgIHRpdGxlOiAnRVZJREVOQ0UgJiBET0NVTUVOVFMnLFxuICAgICAgZmllbGRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBrZXk6ICdkb2N1bWVudF90eXBlJyxcbiAgICAgICAgICB0eXBlOiAnZW51bScsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGVudW1WYWx1ZXM6IFtcbiAgICAgICAgICAgICdwYXlfc3R1YicsXG4gICAgICAgICAgICAndGF4X3JldHVybicsXG4gICAgICAgICAgICAnYmFua19zdGF0ZW1lbnQnLFxuICAgICAgICAgICAgJ2ZpbmFuY2lhbF9zdGF0ZW1lbnQnLFxuICAgICAgICAgICAgJ3JlYWxfZXN0YXRlX2RvY3VtZW50JyxcbiAgICAgICAgICAgICd2ZWhpY2xlX3RpdGxlJyxcbiAgICAgICAgICAgICdyZXRpcmVtZW50X3N0YXRlbWVudCcsXG4gICAgICAgICAgICAnYnVzaW5lc3NfcmVjb3JkJyxcbiAgICAgICAgICAgICd0ZXh0X21lc3NhZ2UnLFxuICAgICAgICAgICAgJ2VtYWlsJyxcbiAgICAgICAgICAgICdwaG90bycsXG4gICAgICAgICAgICAndmlkZW8nLFxuICAgICAgICAgICAgJ3BvbGljZV9yZXBvcnQnLFxuICAgICAgICAgICAgJ2NvdXJ0X29yZGVyJyxcbiAgICAgICAgICAgICdwcm90ZWN0aXZlX29yZGVyJyxcbiAgICAgICAgICAgICdtZWRpY2FsX3JlY29yZCcsXG4gICAgICAgICAgICAnc2Nob29sX3JlY29yZCcsXG4gICAgICAgICAgICAnb3RoZXInLFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICAgIHsga2V5OiAndXBsb2FkZWQnLCB0eXBlOiAnYm9vbGVhbicsIHJlcXVpcmVkOiBmYWxzZSB9LFxuICAgICAgICB7XG4gICAgICAgICAga2V5OiAnbWlzc2luZ19yZXF1aXJlZF9kb2NzJyxcbiAgICAgICAgICB0eXBlOiAnbGlzdCcsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGlzU3lzdGVtOiB0cnVlLFxuICAgICAgICAgIG5vdGVzOiAnc3lzdGVtLW9ubHknLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICBdLFxufTtcblxuZXhwb3J0IGNvbnN0IEdBX0RJVk9SQ0VfQ1VTVE9EWV9WMV9BSV9GTEFHUzogQWlGbGFnRGVmW10gPSBbXG4gIHsga2V5OiAnanVyaXNkaWN0aW9uX3Jpc2snLCB0cmlnZ2VyOiAnUmVzaWRlbmN5IC8gdmVudWUgbWlzbWF0Y2gnIH0sXG4gIHsga2V5OiAnZHZfcmlzaycsIHRyaWdnZXI6ICdEViBpbmRpY2F0ZWQgKyB3ZWFwb25zIHByZXNlbnQnIH0sXG4gIHsga2V5OiAnY3VzdG9keV9jb21wbGV4aXR5JywgdHJpZ2dlcjogJ011bHRpcGxlIGNoaWxkcmVuICsgc3BlY2lhbCBuZWVkcycgfSxcbiAgeyBrZXk6ICdhc3NldF9jb21wbGV4aXR5JywgdHJpZ2dlcjogJ0J1c2luZXNzIC8gaGlnaC12YWx1ZSBhc3NldHMgZGV0ZWN0ZWQnIH0sXG4gIHsga2V5OiAnc3VwcG9ydF9jb21wbGV4aXR5JywgdHJpZ2dlcjogJ1N1cHBvcnQgcmVxdWVzdGVkICsgaW5jb21lIGRpc3Bhcml0eScgfSxcbiAgeyBrZXk6ICdtaXNzaW5nX3JlcXVpcmVkJywgdHJpZ2dlcjogJ1JlcXVpcmVkIGZpZWxkcyBtaXNzaW5nIGF0IHN1Ym1pc3Npb24nIH0sXG5dO1xuIl0sIm5hbWVzIjpbIkdBX0RJVk9SQ0VfQ1VTVE9EWV9WMSIsInZlcnNpb24iLCJzZWN0aW9ucyIsImlkIiwidGl0bGUiLCJmaWVsZHMiLCJrZXkiLCJ0eXBlIiwicmVxdWlyZWQiLCJub3RlcyIsImVudW1WYWx1ZXMiLCJpc1N5c3RlbSIsIkdBX0RJVk9SQ0VfQ1VTVE9EWV9WMV9BSV9GTEFHUyIsInRyaWdnZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../lib/intake/schema/gaDivorceCustodyV1.ts\n");

/***/ }),

/***/ "(api-node)/../../lib/server/intakeToken.ts":
/*!***************************************!*\
  !*** ../../lib/server/intakeToken.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createIntakeToken: () => (/* binding */ createIntakeToken),\n/* harmony export */   verifyIntakeToken: () => (/* binding */ verifyIntakeToken)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nif (false) {}\nfunction getRequiredEnv(name) {\n    const value = process.env[name];\n    if (!value) {\n        throw new Error(`Missing ${name}`);\n    }\n    return value;\n}\nconst INTAKE_TOKEN_SECRET = getRequiredEnv('INTAKE_TOKEN_SECRET');\nconst TOKEN_VERSION = 1;\nconst DEFAULT_TOKEN_TTL_SECONDS = 60 * 60 * 24 * 30;\nfunction base64UrlEncode(input) {\n    const buffer = typeof input === 'string' ? Buffer.from(input, 'utf8') : input;\n    return buffer.toString('base64').replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=+$/g, '');\n}\nfunction base64UrlDecode(input) {\n    const normalized = input.replace(/-/g, '+').replace(/_/g, '/');\n    const padded = normalized.padEnd(Math.ceil(normalized.length / 4) * 4, '=');\n    return Buffer.from(padded, 'base64');\n}\nfunction signPayload(payloadB64) {\n    const signature = crypto__WEBPACK_IMPORTED_MODULE_0___default().createHmac('sha256', INTAKE_TOKEN_SECRET).update(payloadB64).digest();\n    return base64UrlEncode(signature);\n}\nfunction createIntakeToken(params) {\n    const exp = Math.floor(Date.now() / 1000) + (params.expiresInSeconds ?? DEFAULT_TOKEN_TTL_SECONDS);\n    const payload = {\n        firm_id: params.firmId,\n        intake_id: params.intakeId,\n        exp,\n        v: TOKEN_VERSION\n    };\n    const payloadB64 = base64UrlEncode(JSON.stringify(payload));\n    const signatureB64 = signPayload(payloadB64);\n    return `${payloadB64}.${signatureB64}`;\n}\nfunction verifyIntakeToken(token) {\n    const parts = token.split('.');\n    if (parts.length !== 2) {\n        return {\n            ok: false,\n            status: 401,\n            error: 'Invalid intake token'\n        };\n    }\n    const [payloadB64, signatureB64] = parts;\n    const expectedSignature = signPayload(payloadB64);\n    const signatureBuffer = Buffer.from(signatureB64, 'utf8');\n    const expectedBuffer = Buffer.from(expectedSignature, 'utf8');\n    if (signatureBuffer.length !== expectedBuffer.length) {\n        return {\n            ok: false,\n            status: 401,\n            error: 'Invalid intake token'\n        };\n    }\n    if (!crypto__WEBPACK_IMPORTED_MODULE_0___default().timingSafeEqual(signatureBuffer, expectedBuffer)) {\n        return {\n            ok: false,\n            status: 401,\n            error: 'Invalid intake token'\n        };\n    }\n    let payload;\n    try {\n        payload = JSON.parse(base64UrlDecode(payloadB64).toString('utf8'));\n    } catch  {\n        return {\n            ok: false,\n            status: 401,\n            error: 'Invalid intake token'\n        };\n    }\n    if (!payload.firm_id || !payload.intake_id || typeof payload.exp !== 'number') {\n        return {\n            ok: false,\n            status: 401,\n            error: 'Invalid intake token'\n        };\n    }\n    if (payload.v !== TOKEN_VERSION) {\n        return {\n            ok: false,\n            status: 401,\n            error: 'Invalid intake token'\n        };\n    }\n    if (payload.exp <= Math.floor(Date.now() / 1000)) {\n        return {\n            ok: false,\n            status: 403,\n            error: 'Intake token expired'\n        };\n    }\n    return {\n        ok: true,\n        payload\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9saWIvc2VydmVyL2ludGFrZVRva2VuLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBNEI7QUFFNUIsSUFBSSxLQUE2QixFQUFFLEVBRWxDO0FBRUQsU0FBU0UsZUFBZUMsSUFBWTtJQUNsQyxNQUFNQyxRQUFRQyxRQUFRQyxHQUFHLENBQUNILEtBQUs7SUFDL0IsSUFBSSxDQUFDQyxPQUFPO1FBQ1YsTUFBTSxJQUFJSCxNQUFNLENBQUMsUUFBUSxFQUFFRSxNQUFNO0lBQ25DO0lBQ0EsT0FBT0M7QUFDVDtBQUVBLE1BQU1HLHNCQUFzQkwsZUFBZTtBQUUzQyxNQUFNTSxnQkFBZ0I7QUFDdEIsTUFBTUMsNEJBQTRCLEtBQUssS0FBSyxLQUFLO0FBYWpELFNBQVNDLGdCQUFnQkMsS0FBc0I7SUFDN0MsTUFBTUMsU0FBUyxPQUFPRCxVQUFVLFdBQVdFLE9BQU9DLElBQUksQ0FBQ0gsT0FBTyxVQUFVQTtJQUN4RSxPQUFPQyxPQUNKRyxRQUFRLENBQUMsVUFDVEMsT0FBTyxDQUFDLE9BQU8sS0FDZkEsT0FBTyxDQUFDLE9BQU8sS0FDZkEsT0FBTyxDQUFDLFFBQVE7QUFDckI7QUFFQSxTQUFTQyxnQkFBZ0JOLEtBQWE7SUFDcEMsTUFBTU8sYUFBYVAsTUFBTUssT0FBTyxDQUFDLE1BQU0sS0FBS0EsT0FBTyxDQUFDLE1BQU07SUFDMUQsTUFBTUcsU0FBU0QsV0FBV0UsTUFBTSxDQUFDQyxLQUFLQyxJQUFJLENBQUNKLFdBQVdLLE1BQU0sR0FBRyxLQUFLLEdBQUc7SUFDdkUsT0FBT1YsT0FBT0MsSUFBSSxDQUFDSyxRQUFRO0FBQzdCO0FBRUEsU0FBU0ssWUFBWUMsVUFBa0I7SUFDckMsTUFBTUMsWUFBWTFCLHdEQUNMLENBQUMsVUFBVU8scUJBQ3JCcUIsTUFBTSxDQUFDSCxZQUNQSSxNQUFNO0lBQ1QsT0FBT25CLGdCQUFnQmdCO0FBQ3pCO0FBRU8sU0FBU0ksa0JBQWtCQyxNQUlqQztJQUNDLE1BQU1DLE1BQU1YLEtBQUtZLEtBQUssQ0FBQ0MsS0FBS0MsR0FBRyxLQUFLLFFBQy9CSixDQUFBQSxPQUFPSyxnQkFBZ0IsSUFBSTNCLHlCQUF3QjtJQUV4RCxNQUFNNEIsVUFBOEI7UUFDbENDLFNBQVNQLE9BQU9RLE1BQU07UUFDdEJDLFdBQVdULE9BQU9VLFFBQVE7UUFDMUJUO1FBQ0FVLEdBQUdsQztJQUNMO0lBRUEsTUFBTWlCLGFBQWFmLGdCQUFnQmlDLEtBQUtDLFNBQVMsQ0FBQ1A7SUFDbEQsTUFBTVEsZUFBZXJCLFlBQVlDO0lBQ2pDLE9BQU8sR0FBR0EsV0FBVyxDQUFDLEVBQUVvQixjQUFjO0FBQ3hDO0FBRU8sU0FBU0Msa0JBQWtCQyxLQUFhO0lBQzdDLE1BQU1DLFFBQVFELE1BQU1FLEtBQUssQ0FBQztJQUMxQixJQUFJRCxNQUFNekIsTUFBTSxLQUFLLEdBQUc7UUFDdEIsT0FBTztZQUFFMkIsSUFBSTtZQUFPQyxRQUFRO1lBQUtDLE9BQU87UUFBdUI7SUFDakU7SUFFQSxNQUFNLENBQUMzQixZQUFZb0IsYUFBYSxHQUFHRztJQUNuQyxNQUFNSyxvQkFBb0I3QixZQUFZQztJQUV0QyxNQUFNNkIsa0JBQWtCekMsT0FBT0MsSUFBSSxDQUFDK0IsY0FBYztJQUNsRCxNQUFNVSxpQkFBaUIxQyxPQUFPQyxJQUFJLENBQUN1QyxtQkFBbUI7SUFDdEQsSUFBSUMsZ0JBQWdCL0IsTUFBTSxLQUFLZ0MsZUFBZWhDLE1BQU0sRUFBRTtRQUNwRCxPQUFPO1lBQUUyQixJQUFJO1lBQU9DLFFBQVE7WUFBS0MsT0FBTztRQUF1QjtJQUNqRTtJQUVBLElBQUksQ0FBQ3BELDZEQUFzQixDQUFDc0QsaUJBQWlCQyxpQkFBaUI7UUFDNUQsT0FBTztZQUFFTCxJQUFJO1lBQU9DLFFBQVE7WUFBS0MsT0FBTztRQUF1QjtJQUNqRTtJQUVBLElBQUlmO0lBQ0osSUFBSTtRQUNGQSxVQUFVTSxLQUFLYyxLQUFLLENBQUN4QyxnQkFBZ0JRLFlBQVlWLFFBQVEsQ0FBQztJQUM1RCxFQUFFLE9BQU07UUFDTixPQUFPO1lBQUVtQyxJQUFJO1lBQU9DLFFBQVE7WUFBS0MsT0FBTztRQUF1QjtJQUNqRTtJQUVBLElBQUksQ0FBQ2YsUUFBUUMsT0FBTyxJQUFJLENBQUNELFFBQVFHLFNBQVMsSUFBSSxPQUFPSCxRQUFRTCxHQUFHLEtBQUssVUFBVTtRQUM3RSxPQUFPO1lBQUVrQixJQUFJO1lBQU9DLFFBQVE7WUFBS0MsT0FBTztRQUF1QjtJQUNqRTtJQUVBLElBQUlmLFFBQVFLLENBQUMsS0FBS2xDLGVBQWU7UUFDL0IsT0FBTztZQUFFMEMsSUFBSTtZQUFPQyxRQUFRO1lBQUtDLE9BQU87UUFBdUI7SUFDakU7SUFFQSxJQUFJZixRQUFRTCxHQUFHLElBQUlYLEtBQUtZLEtBQUssQ0FBQ0MsS0FBS0MsR0FBRyxLQUFLLE9BQU87UUFDaEQsT0FBTztZQUFFZSxJQUFJO1lBQU9DLFFBQVE7WUFBS0MsT0FBTztRQUF1QjtJQUNqRTtJQUVBLE9BQU87UUFBRUYsSUFBSTtRQUFNYjtJQUFRO0FBQzdCIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL2xpYi9zZXJ2ZXIvaW50YWtlVG9rZW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuXG5pZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdpbnRha2VUb2tlbiBpcyBzZXJ2ZXItb25seScpO1xufVxuXG5mdW5jdGlvbiBnZXRSZXF1aXJlZEVudihuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W25hbWVdO1xuICBpZiAoIXZhbHVlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nICR7bmFtZX1gKTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmNvbnN0IElOVEFLRV9UT0tFTl9TRUNSRVQgPSBnZXRSZXF1aXJlZEVudignSU5UQUtFX1RPS0VOX1NFQ1JFVCcpO1xuXG5jb25zdCBUT0tFTl9WRVJTSU9OID0gMTtcbmNvbnN0IERFRkFVTFRfVE9LRU5fVFRMX1NFQ09ORFMgPSA2MCAqIDYwICogMjQgKiAzMDtcblxuZXhwb3J0IHR5cGUgSW50YWtlVG9rZW5QYXlsb2FkID0ge1xuICBmaXJtX2lkOiBzdHJpbmc7XG4gIGludGFrZV9pZDogc3RyaW5nO1xuICBleHA6IG51bWJlcjtcbiAgdjogbnVtYmVyO1xufTtcblxudHlwZSBWZXJpZnlSZXN1bHQgPVxuICB8IHsgb2s6IHRydWU7IHBheWxvYWQ6IEludGFrZVRva2VuUGF5bG9hZCB9XG4gIHwgeyBvazogZmFsc2U7IHN0YXR1czogbnVtYmVyOyBlcnJvcjogc3RyaW5nIH07XG5cbmZ1bmN0aW9uIGJhc2U2NFVybEVuY29kZShpbnB1dDogQnVmZmVyIHwgc3RyaW5nKSB7XG4gIGNvbnN0IGJ1ZmZlciA9IHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycgPyBCdWZmZXIuZnJvbShpbnB1dCwgJ3V0ZjgnKSA6IGlucHV0O1xuICByZXR1cm4gYnVmZmVyXG4gICAgLnRvU3RyaW5nKCdiYXNlNjQnKVxuICAgIC5yZXBsYWNlKC9cXCsvZywgJy0nKVxuICAgIC5yZXBsYWNlKC9cXC8vZywgJ18nKVxuICAgIC5yZXBsYWNlKC89KyQvZywgJycpO1xufVxuXG5mdW5jdGlvbiBiYXNlNjRVcmxEZWNvZGUoaW5wdXQ6IHN0cmluZykge1xuICBjb25zdCBub3JtYWxpemVkID0gaW5wdXQucmVwbGFjZSgvLS9nLCAnKycpLnJlcGxhY2UoL18vZywgJy8nKTtcbiAgY29uc3QgcGFkZGVkID0gbm9ybWFsaXplZC5wYWRFbmQoTWF0aC5jZWlsKG5vcm1hbGl6ZWQubGVuZ3RoIC8gNCkgKiA0LCAnPScpO1xuICByZXR1cm4gQnVmZmVyLmZyb20ocGFkZGVkLCAnYmFzZTY0Jyk7XG59XG5cbmZ1bmN0aW9uIHNpZ25QYXlsb2FkKHBheWxvYWRCNjQ6IHN0cmluZykge1xuICBjb25zdCBzaWduYXR1cmUgPSBjcnlwdG9cbiAgICAuY3JlYXRlSG1hYygnc2hhMjU2JywgSU5UQUtFX1RPS0VOX1NFQ1JFVClcbiAgICAudXBkYXRlKHBheWxvYWRCNjQpXG4gICAgLmRpZ2VzdCgpO1xuICByZXR1cm4gYmFzZTY0VXJsRW5jb2RlKHNpZ25hdHVyZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnRha2VUb2tlbihwYXJhbXM6IHtcbiAgZmlybUlkOiBzdHJpbmc7XG4gIGludGFrZUlkOiBzdHJpbmc7XG4gIGV4cGlyZXNJblNlY29uZHM/OiBudW1iZXI7XG59KSB7XG4gIGNvbnN0IGV4cCA9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApXG4gICAgKyAocGFyYW1zLmV4cGlyZXNJblNlY29uZHMgPz8gREVGQVVMVF9UT0tFTl9UVExfU0VDT05EUyk7XG5cbiAgY29uc3QgcGF5bG9hZDogSW50YWtlVG9rZW5QYXlsb2FkID0ge1xuICAgIGZpcm1faWQ6IHBhcmFtcy5maXJtSWQsXG4gICAgaW50YWtlX2lkOiBwYXJhbXMuaW50YWtlSWQsXG4gICAgZXhwLFxuICAgIHY6IFRPS0VOX1ZFUlNJT04sXG4gIH07XG5cbiAgY29uc3QgcGF5bG9hZEI2NCA9IGJhc2U2NFVybEVuY29kZShKU09OLnN0cmluZ2lmeShwYXlsb2FkKSk7XG4gIGNvbnN0IHNpZ25hdHVyZUI2NCA9IHNpZ25QYXlsb2FkKHBheWxvYWRCNjQpO1xuICByZXR1cm4gYCR7cGF5bG9hZEI2NH0uJHtzaWduYXR1cmVCNjR9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeUludGFrZVRva2VuKHRva2VuOiBzdHJpbmcpOiBWZXJpZnlSZXN1bHQge1xuICBjb25zdCBwYXJ0cyA9IHRva2VuLnNwbGl0KCcuJyk7XG4gIGlmIChwYXJ0cy5sZW5ndGggIT09IDIpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIHN0YXR1czogNDAxLCBlcnJvcjogJ0ludmFsaWQgaW50YWtlIHRva2VuJyB9O1xuICB9XG5cbiAgY29uc3QgW3BheWxvYWRCNjQsIHNpZ25hdHVyZUI2NF0gPSBwYXJ0cztcbiAgY29uc3QgZXhwZWN0ZWRTaWduYXR1cmUgPSBzaWduUGF5bG9hZChwYXlsb2FkQjY0KTtcblxuICBjb25zdCBzaWduYXR1cmVCdWZmZXIgPSBCdWZmZXIuZnJvbShzaWduYXR1cmVCNjQsICd1dGY4Jyk7XG4gIGNvbnN0IGV4cGVjdGVkQnVmZmVyID0gQnVmZmVyLmZyb20oZXhwZWN0ZWRTaWduYXR1cmUsICd1dGY4Jyk7XG4gIGlmIChzaWduYXR1cmVCdWZmZXIubGVuZ3RoICE9PSBleHBlY3RlZEJ1ZmZlci5sZW5ndGgpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIHN0YXR1czogNDAxLCBlcnJvcjogJ0ludmFsaWQgaW50YWtlIHRva2VuJyB9O1xuICB9XG5cbiAgaWYgKCFjcnlwdG8udGltaW5nU2FmZUVxdWFsKHNpZ25hdHVyZUJ1ZmZlciwgZXhwZWN0ZWRCdWZmZXIpKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBzdGF0dXM6IDQwMSwgZXJyb3I6ICdJbnZhbGlkIGludGFrZSB0b2tlbicgfTtcbiAgfVxuXG4gIGxldCBwYXlsb2FkOiBJbnRha2VUb2tlblBheWxvYWQ7XG4gIHRyeSB7XG4gICAgcGF5bG9hZCA9IEpTT04ucGFyc2UoYmFzZTY0VXJsRGVjb2RlKHBheWxvYWRCNjQpLnRvU3RyaW5nKCd1dGY4JykpIGFzIEludGFrZVRva2VuUGF5bG9hZDtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBzdGF0dXM6IDQwMSwgZXJyb3I6ICdJbnZhbGlkIGludGFrZSB0b2tlbicgfTtcbiAgfVxuXG4gIGlmICghcGF5bG9hZC5maXJtX2lkIHx8ICFwYXlsb2FkLmludGFrZV9pZCB8fCB0eXBlb2YgcGF5bG9hZC5leHAgIT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBzdGF0dXM6IDQwMSwgZXJyb3I6ICdJbnZhbGlkIGludGFrZSB0b2tlbicgfTtcbiAgfVxuXG4gIGlmIChwYXlsb2FkLnYgIT09IFRPS0VOX1ZFUlNJT04pIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIHN0YXR1czogNDAxLCBlcnJvcjogJ0ludmFsaWQgaW50YWtlIHRva2VuJyB9O1xuICB9XG5cbiAgaWYgKHBheWxvYWQuZXhwIDw9IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBzdGF0dXM6IDQwMywgZXJyb3I6ICdJbnRha2UgdG9rZW4gZXhwaXJlZCcgfTtcbiAgfVxuXG4gIHJldHVybiB7IG9rOiB0cnVlLCBwYXlsb2FkIH07XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiRXJyb3IiLCJnZXRSZXF1aXJlZEVudiIsIm5hbWUiLCJ2YWx1ZSIsInByb2Nlc3MiLCJlbnYiLCJJTlRBS0VfVE9LRU5fU0VDUkVUIiwiVE9LRU5fVkVSU0lPTiIsIkRFRkFVTFRfVE9LRU5fVFRMX1NFQ09ORFMiLCJiYXNlNjRVcmxFbmNvZGUiLCJpbnB1dCIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJ0b1N0cmluZyIsInJlcGxhY2UiLCJiYXNlNjRVcmxEZWNvZGUiLCJub3JtYWxpemVkIiwicGFkZGVkIiwicGFkRW5kIiwiTWF0aCIsImNlaWwiLCJsZW5ndGgiLCJzaWduUGF5bG9hZCIsInBheWxvYWRCNjQiLCJzaWduYXR1cmUiLCJjcmVhdGVIbWFjIiwidXBkYXRlIiwiZGlnZXN0IiwiY3JlYXRlSW50YWtlVG9rZW4iLCJwYXJhbXMiLCJleHAiLCJmbG9vciIsIkRhdGUiLCJub3ciLCJleHBpcmVzSW5TZWNvbmRzIiwicGF5bG9hZCIsImZpcm1faWQiLCJmaXJtSWQiLCJpbnRha2VfaWQiLCJpbnRha2VJZCIsInYiLCJKU09OIiwic3RyaW5naWZ5Iiwic2lnbmF0dXJlQjY0IiwidmVyaWZ5SW50YWtlVG9rZW4iLCJ0b2tlbiIsInBhcnRzIiwic3BsaXQiLCJvayIsInN0YXR1cyIsImVycm9yIiwiZXhwZWN0ZWRTaWduYXR1cmUiLCJzaWduYXR1cmVCdWZmZXIiLCJleHBlY3RlZEJ1ZmZlciIsInRpbWluZ1NhZmVFcXVhbCIsInBhcnNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../lib/server/intakeToken.ts\n");

/***/ }),

/***/ "(api-node)/../../lib/server/supabaseAdmin.ts":
/*!*****************************************!*\
  !*** ../../lib/server/supabaseAdmin.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n\nif (false) {}\nconst supabaseUrl = process.env.SUPABASE_URL;\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nif (!supabaseUrl || !serviceRoleKey) {\n    throw new Error('Missing SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY');\n}\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, serviceRoleKey, {\n    auth: {\n        persistSession: false,\n        autoRefreshToken: false\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9saWIvc2VydmVyL3N1cGFiYXNlQWRtaW4udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXFEO0FBRXJELElBQUksS0FBNkIsRUFBRSxFQUVsQztBQUVELE1BQU1FLGNBQWNDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWTtBQUM1QyxNQUFNQyxpQkFBaUJILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCO0FBRTVELElBQUksQ0FBQ0wsZUFBZSxDQUFDSSxnQkFBZ0I7SUFDbkMsTUFBTSxJQUFJTCxNQUFNO0FBQ2xCO0FBRU8sTUFBTU8sZ0JBQWdCUixtRUFBWUEsQ0FBQ0UsYUFBYUksZ0JBQWdCO0lBQ3JFRyxNQUFNO1FBQ0pDLGdCQUFnQjtRQUNoQkMsa0JBQWtCO0lBQ3BCO0FBQ0YsR0FBRyIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9saWIvc2VydmVyL3N1cGFiYXNlQWRtaW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIHRocm93IG5ldyBFcnJvcignc3VwYWJhc2VBZG1pbiBpcyBzZXJ2ZXItb25seScpO1xufVxuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1VSTDtcbmNvbnN0IHNlcnZpY2VSb2xlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWTtcblxuaWYgKCFzdXBhYmFzZVVybCB8fCAhc2VydmljZVJvbGVLZXkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFNVUEFCQVNFX1VSTCBvciBTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZJyk7XG59XG5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzZXJ2aWNlUm9sZUtleSwge1xuICBhdXRoOiB7XG4gICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLFxuICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxuICB9LFxufSk7XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwiRXJyb3IiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJTVVBBQkFTRV9VUkwiLCJzZXJ2aWNlUm9sZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJzdXBhYmFzZUFkbWluIiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwiYXV0b1JlZnJlc2hUb2tlbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../../lib/server/supabaseAdmin.ts\n");

/***/ }),

/***/ "(api-node)/../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fintake%2Fsubmit&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fintake%2Fsubmit.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fintake%2Fsubmit&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fintake%2Fsubmit.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   handler: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/api-utils */ \"(api-node)/../../node_modules/next/dist/server/api-utils/index.js\");\n/* harmony import */ var next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/../../node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/../../node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/../../node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_intake_submit_ts__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./pages/api/intake/submit.ts */ \"(api-node)/./pages/api/intake/submit.ts\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(api-node)/../../node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(api-node)/../../node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n// Import the userland code.\n\n\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_pages_api_intake_submit_ts__WEBPACK_IMPORTED_MODULE_4__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_3__.hoist)(_pages_api_intake_submit_ts__WEBPACK_IMPORTED_MODULE_4__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_2__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/intake/submit\",\n        pathname: \"/api/intake/submit\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_intake_submit_ts__WEBPACK_IMPORTED_MODULE_4__,\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || ''\n});\nasync function handler(req, res, ctx) {\n    let srcPage = \"/api/intake/submit\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {}\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.getTracer)();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: [],\n                multiZoneDraftMode: Boolean(false),\n                trustHostHeader: false,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/intake/submit\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_6__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_5__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        (0,next_dist_server_api_utils__WEBPACK_IMPORTED_MODULE_0__.sendError)(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmludGFrZSUyRnN1Ym1pdCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGaW50YWtlJTJGc3VibWl0LnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUF1RDtBQUNDO0FBQ3VDO0FBQ3JDO0FBQzFEO0FBQ3lEO0FBQ2U7QUFDRjtBQUN0RTtBQUNBLGlFQUFlLHdFQUFLLENBQUMsd0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHdEQUFRO0FBQ3BDO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osYUFBYSxPQUFvQyxJQUFJLENBQUU7QUFDdkQsd0JBQXdCLE1BQXVDO0FBQy9ELENBQUM7QUFDTTtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxLQUFxQixFQUFFLEVBRTFCO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdEQUF3RDtBQUNwRTtBQUNBO0FBQ0EsdUJBQXVCLDRFQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLDZDQUE2QyxFQUE2QztBQUMxRiw0Q0FBNEMsS0FBd0M7QUFDcEYsaUNBQWlDLEtBQW9DO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnRkFBYztBQUMvRSwrREFBK0QseUNBQXlDO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVEsRUFBRSxNQUFNO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0Esa0JBQWtCO0FBQ2xCLHVDQUF1QyxRQUFRLEVBQUUsUUFBUTtBQUN6RDtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2RUFBNkUsZ0ZBQWM7QUFDM0YsaUNBQWlDLFFBQVEsRUFBRSxRQUFRO0FBQ25ELDBCQUEwQix1RUFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHFFQUFTO0FBQ2pCLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzZW5kRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9hcGktdXRpbHNcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2ludGFrZS9zdWJtaXQudHNcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvaW50YWtlL3N1Ym1pdFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2ludGFrZS9zdWJtaXRcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZCxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJydcbn0pO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL2ludGFrZS9zdWJtaXRcIjtcbiAgICAvLyB0dXJib3BhY2sgZG9lc24ndCBub3JtYWxpemUgYC9pbmRleGAgaW4gdGhlIHBhZ2UgbmFtZVxuICAgIC8vIHNvIHdlIG5lZWQgdG8gdG8gcHJvY2VzcyBkeW5hbWljIHJvdXRlcyBwcm9wZXJseVxuICAgIC8vIFRPRE86IGZpeCB0dXJib3BhY2sgcHJvdmlkaW5nIGRpZmZlcmluZyB2YWx1ZSBmcm9tIHdlYnBhY2tcbiAgICBpZiAocHJvY2Vzcy5lbnYuVFVSQk9QQUNLKSB7XG4gICAgICAgIHNyY1BhZ2UgPSBzcmNQYWdlLnJlcGxhY2UoL1xcL2luZGV4JC8sICcnKSB8fCAnLyc7XG4gICAgfVxuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2VcbiAgICB9KTtcbiAgICBpZiAoIXByZXBhcmVSZXN1bHQpIHtcbiAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDA7XG4gICAgICAgIHJlcy5lbmQoJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgICAgIGN0eC53YWl0VW50aWwgPT0gbnVsbCA/IHZvaWQgMCA6IGN0eC53YWl0VW50aWwuY2FsbChjdHgsIFByb21pc2UucmVzb2x2ZSgpKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCB7IHF1ZXJ5LCBwYXJhbXMsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0IH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgICAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgICAgICBjb25zdCBvblJlcXVlc3RFcnJvciA9IHJvdXRlTW9kdWxlLmluc3RydW1lbnRhdGlvbk9uUmVxdWVzdEVycm9yLmJpbmQocm91dGVNb2R1bGUpO1xuICAgICAgICBjb25zdCBpbnZva2VSb3V0ZU1vZHVsZSA9IGFzeW5jIChzcGFuKT0+cm91dGVNb2R1bGUucmVuZGVyKHJlcSwgcmVzLCB7XG4gICAgICAgICAgICAgICAgcXVlcnk6IHtcbiAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgIGFsbG93ZWRSZXZhbGlkYXRlSGVhZGVyS2V5czogcHJvY2Vzcy5lbnYuX19ORVhUX0FMTE9XRURfUkVWQUxJREFURV9IRUFERVJTLFxuICAgICAgICAgICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZTogQm9vbGVhbihwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFKSxcbiAgICAgICAgICAgICAgICB0cnVzdEhvc3RIZWFkZXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9UUlVTVF9IT1NUX0hFQURFUixcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBnZXQgdGhpcyBmcm9tIGZyb20gcnVudGltZSBlbnYgc28gbWFuaWZlc3RcbiAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IG5lZWQgdG8gbG9hZFxuICAgICAgICAgICAgICAgIHByZXZpZXdQcm9wczogcHJlcmVuZGVyTWFuaWZlc3QucHJldmlldyxcbiAgICAgICAgICAgICAgICBwcm9wYWdhdGVFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgZGV2OiByb3V0ZU1vZHVsZS5pc0RldixcbiAgICAgICAgICAgICAgICBwYWdlOiBcIi9hcGkvaW50YWtlL3N1Ym1pdFwiLFxuICAgICAgICAgICAgICAgIGludGVybmFsUmV2YWxpZGF0ZTogcm91dGVyU2VydmVyQ29udGV4dCA9PSBudWxsID8gdm9pZCAwIDogcm91dGVyU2VydmVyQ29udGV4dC5yZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIG9uRXJyb3I6ICguLi5hcmdzKT0+b25SZXF1ZXN0RXJyb3IocmVxLCAuLi5hcmdzKVxuICAgICAgICAgICAgfSkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaW52b2tlUm91dGVNb2R1bGUoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaW52b2tlUm91dGVNb2R1bGUpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvLyB3ZSByZS10aHJvdyBpbiBkZXYgdG8gc2hvdyB0aGUgZXJyb3Igb3ZlcmxheVxuICAgICAgICBpZiAocm91dGVNb2R1bGUuaXNEZXYpIHtcbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGlzIGlzIHRlY2huaWNhbGx5IGFuIGludmFyaWFudCBhcyBlcnJvciBoYW5kbGluZ1xuICAgICAgICAvLyBzaG91bGQgYmUgZG9uZSBpbnNpZGUgb2YgYXBpLXJlc29sdmVyIG9uRXJyb3JcbiAgICAgICAgc2VuZEVycm9yKHJlcywgNTAwLCAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyk7XG4gICAgfSBmaW5hbGx5e1xuICAgICAgICAvLyBXZSBkb24ndCBhbGxvdyBhbnkgd2FpdFVudGlsIHdvcmsgaW4gcGFnZXMgQVBJIHJvdXRlcyBjdXJyZW50bHlcbiAgICAgICAgLy8gc28gaWYgY2FsbGJhY2sgaXMgcHJlc2VudCByZXR1cm4gd2l0aCByZXNvbHZlZCBwcm9taXNlIHNpbmNlIG5vXG4gICAgICAgIC8vIHBlbmRpbmcgd29ya1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fintake%2Fsubmit&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fintake%2Fsubmit.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/catalog/loadRuleCatalog.ts":
/*!******************************************************!*\
  !*** ../../src/workflow3/catalog/loadRuleCatalog.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_RULE_CATALOG_PATH: () => (/* binding */ DEFAULT_RULE_CATALOG_PATH),\n/* harmony export */   getRuleCatalog: () => (/* binding */ getRuleCatalog),\n/* harmony export */   loadRuleCatalog: () => (/* binding */ loadRuleCatalog)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _validateRuleCatalog__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./validateRuleCatalog */ \"(api-node)/../../src/workflow3/catalog/validateRuleCatalog.ts\");\n\n\n\nfunction resolveRepoRoot() {\n    const cwd = process.cwd();\n    if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(cwd, 'docs'))) {\n        return cwd;\n    }\n    const candidate = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(cwd, '..', '..');\n    if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(candidate, 'docs'))) {\n        return candidate;\n    }\n    return cwd;\n}\nconst DEFAULT_RULE_CATALOG_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(resolveRepoRoot(), 'docs', 'workflow 3', 'workflow-03-rule-catalog.json');\nlet cachedCatalog = null;\nlet cachedPath = null;\nfunction loadRuleCatalog(catalogPath = DEFAULT_RULE_CATALOG_PATH) {\n    const resolvedPath = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(catalogPath);\n    if (cachedCatalog && cachedPath === resolvedPath) {\n        return cachedCatalog;\n    }\n    const rawText = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(resolvedPath, 'utf8');\n    const parsed = JSON.parse(rawText);\n    const validated = (0,_validateRuleCatalog__WEBPACK_IMPORTED_MODULE_2__.assertValidCatalog)(parsed);\n    cachedCatalog = validated.catalog;\n    cachedPath = resolvedPath;\n    return cachedCatalog;\n}\nfunction getRuleCatalog(catalogPath = DEFAULT_RULE_CATALOG_PATH) {\n    const catalog = loadRuleCatalog(catalogPath);\n    return {\n        catalog,\n        ruleset_version: catalog.ruleset_version\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2NhdGFsb2cvbG9hZFJ1bGVDYXRhbG9nLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQW9CO0FBQ0k7QUFFbUM7QUFFM0QsU0FBU0c7SUFDUCxNQUFNQyxNQUFNQyxRQUFRRCxHQUFHO0lBQ3ZCLElBQUlKLG9EQUFhLENBQUNDLGdEQUFTLENBQUNHLEtBQUssVUFBVTtRQUN6QyxPQUFPQTtJQUNUO0lBQ0EsTUFBTUksWUFBWVAsbURBQVksQ0FBQ0csS0FBSyxNQUFNO0lBQzFDLElBQUlKLG9EQUFhLENBQUNDLGdEQUFTLENBQUNPLFdBQVcsVUFBVTtRQUMvQyxPQUFPQTtJQUNUO0lBQ0EsT0FBT0o7QUFDVDtBQUVPLE1BQU1NLDRCQUE0QlQsZ0RBQVMsQ0FDaERFLG1CQUNBLFFBQ0EsY0FDQSxpQ0FDQTtBQUVGLElBQUlRLGdCQUFvQztBQUN4QyxJQUFJQyxhQUE0QjtBQUV6QixTQUFTQyxnQkFBZ0JDLGNBQWNKLHlCQUF5QjtJQUNyRSxNQUFNSyxlQUFlZCxtREFBWSxDQUFDYTtJQUNsQyxJQUFJSCxpQkFBaUJDLGVBQWVHLGNBQWM7UUFDaEQsT0FBT0o7SUFDVDtJQUNBLE1BQU1LLFVBQVVoQixzREFBZSxDQUFDZSxjQUFjO0lBQzlDLE1BQU1HLFNBQVNDLEtBQUtDLEtBQUssQ0FBQ0o7SUFDMUIsTUFBTUssWUFBWW5CLHdFQUFrQkEsQ0FBQ2dCO0lBQ3JDUCxnQkFBZ0JVLFVBQVVDLE9BQU87SUFDakNWLGFBQWFHO0lBQ2IsT0FBT0o7QUFDVDtBQUVPLFNBQVNZLGVBQWVULGNBQWNKLHlCQUF5QjtJQUNwRSxNQUFNWSxVQUFVVCxnQkFBZ0JDO0lBQ2hDLE9BQU87UUFBRVE7UUFBU0UsaUJBQWlCRixRQUFRRSxlQUFlO0lBQUM7QUFDN0QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9kb21pbmljcmFuZ2hpYXNjaS92ZXJpbGV4LWxhbmRpbmcvc3JjL3dvcmtmbG93My9jYXRhbG9nL2xvYWRSdWxlQ2F0YWxvZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgdHlwZSB7IExvYWRlZFJ1bGVDYXRhbG9nLCBSdWxlQ2F0YWxvZyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgYXNzZXJ0VmFsaWRDYXRhbG9nIH0gZnJvbSAnLi92YWxpZGF0ZVJ1bGVDYXRhbG9nJztcblxuZnVuY3Rpb24gcmVzb2x2ZVJlcG9Sb290KCk6IHN0cmluZyB7XG4gIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKCk7XG4gIGlmIChmcy5leGlzdHNTeW5jKHBhdGguam9pbihjd2QsICdkb2NzJykpKSB7XG4gICAgcmV0dXJuIGN3ZDtcbiAgfVxuICBjb25zdCBjYW5kaWRhdGUgPSBwYXRoLnJlc29sdmUoY3dkLCAnLi4nLCAnLi4nKTtcbiAgaWYgKGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGNhbmRpZGF0ZSwgJ2RvY3MnKSkpIHtcbiAgICByZXR1cm4gY2FuZGlkYXRlO1xuICB9XG4gIHJldHVybiBjd2Q7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1JVTEVfQ0FUQUxPR19QQVRIID0gcGF0aC5qb2luKFxuICByZXNvbHZlUmVwb1Jvb3QoKSxcbiAgJ2RvY3MnLFxuICAnd29ya2Zsb3cgMycsXG4gICd3b3JrZmxvdy0wMy1ydWxlLWNhdGFsb2cuanNvbicsXG4pO1xuXG5sZXQgY2FjaGVkQ2F0YWxvZzogUnVsZUNhdGFsb2cgfCBudWxsID0gbnVsbDtcbmxldCBjYWNoZWRQYXRoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRSdWxlQ2F0YWxvZyhjYXRhbG9nUGF0aCA9IERFRkFVTFRfUlVMRV9DQVRBTE9HX1BBVEgpOiBSdWxlQ2F0YWxvZyB7XG4gIGNvbnN0IHJlc29sdmVkUGF0aCA9IHBhdGgucmVzb2x2ZShjYXRhbG9nUGF0aCk7XG4gIGlmIChjYWNoZWRDYXRhbG9nICYmIGNhY2hlZFBhdGggPT09IHJlc29sdmVkUGF0aCkge1xuICAgIHJldHVybiBjYWNoZWRDYXRhbG9nO1xuICB9XG4gIGNvbnN0IHJhd1RleHQgPSBmcy5yZWFkRmlsZVN5bmMocmVzb2x2ZWRQYXRoLCAndXRmOCcpO1xuICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHJhd1RleHQpIGFzIHVua25vd247XG4gIGNvbnN0IHZhbGlkYXRlZCA9IGFzc2VydFZhbGlkQ2F0YWxvZyhwYXJzZWQpO1xuICBjYWNoZWRDYXRhbG9nID0gdmFsaWRhdGVkLmNhdGFsb2c7XG4gIGNhY2hlZFBhdGggPSByZXNvbHZlZFBhdGg7XG4gIHJldHVybiBjYWNoZWRDYXRhbG9nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UnVsZUNhdGFsb2coY2F0YWxvZ1BhdGggPSBERUZBVUxUX1JVTEVfQ0FUQUxPR19QQVRIKTogTG9hZGVkUnVsZUNhdGFsb2cge1xuICBjb25zdCBjYXRhbG9nID0gbG9hZFJ1bGVDYXRhbG9nKGNhdGFsb2dQYXRoKTtcbiAgcmV0dXJuIHsgY2F0YWxvZywgcnVsZXNldF92ZXJzaW9uOiBjYXRhbG9nLnJ1bGVzZXRfdmVyc2lvbiB9O1xufVxuIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsImFzc2VydFZhbGlkQ2F0YWxvZyIsInJlc29sdmVSZXBvUm9vdCIsImN3ZCIsInByb2Nlc3MiLCJleGlzdHNTeW5jIiwiam9pbiIsImNhbmRpZGF0ZSIsInJlc29sdmUiLCJERUZBVUxUX1JVTEVfQ0FUQUxPR19QQVRIIiwiY2FjaGVkQ2F0YWxvZyIsImNhY2hlZFBhdGgiLCJsb2FkUnVsZUNhdGFsb2ciLCJjYXRhbG9nUGF0aCIsInJlc29sdmVkUGF0aCIsInJhd1RleHQiLCJyZWFkRmlsZVN5bmMiLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiLCJ2YWxpZGF0ZWQiLCJjYXRhbG9nIiwiZ2V0UnVsZUNhdGFsb2ciLCJydWxlc2V0X3ZlcnNpb24iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/catalog/loadRuleCatalog.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/catalog/validateRuleCatalog.ts":
/*!**********************************************************!*\
  !*** ../../src/workflow3/catalog/validateRuleCatalog.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertValidCatalog: () => (/* binding */ assertValidCatalog),\n/* harmony export */   getRulesetVersion: () => (/* binding */ getRulesetVersion),\n/* harmony export */   validateRuleCatalog: () => (/* binding */ validateRuleCatalog)\n/* harmony export */ });\nfunction isRecord(value) {\n    return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\nfunction isString(value) {\n    return typeof value === 'string';\n}\nfunction isBoolean(value) {\n    return typeof value === 'boolean';\n}\nfunction validateStringArray(value, path, errors) {\n    if (!Array.isArray(value)) {\n        errors.push({\n            path,\n            message: 'Expected array of strings'\n        });\n        return;\n    }\n    value.forEach((item, index)=>{\n        if (!isString(item)) {\n            errors.push({\n                path: `${path}[${index}]`,\n                message: 'Expected string'\n            });\n        }\n    });\n}\nfunction validateEvidenceStrategy(value, path, errors) {\n    if (!isRecord(value)) {\n        errors.push({\n            path,\n            message: 'Expected evidence_strategy object'\n        });\n        return false;\n    }\n    if (!isString(value.type)) {\n        errors.push({\n            path: `${path}.type`,\n            message: 'Missing evidence_strategy.type'\n        });\n        return false;\n    }\n    const allowedKeysByType = {\n        missing_or_null: [\n            'type',\n            'paths'\n        ],\n        csv_lookup: [\n            'type',\n            'csv',\n            'input_path',\n            'match_on',\n            'output'\n        ],\n        enum_membership: [\n            'type',\n            'path',\n            'allowed_values'\n        ],\n        type_check: [\n            'type',\n            'path',\n            'expected_type'\n        ],\n        date_order: [\n            'type',\n            'earlier_path',\n            'later_path',\n            'operator'\n        ]\n    };\n    const allowedKeys = allowedKeysByType[value.type];\n    if (!allowedKeys) {\n        errors.push({\n            path: `${path}.type`,\n            message: `Unsupported evidence_strategy type: ${value.type}`\n        });\n        return false;\n    }\n    Object.keys(value).forEach((key)=>{\n        if (!allowedKeys.includes(key)) {\n            errors.push({\n                path: `${path}.${key}`,\n                message: 'Unexpected evidence_strategy key'\n            });\n        }\n    });\n    switch(value.type){\n        case 'missing_or_null':\n            {\n                const strategy = value;\n                validateStringArray(strategy.paths, `${path}.paths`, errors);\n                return true;\n            }\n        case 'csv_lookup':\n            {\n                const strategy = value;\n                if (!isString(strategy.csv)) {\n                    errors.push({\n                        path: `${path}.csv`,\n                        message: 'Expected csv string'\n                    });\n                }\n                if (!isString(strategy.input_path)) {\n                    errors.push({\n                        path: `${path}.input_path`,\n                        message: 'Expected input_path string'\n                    });\n                }\n                validateStringArray(strategy.match_on, `${path}.match_on`, errors);\n                if (!isString(strategy.output)) {\n                    errors.push({\n                        path: `${path}.output`,\n                        message: 'Expected output string'\n                    });\n                }\n                return true;\n            }\n        case 'enum_membership':\n            {\n                const strategy = value;\n                if (!isString(strategy.path)) {\n                    errors.push({\n                        path: `${path}.path`,\n                        message: 'Expected path string'\n                    });\n                }\n                validateStringArray(strategy.allowed_values, `${path}.allowed_values`, errors);\n                return true;\n            }\n        case 'type_check':\n            {\n                const strategy = value;\n                if (!isString(strategy.path)) {\n                    errors.push({\n                        path: `${path}.path`,\n                        message: 'Expected path string'\n                    });\n                }\n                if (!isString(strategy.expected_type)) {\n                    errors.push({\n                        path: `${path}.expected_type`,\n                        message: 'Expected expected_type string'\n                    });\n                }\n                return true;\n            }\n        case 'date_order':\n            {\n                const strategy = value;\n                if (!isString(strategy.earlier_path)) {\n                    errors.push({\n                        path: `${path}.earlier_path`,\n                        message: 'Expected earlier_path string'\n                    });\n                }\n                if (!isString(strategy.later_path)) {\n                    errors.push({\n                        path: `${path}.later_path`,\n                        message: 'Expected later_path string'\n                    });\n                }\n                if (!isString(strategy.operator)) {\n                    errors.push({\n                        path: `${path}.operator`,\n                        message: 'Expected operator string'\n                    });\n                }\n                return true;\n            }\n        default:\n            return false;\n    }\n}\nfunction validateRuleDefinition(value, path, ruleIds, errors) {\n    if (!isRecord(value)) {\n        errors.push({\n            path,\n            message: 'Expected rule object'\n        });\n        return false;\n    }\n    const allowedKeys = [\n        'rule_id',\n        'name',\n        'description',\n        'severity',\n        'applies_when',\n        'field_paths',\n        'message_template',\n        'evidence_strategy'\n    ];\n    Object.keys(value).forEach((key)=>{\n        if (!allowedKeys.includes(key)) {\n            errors.push({\n                path: `${path}.${key}`,\n                message: 'Unexpected rule key'\n            });\n        }\n    });\n    if (!isString(value.rule_id)) {\n        errors.push({\n            path: `${path}.rule_id`,\n            message: 'Missing rule_id'\n        });\n    } else if (ruleIds.has(value.rule_id)) {\n        errors.push({\n            path: `${path}.rule_id`,\n            message: `Duplicate rule_id: ${value.rule_id}`\n        });\n    } else {\n        ruleIds.add(value.rule_id);\n    }\n    if (!isString(value.name)) {\n        errors.push({\n            path: `${path}.name`,\n            message: 'Missing name'\n        });\n    }\n    if (!isString(value.description)) {\n        errors.push({\n            path: `${path}.description`,\n            message: 'Missing description'\n        });\n    }\n    const severity = value.severity;\n    if (!isString(value.severity) || severity !== 'block' && severity !== 'warning') {\n        errors.push({\n            path: `${path}.severity`,\n            message: 'Invalid severity'\n        });\n    }\n    if (!isRecord(value.applies_when)) {\n        errors.push({\n            path: `${path}.applies_when`,\n            message: 'Missing applies_when'\n        });\n    } else {\n        const allowedAppliesKeys = [\n            'all'\n        ];\n        Object.keys(value.applies_when).forEach((key)=>{\n            if (!allowedAppliesKeys.includes(key)) {\n                errors.push({\n                    path: `${path}.applies_when.${key}`,\n                    message: 'Unexpected applies_when key'\n                });\n            }\n        });\n        const conditions = value.applies_when.all;\n        if (!Array.isArray(conditions)) {\n            errors.push({\n                path: `${path}.applies_when.all`,\n                message: 'Expected applies_when.all array'\n            });\n        } else {\n            conditions.forEach((condition, index)=>{\n                const conditionPath = `${path}.applies_when.all[${index}]`;\n                if (!isRecord(condition)) {\n                    errors.push({\n                        path: conditionPath,\n                        message: 'Expected condition object'\n                    });\n                    return;\n                }\n                if (!isString(condition.path)) {\n                    errors.push({\n                        path: `${conditionPath}.path`,\n                        message: 'Missing condition path'\n                    });\n                }\n                if (condition.exists !== undefined && !isBoolean(condition.exists)) {\n                    errors.push({\n                        path: `${conditionPath}.exists`,\n                        message: 'Expected exists boolean'\n                    });\n                }\n                const numericKeys = [\n                    'gt',\n                    'gte',\n                    'lt',\n                    'lte'\n                ];\n                const hasNumeric = numericKeys.some((key)=>condition[key] !== undefined);\n                if (condition.exists === undefined && condition.equals === undefined && !hasNumeric) {\n                    errors.push({\n                        path: conditionPath,\n                        message: 'Condition must include exists, equals, or numeric comparator'\n                    });\n                }\n                numericKeys.forEach((key)=>{\n                    if (condition[key] !== undefined && typeof condition[key] !== 'number') {\n                        errors.push({\n                            path: `${conditionPath}.${key}`,\n                            message: 'Expected number'\n                        });\n                    }\n                });\n                const allowedConditionKeys = [\n                    'path',\n                    'exists',\n                    'equals',\n                    'gt',\n                    'gte',\n                    'lt',\n                    'lte'\n                ];\n                Object.keys(condition).forEach((key)=>{\n                    if (!allowedConditionKeys.includes(key)) {\n                        errors.push({\n                            path: `${conditionPath}.${key}`,\n                            message: 'Unexpected condition key'\n                        });\n                    }\n                });\n            });\n        }\n    }\n    validateStringArray(value.field_paths, `${path}.field_paths`, errors);\n    if (!isString(value.message_template)) {\n        errors.push({\n            path: `${path}.message_template`,\n            message: 'Missing message_template'\n        });\n    }\n    validateEvidenceStrategy(value.evidence_strategy, `${path}.evidence_strategy`, errors);\n    return true;\n}\nfunction validateRuleCatalog(raw) {\n    const errors = [];\n    if (!isRecord(raw)) {\n        throw new Error('Invalid rule catalog: expected object root');\n    }\n    const allowedRootKeys = [\n        'ruleset_version',\n        'rules'\n    ];\n    Object.keys(raw).forEach((key)=>{\n        if (!allowedRootKeys.includes(key)) {\n            errors.push({\n                path: `root.${key}`,\n                message: 'Unexpected root key'\n            });\n        }\n    });\n    if (!isString(raw.ruleset_version)) {\n        errors.push({\n            path: 'root.ruleset_version',\n            message: 'Missing ruleset_version'\n        });\n    }\n    if (!Array.isArray(raw.rules)) {\n        errors.push({\n            path: 'root.rules',\n            message: 'Missing rules array'\n        });\n    } else {\n        const ruleIds = new Set();\n        raw.rules.forEach((rule, index)=>{\n            validateRuleDefinition(rule, `root.rules[${index}]`, ruleIds, errors);\n        });\n    }\n    if (errors.length > 0) {\n        const message = errors.map((error)=>`- ${error.path}: ${error.message}`).join('\\n');\n        throw new Error(`Invalid rule catalog:\\n${message}`);\n    }\n    return raw;\n}\nfunction getRulesetVersion(raw) {\n    const catalog = validateRuleCatalog(raw);\n    return catalog.ruleset_version;\n}\nfunction assertValidCatalog(raw) {\n    const catalog = validateRuleCatalog(raw);\n    return {\n        catalog,\n        ruleset_version: catalog.ruleset_version\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2NhdGFsb2cvdmFsaWRhdGVSdWxlQ2F0YWxvZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFrQkEsU0FBU0EsU0FBU0MsS0FBYztJQUM5QixPQUFPLE9BQU9BLFVBQVUsWUFBWUEsVUFBVSxRQUFRLENBQUNDLE1BQU1DLE9BQU8sQ0FBQ0Y7QUFDdkU7QUFFQSxTQUFTRyxTQUFTSCxLQUFjO0lBQzlCLE9BQU8sT0FBT0EsVUFBVTtBQUMxQjtBQUVBLFNBQVNJLFVBQVVKLEtBQWM7SUFDL0IsT0FBTyxPQUFPQSxVQUFVO0FBQzFCO0FBRUEsU0FBU0ssb0JBQW9CTCxLQUFjLEVBQUVNLElBQVksRUFBRUMsTUFBeUI7SUFDbEYsSUFBSSxDQUFDTixNQUFNQyxPQUFPLENBQUNGLFFBQVE7UUFDekJPLE9BQU9DLElBQUksQ0FBQztZQUFFRjtZQUFNRyxTQUFTO1FBQTRCO1FBQ3pEO0lBQ0Y7SUFDQVQsTUFBTVUsT0FBTyxDQUFDLENBQUNDLE1BQU1DO1FBQ25CLElBQUksQ0FBQ1QsU0FBU1EsT0FBTztZQUNuQkosT0FBT0MsSUFBSSxDQUFDO2dCQUFFRixNQUFNLEdBQUdBLEtBQUssQ0FBQyxFQUFFTSxNQUFNLENBQUMsQ0FBQztnQkFBRUgsU0FBUztZQUFrQjtRQUN0RTtJQUNGO0FBQ0Y7QUFFQSxTQUFTSSx5QkFDUGIsS0FBYyxFQUNkTSxJQUFZLEVBQ1pDLE1BQXlCO0lBRXpCLElBQUksQ0FBQ1IsU0FBU0MsUUFBUTtRQUNwQk8sT0FBT0MsSUFBSSxDQUFDO1lBQUVGO1lBQU1HLFNBQVM7UUFBb0M7UUFDakUsT0FBTztJQUNUO0lBRUEsSUFBSSxDQUFDTixTQUFTSCxNQUFNYyxJQUFJLEdBQUc7UUFDekJQLE9BQU9DLElBQUksQ0FBQztZQUFFRixNQUFNLEdBQUdBLEtBQUssS0FBSyxDQUFDO1lBQUVHLFNBQVM7UUFBaUM7UUFDOUUsT0FBTztJQUNUO0lBRUEsTUFBTU0sb0JBQThDO1FBQ2xEQyxpQkFBaUI7WUFB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QW9CQztJQUNwQyxPQUFPO1FBQUVZO1FBQVNULGlCQUFpQlMsUUFBUVQsZUFBZTtJQUFDO0FBQzdEIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL3NyYy93b3JrZmxvdzMvY2F0YWxvZy92YWxpZGF0ZVJ1bGVDYXRhbG9nLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtcbiAgRXZpZGVuY2VDc3ZMb29rdXAsXG4gIEV2aWRlbmNlRGF0ZU9yZGVyLFxuICBFdmlkZW5jZUVudW1NZW1iZXJzaGlwLFxuICBFdmlkZW5jZU1pc3NpbmdPck51bGwsXG4gIEV2aWRlbmNlU3RyYXRlZ3ksXG4gIEV2aWRlbmNlVHlwZUNoZWNrLFxuICBMb2FkZWRSdWxlQ2F0YWxvZyxcbiAgUnVsZUNhdGFsb2csXG4gIFJ1bGVEZWZpbml0aW9uLFxuICBSdWxlU2V2ZXJpdHksXG59IGZyb20gJy4vdHlwZXMnO1xuXG50eXBlIFZhbGlkYXRpb25FcnJvciA9IHtcbiAgcGF0aDogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG59O1xuXG5mdW5jdGlvbiBpc1JlY29yZCh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuXG5mdW5jdGlvbiBpc1N0cmluZyh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO1xufVxuXG5mdW5jdGlvbiBpc0Jvb2xlYW4odmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBib29sZWFuIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZVN0cmluZ0FycmF5KHZhbHVlOiB1bmtub3duLCBwYXRoOiBzdHJpbmcsIGVycm9yczogVmFsaWRhdGlvbkVycm9yW10pIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIGVycm9ycy5wdXNoKHsgcGF0aCwgbWVzc2FnZTogJ0V4cGVjdGVkIGFycmF5IG9mIHN0cmluZ3MnIH0pO1xuICAgIHJldHVybjtcbiAgfVxuICB2YWx1ZS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgIGlmICghaXNTdHJpbmcoaXRlbSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7cGF0aH1bJHtpbmRleH1dYCwgbWVzc2FnZTogJ0V4cGVjdGVkIHN0cmluZycgfSk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVFdmlkZW5jZVN0cmF0ZWd5KFxuICB2YWx1ZTogdW5rbm93bixcbiAgcGF0aDogc3RyaW5nLFxuICBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdLFxuKTogdmFsdWUgaXMgRXZpZGVuY2VTdHJhdGVneSB7XG4gIGlmICghaXNSZWNvcmQodmFsdWUpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoLCBtZXNzYWdlOiAnRXhwZWN0ZWQgZXZpZGVuY2Vfc3RyYXRlZ3kgb2JqZWN0JyB9KTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoIWlzU3RyaW5nKHZhbHVlLnR5cGUpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS50eXBlYCwgbWVzc2FnZTogJ01pc3NpbmcgZXZpZGVuY2Vfc3RyYXRlZ3kudHlwZScgfSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgYWxsb3dlZEtleXNCeVR5cGU6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHtcbiAgICBtaXNzaW5nX29yX251bGw6IFsndHlwZScsICdwYXRocyddLFxuICAgIGNzdl9sb29rdXA6IFsndHlwZScsICdjc3YnLCAnaW5wdXRfcGF0aCcsICdtYXRjaF9vbicsICdvdXRwdXQnXSxcbiAgICBlbnVtX21lbWJlcnNoaXA6IFsndHlwZScsICdwYXRoJywgJ2FsbG93ZWRfdmFsdWVzJ10sXG4gICAgdHlwZV9jaGVjazogWyd0eXBlJywgJ3BhdGgnLCAnZXhwZWN0ZWRfdHlwZSddLFxuICAgIGRhdGVfb3JkZXI6IFsndHlwZScsICdlYXJsaWVyX3BhdGgnLCAnbGF0ZXJfcGF0aCcsICdvcGVyYXRvciddLFxuICB9O1xuXG4gIGNvbnN0IGFsbG93ZWRLZXlzID0gYWxsb3dlZEtleXNCeVR5cGVbdmFsdWUudHlwZV07XG4gIGlmICghYWxsb3dlZEtleXMpIHtcbiAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9LnR5cGVgLCBtZXNzYWdlOiBgVW5zdXBwb3J0ZWQgZXZpZGVuY2Vfc3RyYXRlZ3kgdHlwZTogJHt2YWx1ZS50eXBlfWAgfSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgT2JqZWN0LmtleXModmFsdWUpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGlmICghYWxsb3dlZEtleXMuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS4ke2tleX1gLCBtZXNzYWdlOiAnVW5leHBlY3RlZCBldmlkZW5jZV9zdHJhdGVneSBrZXknIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgc3dpdGNoICh2YWx1ZS50eXBlKSB7XG4gICAgY2FzZSAnbWlzc2luZ19vcl9udWxsJzoge1xuICAgICAgY29uc3Qgc3RyYXRlZ3kgPSB2YWx1ZSBhcyBFdmlkZW5jZU1pc3NpbmdPck51bGw7XG4gICAgICB2YWxpZGF0ZVN0cmluZ0FycmF5KHN0cmF0ZWd5LnBhdGhzLCBgJHtwYXRofS5wYXRoc2AsIGVycm9ycyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY2FzZSAnY3N2X2xvb2t1cCc6IHtcbiAgICAgIGNvbnN0IHN0cmF0ZWd5ID0gdmFsdWUgYXMgRXZpZGVuY2VDc3ZMb29rdXA7XG4gICAgICBpZiAoIWlzU3RyaW5nKHN0cmF0ZWd5LmNzdikpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5jc3ZgLCBtZXNzYWdlOiAnRXhwZWN0ZWQgY3N2IHN0cmluZycgfSk7XG4gICAgICB9XG4gICAgICBpZiAoIWlzU3RyaW5nKHN0cmF0ZWd5LmlucHV0X3BhdGgpKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7cGF0aH0uaW5wdXRfcGF0aGAsIG1lc3NhZ2U6ICdFeHBlY3RlZCBpbnB1dF9wYXRoIHN0cmluZycgfSk7XG4gICAgICB9XG4gICAgICB2YWxpZGF0ZVN0cmluZ0FycmF5KHN0cmF0ZWd5Lm1hdGNoX29uLCBgJHtwYXRofS5tYXRjaF9vbmAsIGVycm9ycyk7XG4gICAgICBpZiAoIWlzU3RyaW5nKHN0cmF0ZWd5Lm91dHB1dCkpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5vdXRwdXRgLCBtZXNzYWdlOiAnRXhwZWN0ZWQgb3V0cHV0IHN0cmluZycgfSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgY2FzZSAnZW51bV9tZW1iZXJzaGlwJzoge1xuICAgICAgY29uc3Qgc3RyYXRlZ3kgPSB2YWx1ZSBhcyBFdmlkZW5jZUVudW1NZW1iZXJzaGlwO1xuICAgICAgaWYgKCFpc1N0cmluZyhzdHJhdGVneS5wYXRoKSkge1xuICAgICAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9LnBhdGhgLCBtZXNzYWdlOiAnRXhwZWN0ZWQgcGF0aCBzdHJpbmcnIH0pO1xuICAgICAgfVxuICAgICAgdmFsaWRhdGVTdHJpbmdBcnJheShzdHJhdGVneS5hbGxvd2VkX3ZhbHVlcywgYCR7cGF0aH0uYWxsb3dlZF92YWx1ZXNgLCBlcnJvcnMpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNhc2UgJ3R5cGVfY2hlY2snOiB7XG4gICAgICBjb25zdCBzdHJhdGVneSA9IHZhbHVlIGFzIEV2aWRlbmNlVHlwZUNoZWNrO1xuICAgICAgaWYgKCFpc1N0cmluZyhzdHJhdGVneS5wYXRoKSkge1xuICAgICAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9LnBhdGhgLCBtZXNzYWdlOiAnRXhwZWN0ZWQgcGF0aCBzdHJpbmcnIH0pO1xuICAgICAgfVxuICAgICAgaWYgKCFpc1N0cmluZyhzdHJhdGVneS5leHBlY3RlZF90eXBlKSkge1xuICAgICAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9LmV4cGVjdGVkX3R5cGVgLCBtZXNzYWdlOiAnRXhwZWN0ZWQgZXhwZWN0ZWRfdHlwZSBzdHJpbmcnIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGNhc2UgJ2RhdGVfb3JkZXInOiB7XG4gICAgICBjb25zdCBzdHJhdGVneSA9IHZhbHVlIGFzIEV2aWRlbmNlRGF0ZU9yZGVyO1xuICAgICAgaWYgKCFpc1N0cmluZyhzdHJhdGVneS5lYXJsaWVyX3BhdGgpKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7cGF0aH0uZWFybGllcl9wYXRoYCwgbWVzc2FnZTogJ0V4cGVjdGVkIGVhcmxpZXJfcGF0aCBzdHJpbmcnIH0pO1xuICAgICAgfVxuICAgICAgaWYgKCFpc1N0cmluZyhzdHJhdGVneS5sYXRlcl9wYXRoKSkge1xuICAgICAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9LmxhdGVyX3BhdGhgLCBtZXNzYWdlOiAnRXhwZWN0ZWQgbGF0ZXJfcGF0aCBzdHJpbmcnIH0pO1xuICAgICAgfVxuICAgICAgaWYgKCFpc1N0cmluZyhzdHJhdGVneS5vcGVyYXRvcikpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5vcGVyYXRvcmAsIG1lc3NhZ2U6ICdFeHBlY3RlZCBvcGVyYXRvciBzdHJpbmcnIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVSdWxlRGVmaW5pdGlvbihcbiAgdmFsdWU6IHVua25vd24sXG4gIHBhdGg6IHN0cmluZyxcbiAgcnVsZUlkczogU2V0PHN0cmluZz4sXG4gIGVycm9yczogVmFsaWRhdGlvbkVycm9yW10sXG4pOiB2YWx1ZSBpcyBSdWxlRGVmaW5pdGlvbiB7XG4gIGlmICghaXNSZWNvcmQodmFsdWUpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoLCBtZXNzYWdlOiAnRXhwZWN0ZWQgcnVsZSBvYmplY3QnIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IGFsbG93ZWRLZXlzID0gW1xuICAgICdydWxlX2lkJyxcbiAgICAnbmFtZScsXG4gICAgJ2Rlc2NyaXB0aW9uJyxcbiAgICAnc2V2ZXJpdHknLFxuICAgICdhcHBsaWVzX3doZW4nLFxuICAgICdmaWVsZF9wYXRocycsXG4gICAgJ21lc3NhZ2VfdGVtcGxhdGUnLFxuICAgICdldmlkZW5jZV9zdHJhdGVneScsXG4gIF07XG4gIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBpZiAoIWFsbG93ZWRLZXlzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7cGF0aH0uJHtrZXl9YCwgbWVzc2FnZTogJ1VuZXhwZWN0ZWQgcnVsZSBrZXknIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgaWYgKCFpc1N0cmluZyh2YWx1ZS5ydWxlX2lkKSkge1xuICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7cGF0aH0ucnVsZV9pZGAsIG1lc3NhZ2U6ICdNaXNzaW5nIHJ1bGVfaWQnIH0pO1xuICB9IGVsc2UgaWYgKHJ1bGVJZHMuaGFzKHZhbHVlLnJ1bGVfaWQpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5ydWxlX2lkYCwgbWVzc2FnZTogYER1cGxpY2F0ZSBydWxlX2lkOiAke3ZhbHVlLnJ1bGVfaWR9YCB9KTtcbiAgfSBlbHNlIHtcbiAgICBydWxlSWRzLmFkZCh2YWx1ZS5ydWxlX2lkKTtcbiAgfVxuXG4gIGlmICghaXNTdHJpbmcodmFsdWUubmFtZSkpIHtcbiAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9Lm5hbWVgLCBtZXNzYWdlOiAnTWlzc2luZyBuYW1lJyB9KTtcbiAgfVxuXG4gIGlmICghaXNTdHJpbmcodmFsdWUuZGVzY3JpcHRpb24pKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5kZXNjcmlwdGlvbmAsIG1lc3NhZ2U6ICdNaXNzaW5nIGRlc2NyaXB0aW9uJyB9KTtcbiAgfVxuXG4gIGNvbnN0IHNldmVyaXR5ID0gdmFsdWUuc2V2ZXJpdHkgYXMgUnVsZVNldmVyaXR5O1xuICBpZiAoIWlzU3RyaW5nKHZhbHVlLnNldmVyaXR5KSB8fCAoc2V2ZXJpdHkgIT09ICdibG9jaycgJiYgc2V2ZXJpdHkgIT09ICd3YXJuaW5nJykpIHtcbiAgICBlcnJvcnMucHVzaCh7IHBhdGg6IGAke3BhdGh9LnNldmVyaXR5YCwgbWVzc2FnZTogJ0ludmFsaWQgc2V2ZXJpdHknIH0pO1xuICB9XG5cbiAgaWYgKCFpc1JlY29yZCh2YWx1ZS5hcHBsaWVzX3doZW4pKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5hcHBsaWVzX3doZW5gLCBtZXNzYWdlOiAnTWlzc2luZyBhcHBsaWVzX3doZW4nIH0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGFsbG93ZWRBcHBsaWVzS2V5cyA9IFsnYWxsJ107XG4gICAgT2JqZWN0LmtleXModmFsdWUuYXBwbGllc193aGVuKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgIGlmICghYWxsb3dlZEFwcGxpZXNLZXlzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5hcHBsaWVzX3doZW4uJHtrZXl9YCwgbWVzc2FnZTogJ1VuZXhwZWN0ZWQgYXBwbGllc193aGVuIGtleScgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBjb25kaXRpb25zID0gKHZhbHVlLmFwcGxpZXNfd2hlbiBhcyB7IGFsbD86IHVua25vd24gfSkuYWxsO1xuICAgIGlmICghQXJyYXkuaXNBcnJheShjb25kaXRpb25zKSkge1xuICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5hcHBsaWVzX3doZW4uYWxsYCwgbWVzc2FnZTogJ0V4cGVjdGVkIGFwcGxpZXNfd2hlbi5hbGwgYXJyYXknIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25kaXRpb25zLmZvckVhY2goKGNvbmRpdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgY29uZGl0aW9uUGF0aCA9IGAke3BhdGh9LmFwcGxpZXNfd2hlbi5hbGxbJHtpbmRleH1dYDtcbiAgICAgICAgaWYgKCFpc1JlY29yZChjb25kaXRpb24pKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBjb25kaXRpb25QYXRoLCBtZXNzYWdlOiAnRXhwZWN0ZWQgY29uZGl0aW9uIG9iamVjdCcgfSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNTdHJpbmcoY29uZGl0aW9uLnBhdGgpKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtjb25kaXRpb25QYXRofS5wYXRoYCwgbWVzc2FnZTogJ01pc3NpbmcgY29uZGl0aW9uIHBhdGgnIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb25kaXRpb24uZXhpc3RzICE9PSB1bmRlZmluZWQgJiYgIWlzQm9vbGVhbihjb25kaXRpb24uZXhpc3RzKSkge1xuICAgICAgICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7Y29uZGl0aW9uUGF0aH0uZXhpc3RzYCwgbWVzc2FnZTogJ0V4cGVjdGVkIGV4aXN0cyBib29sZWFuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBudW1lcmljS2V5cyA9IFsnZ3QnLCAnZ3RlJywgJ2x0JywgJ2x0ZSddIGFzIGNvbnN0O1xuICAgICAgICBjb25zdCBoYXNOdW1lcmljID0gbnVtZXJpY0tleXMuc29tZSgoa2V5KSA9PiBjb25kaXRpb25ba2V5XSAhPT0gdW5kZWZpbmVkKTtcbiAgICAgICAgaWYgKGNvbmRpdGlvbi5leGlzdHMgPT09IHVuZGVmaW5lZCAmJiBjb25kaXRpb24uZXF1YWxzID09PSB1bmRlZmluZWQgJiYgIWhhc051bWVyaWMpIHtcbiAgICAgICAgICBlcnJvcnMucHVzaCh7XG4gICAgICAgICAgICBwYXRoOiBjb25kaXRpb25QYXRoLFxuICAgICAgICAgICAgbWVzc2FnZTogJ0NvbmRpdGlvbiBtdXN0IGluY2x1ZGUgZXhpc3RzLCBlcXVhbHMsIG9yIG51bWVyaWMgY29tcGFyYXRvcicsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbnVtZXJpY0tleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgaWYgKGNvbmRpdGlvbltrZXldICE9PSB1bmRlZmluZWQgJiYgdHlwZW9mIGNvbmRpdGlvbltrZXldICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtjb25kaXRpb25QYXRofS4ke2tleX1gLCBtZXNzYWdlOiAnRXhwZWN0ZWQgbnVtYmVyJyB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBhbGxvd2VkQ29uZGl0aW9uS2V5cyA9IFsncGF0aCcsICdleGlzdHMnLCAnZXF1YWxzJywgJ2d0JywgJ2d0ZScsICdsdCcsICdsdGUnXTtcbiAgICAgICAgT2JqZWN0LmtleXMoY29uZGl0aW9uKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICBpZiAoIWFsbG93ZWRDb25kaXRpb25LZXlzLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgICAgICAgIGVycm9ycy5wdXNoKHsgcGF0aDogYCR7Y29uZGl0aW9uUGF0aH0uJHtrZXl9YCwgbWVzc2FnZTogJ1VuZXhwZWN0ZWQgY29uZGl0aW9uIGtleScgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHZhbGlkYXRlU3RyaW5nQXJyYXkodmFsdWUuZmllbGRfcGF0aHMsIGAke3BhdGh9LmZpZWxkX3BhdGhzYCwgZXJyb3JzKTtcblxuICBpZiAoIWlzU3RyaW5nKHZhbHVlLm1lc3NhZ2VfdGVtcGxhdGUpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgJHtwYXRofS5tZXNzYWdlX3RlbXBsYXRlYCwgbWVzc2FnZTogJ01pc3NpbmcgbWVzc2FnZV90ZW1wbGF0ZScgfSk7XG4gIH1cblxuICB2YWxpZGF0ZUV2aWRlbmNlU3RyYXRlZ3kodmFsdWUuZXZpZGVuY2Vfc3RyYXRlZ3ksIGAke3BhdGh9LmV2aWRlbmNlX3N0cmF0ZWd5YCwgZXJyb3JzKTtcblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUnVsZUNhdGFsb2cocmF3OiB1bmtub3duKTogUnVsZUNhdGFsb2cge1xuICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW107XG5cbiAgaWYgKCFpc1JlY29yZChyYXcpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJ1bGUgY2F0YWxvZzogZXhwZWN0ZWQgb2JqZWN0IHJvb3QnKTtcbiAgfVxuXG4gIGNvbnN0IGFsbG93ZWRSb290S2V5cyA9IFsncnVsZXNldF92ZXJzaW9uJywgJ3J1bGVzJ107XG4gIE9iamVjdC5rZXlzKHJhdykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgaWYgKCFhbGxvd2VkUm9vdEtleXMuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgZXJyb3JzLnB1c2goeyBwYXRoOiBgcm9vdC4ke2tleX1gLCBtZXNzYWdlOiAnVW5leHBlY3RlZCByb290IGtleScgfSk7XG4gICAgfVxuICB9KTtcblxuICBpZiAoIWlzU3RyaW5nKHJhdy5ydWxlc2V0X3ZlcnNpb24pKSB7XG4gICAgZXJyb3JzLnB1c2goeyBwYXRoOiAncm9vdC5ydWxlc2V0X3ZlcnNpb24nLCBtZXNzYWdlOiAnTWlzc2luZyBydWxlc2V0X3ZlcnNpb24nIH0pO1xuICB9XG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KHJhdy5ydWxlcykpIHtcbiAgICBlcnJvcnMucHVzaCh7IHBhdGg6ICdyb290LnJ1bGVzJywgbWVzc2FnZTogJ01pc3NpbmcgcnVsZXMgYXJyYXknIH0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHJ1bGVJZHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICByYXcucnVsZXMuZm9yRWFjaCgocnVsZSwgaW5kZXgpID0+IHtcbiAgICAgIHZhbGlkYXRlUnVsZURlZmluaXRpb24ocnVsZSwgYHJvb3QucnVsZXNbJHtpbmRleH1dYCwgcnVsZUlkcywgZXJyb3JzKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnJvcnMubWFwKChlcnJvcikgPT4gYC0gJHtlcnJvci5wYXRofTogJHtlcnJvci5tZXNzYWdlfWApLmpvaW4oJ1xcbicpO1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBydWxlIGNhdGFsb2c6XFxuJHttZXNzYWdlfWApO1xuICB9XG5cbiAgcmV0dXJuIHJhdyBhcyBSdWxlQ2F0YWxvZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJ1bGVzZXRWZXJzaW9uKHJhdzogdW5rbm93bik6IHN0cmluZyB7XG4gIGNvbnN0IGNhdGFsb2cgPSB2YWxpZGF0ZVJ1bGVDYXRhbG9nKHJhdyk7XG4gIHJldHVybiBjYXRhbG9nLnJ1bGVzZXRfdmVyc2lvbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydFZhbGlkQ2F0YWxvZyhyYXc6IHVua25vd24pOiBMb2FkZWRSdWxlQ2F0YWxvZyB7XG4gIGNvbnN0IGNhdGFsb2cgPSB2YWxpZGF0ZVJ1bGVDYXRhbG9nKHJhdyk7XG4gIHJldHVybiB7IGNhdGFsb2csIHJ1bGVzZXRfdmVyc2lvbjogY2F0YWxvZy5ydWxlc2V0X3ZlcnNpb24gfTtcbn1cbiJdLCJuYW1lcyI6WyJpc1JlY29yZCIsInZhbHVlIiwiQXJyYXkiLCJpc0FycmF5IiwiaXNTdHJpbmciLCJpc0Jvb2xlYW4iLCJ2YWxpZGF0ZVN0cmluZ0FycmF5IiwicGF0aCIsImVycm9ycyIsInB1c2giLCJtZXNzYWdlIiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsInZhbGlkYXRlRXZpZGVuY2VTdHJhdGVneSIsInR5cGUiLCJhbGxvd2VkS2V5c0J5VHlwZSIsIm1pc3Npbmdfb3JfbnVsbCIsImNzdl9sb29rdXAiLCJlbnVtX21lbWJlcnNoaXAiLCJ0eXBlX2NoZWNrIiwiZGF0ZV9vcmRlciIsImFsbG93ZWRLZXlzIiwiT2JqZWN0Iiwia2V5cyIsImtleSIsImluY2x1ZGVzIiwic3RyYXRlZ3kiLCJwYXRocyIsImNzdiIsImlucHV0X3BhdGgiLCJtYXRjaF9vbiIsIm91dHB1dCIsImFsbG93ZWRfdmFsdWVzIiwiZXhwZWN0ZWRfdHlwZSIsImVhcmxpZXJfcGF0aCIsImxhdGVyX3BhdGgiLCJvcGVyYXRvciIsInZhbGlkYXRlUnVsZURlZmluaXRpb24iLCJydWxlSWRzIiwicnVsZV9pZCIsImhhcyIsImFkZCIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInNldmVyaXR5IiwiYXBwbGllc193aGVuIiwiYWxsb3dlZEFwcGxpZXNLZXlzIiwiY29uZGl0aW9ucyIsImFsbCIsImNvbmRpdGlvbiIsImNvbmRpdGlvblBhdGgiLCJleGlzdHMiLCJ1bmRlZmluZWQiLCJudW1lcmljS2V5cyIsImhhc051bWVyaWMiLCJzb21lIiwiZXF1YWxzIiwiYWxsb3dlZENvbmRpdGlvbktleXMiLCJmaWVsZF9wYXRocyIsIm1lc3NhZ2VfdGVtcGxhdGUiLCJldmlkZW5jZV9zdHJhdGVneSIsInZhbGlkYXRlUnVsZUNhdGFsb2ciLCJyYXciLCJFcnJvciIsImFsbG93ZWRSb290S2V5cyIsInJ1bGVzZXRfdmVyc2lvbiIsInJ1bGVzIiwiU2V0IiwicnVsZSIsImxlbmd0aCIsIm1hcCIsImVycm9yIiwiam9pbiIsImdldFJ1bGVzZXRWZXJzaW9uIiwiY2F0YWxvZyIsImFzc2VydFZhbGlkQ2F0YWxvZyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/catalog/validateRuleCatalog.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/counties/gaCountiesLoader.ts":
/*!********************************************************!*\
  !*** ../../src/workflow3/counties/gaCountiesLoader.ts ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadGaCounties: () => (/* binding */ loadGaCounties),\n/* harmony export */   parseGaCountiesCsv: () => (/* binding */ parseGaCountiesCsv)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction resolveRepoRoot() {\n    const cwd = process.cwd();\n    if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(cwd, 'docs'))) {\n        return cwd;\n    }\n    const candidate = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(cwd, '..', '..');\n    if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(candidate, 'docs'))) {\n        return candidate;\n    }\n    return cwd;\n}\nconst DEFAULT_GA_COUNTIES_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(resolveRepoRoot(), 'docs', 'ga_counties.csv');\nlet cachedLookup = null;\nlet cachedPath = null;\nfunction parseCsvLine(line) {\n    const result = [];\n    let current = '';\n    let inQuotes = false;\n    for(let i = 0; i < line.length; i += 1){\n        const char = line[i];\n        if (inQuotes) {\n            if (char === '\"') {\n                const next = line[i + 1];\n                if (next === '\"') {\n                    current += '\"';\n                    i += 1;\n                } else {\n                    inQuotes = false;\n                }\n            } else {\n                current += char;\n            }\n        } else if (char === '\"') {\n            inQuotes = true;\n        } else if (char === ',') {\n            result.push(current);\n            current = '';\n        } else {\n            current += char;\n        }\n    }\n    result.push(current);\n    return result;\n}\nfunction normalizeHeader(value) {\n    return value.trim().toLowerCase();\n}\nfunction normalizeWhitespace(value) {\n    return value.replace(/\\s+/g, ' ').trim();\n}\nfunction buildLookup(rows) {\n    const bySlug = new Map();\n    const byNameExact = new Map();\n    const byNameNormalized = new Map();\n    rows.forEach((row)=>{\n        if (row.slug) {\n            bySlug.set(row.slug.toLowerCase(), row);\n        }\n        if (row.name) {\n            byNameExact.set(row.name.toLowerCase(), row);\n            byNameNormalized.set(normalizeWhitespace(row.name).toLowerCase(), row);\n        }\n    });\n    return {\n        rows,\n        bySlug,\n        byNameExact,\n        byNameNormalized\n    };\n}\nfunction parseGaCountiesCsv(csvText) {\n    const lines = csvText.split(/\\r?\\n/).filter((line)=>line.trim().length > 0);\n    if (lines.length === 0) {\n        return buildLookup([]);\n    }\n    const headerCells = parseCsvLine(lines[0] ?? '');\n    const headers = headerCells.map((header)=>header.trim());\n    const headerIndex = new Map();\n    headers.forEach((header, idx)=>{\n        headerIndex.set(normalizeHeader(header), idx);\n    });\n    const getIndex = (options)=>{\n        for (const option of options){\n            const idx = headerIndex.get(option);\n            if (typeof idx === 'number') return idx;\n        }\n        return null;\n    };\n    const stateIdx = getIndex([\n        'state',\n        'state_code',\n        'state_abbrev'\n    ]);\n    const nameIdx = getIndex([\n        'county_name',\n        'name'\n    ]);\n    const displayIdx = getIndex([\n        'county_display',\n        'display',\n        'county_display_name'\n    ]);\n    const slugIdx = getIndex([\n        'county_slug',\n        'slug'\n    ]);\n    const fipsIdx = getIndex([\n        'county_fips',\n        'fips',\n        'county_fips_code'\n    ]);\n    const rows = [];\n    for(let i = 1; i < lines.length; i += 1){\n        const cells = parseCsvLine(lines[i] ?? '');\n        if (cells.length === 0) continue;\n        const stateValue = stateIdx !== null && cells[stateIdx] ? normalizeWhitespace(cells[stateIdx]) : null;\n        if (stateValue && stateValue.toUpperCase() !== 'GA') {\n            continue;\n        }\n        const name = nameIdx !== null ? normalizeWhitespace(cells[nameIdx] ?? '') : '';\n        if (!name) continue;\n        const displayName = displayIdx !== null ? normalizeWhitespace(cells[displayIdx] ?? '') : '';\n        const slug = slugIdx !== null ? normalizeWhitespace(cells[slugIdx] ?? '') : '';\n        const fips = fipsIdx !== null ? normalizeWhitespace(cells[fipsIdx] ?? '') : '';\n        const raw = {};\n        headers.forEach((header, idx)=>{\n            raw[header] = cells[idx] ?? '';\n        });\n        rows.push({\n            name,\n            displayName: displayName || undefined,\n            slug: slug || undefined,\n            fips: fips || undefined,\n            raw\n        });\n    }\n    return buildLookup(rows);\n}\nfunction loadGaCounties(csvPath = DEFAULT_GA_COUNTIES_PATH) {\n    const resolvedPath = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(csvPath);\n    if (cachedLookup && cachedPath === resolvedPath) return cachedLookup;\n    const csvText = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(resolvedPath, 'utf8');\n    cachedLookup = parseGaCountiesCsv(csvText);\n    cachedPath = resolvedPath;\n    return cachedLookup;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2NvdW50aWVzL2dhQ291bnRpZXNMb2FkZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQW9CO0FBQ0k7QUFHeEIsU0FBU0U7SUFDUCxNQUFNQyxNQUFNQyxRQUFRRCxHQUFHO0lBQ3ZCLElBQUlILG9EQUFhLENBQUNDLGdEQUFTLENBQUNFLEtBQUssVUFBVTtRQUN6QyxPQUFPQTtJQUNUO0lBQ0EsTUFBTUksWUFBWU4sbURBQVksQ0FBQ0UsS0FBSyxNQUFNO0lBQzFDLElBQUlILG9EQUFhLENBQUNDLGdEQUFTLENBQUNNLFdBQVcsVUFBVTtRQUMvQyxPQUFPQTtJQUNUO0lBQ0EsT0FBT0o7QUFDVDtBQUVBLE1BQU1NLDJCQUEyQlIsZ0RBQVMsQ0FBQ0MsbUJBQW1CLFFBQVE7QUFFdEUsSUFBSVEsZUFBc0M7QUFDMUMsSUFBSUMsYUFBNEI7QUFFaEMsU0FBU0MsYUFBYUMsSUFBWTtJQUNoQyxNQUFNQyxTQUFtQixFQUFFO0lBQzNCLElBQUlDLFVBQVU7SUFDZCxJQUFJQyxXQUFXO0lBRWYsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlKLEtBQUtLLE1BQU0sRUFBRUQsS0FBSyxFQUFHO1FBQ3ZDLE1BQU1FLE9BQU9OLElBQUksQ0FBQ0ksRUFBRTtRQUNwQixJQUFJRCxVQUFVO1lBQ1osSUFBSUcsU0FBUyxLQUFLO2dCQUNoQixNQUFNQyxPQUFPUCxJQUFJLENBQUNJLElBQUksRUFBRTtnQkFDeEIsSUFBSUcsU0FBUyxLQUFLO29CQUNoQkwsV0FBVztvQkFDWEUsS0FBSztnQkFDUCxPQUFPO29CQUNMRCxXQUFXO2dCQUNiO1lBQ0YsT0FBTztnQkFDTEQsV0FBV0k7WUFDYjtRQUNGLE9BQU8sSUFBSUEsU0FBUyxLQUFLO1lBQ3ZCSCxXQUFXO1FBQ2IsT0FBTyxJQUFJRyxTQUFTLEtBQUs7WUFDdkJMLE9BQU9PLElBQUksQ0FBQ047WUFDWkEsVUFBVTtRQUNaLE9BQU87WUFDTEEsV0FBV0k7UUFDYjtJQUNG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Ty9CLG9CQUFvQmlDLEtBQUssQ0FBQ0YsUUFBUSxJQUFJLE1BQU07UUFDNUUsTUFBTU0sT0FBT0wsWUFBWSxPQUFPaEMsb0JBQW9CaUMsS0FBSyxDQUFDRCxRQUFRLElBQUksTUFBTTtRQUU1RSxNQUFNTSxNQUE4QixDQUFDO1FBQ3JDbkIsUUFBUVgsT0FBTyxDQUFDLENBQUNhLFFBQVFFO1lBQ3ZCZSxHQUFHLENBQUNqQixPQUFPLEdBQUdZLEtBQUssQ0FBQ1YsSUFBSSxJQUFJO1FBQzlCO1FBRUFwQixLQUFLUixJQUFJLENBQUM7WUFDUmlCO1lBQ0F3QixhQUFhQSxlQUFlRztZQUM1QjdCLE1BQU1BLFFBQVE2QjtZQUNkRixNQUFNQSxRQUFRRTtZQUNkRDtRQUNGO0lBQ0Y7SUFFQSxPQUFPcEMsWUFBWUM7QUFDckI7QUFFTyxTQUFTcUMsZUFBZUMsVUFBVTFELHdCQUF3QjtJQUMvRCxNQUFNMkQsZUFBZW5FLG1EQUFZLENBQUNrRTtJQUNsQyxJQUFJekQsZ0JBQWdCQyxlQUFleUQsY0FBYyxPQUFPMUQ7SUFDeEQsTUFBTThCLFVBQVV4QyxzREFBZSxDQUFDb0UsY0FBYztJQUM5QzFELGVBQWU2QixtQkFBbUJDO0lBQ2xDN0IsYUFBYXlEO0lBQ2IsT0FBTzFEO0FBQ1QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9kb21pbmljcmFuZ2hpYXNjaS92ZXJpbGV4LWxhbmRpbmcvc3JjL3dvcmtmbG93My9jb3VudGllcy9nYUNvdW50aWVzTG9hZGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB0eXBlIHsgR2FDb3VudHlMb29rdXAsIEdhQ291bnR5Um93IH0gZnJvbSAnLi90eXBlcyc7XG5cbmZ1bmN0aW9uIHJlc29sdmVSZXBvUm9vdCgpOiBzdHJpbmcge1xuICBjb25zdCBjd2QgPSBwcm9jZXNzLmN3ZCgpO1xuICBpZiAoZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oY3dkLCAnZG9jcycpKSkge1xuICAgIHJldHVybiBjd2Q7XG4gIH1cbiAgY29uc3QgY2FuZGlkYXRlID0gcGF0aC5yZXNvbHZlKGN3ZCwgJy4uJywgJy4uJyk7XG4gIGlmIChmcy5leGlzdHNTeW5jKHBhdGguam9pbihjYW5kaWRhdGUsICdkb2NzJykpKSB7XG4gICAgcmV0dXJuIGNhbmRpZGF0ZTtcbiAgfVxuICByZXR1cm4gY3dkO1xufVxuXG5jb25zdCBERUZBVUxUX0dBX0NPVU5USUVTX1BBVEggPSBwYXRoLmpvaW4ocmVzb2x2ZVJlcG9Sb290KCksICdkb2NzJywgJ2dhX2NvdW50aWVzLmNzdicpO1xuXG5sZXQgY2FjaGVkTG9va3VwOiBHYUNvdW50eUxvb2t1cCB8IG51bGwgPSBudWxsO1xubGV0IGNhY2hlZFBhdGg6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG5mdW5jdGlvbiBwYXJzZUNzdkxpbmUobGluZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG4gIGxldCBjdXJyZW50ID0gJyc7XG4gIGxldCBpblF1b3RlcyA9IGZhbHNlO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZS5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGNvbnN0IGNoYXIgPSBsaW5lW2ldO1xuICAgIGlmIChpblF1b3Rlcykge1xuICAgICAgaWYgKGNoYXIgPT09ICdcIicpIHtcbiAgICAgICAgY29uc3QgbmV4dCA9IGxpbmVbaSArIDFdO1xuICAgICAgICBpZiAobmV4dCA9PT0gJ1wiJykge1xuICAgICAgICAgIGN1cnJlbnQgKz0gJ1wiJztcbiAgICAgICAgICBpICs9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaW5RdW90ZXMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudCArPSBjaGFyO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJ1wiJykge1xuICAgICAgaW5RdW90ZXMgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gJywnKSB7XG4gICAgICByZXN1bHQucHVzaChjdXJyZW50KTtcbiAgICAgIGN1cnJlbnQgPSAnJztcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudCArPSBjaGFyO1xuICAgIH1cbiAgfVxuXG4gIHJlc3VsdC5wdXNoKGN1cnJlbnQpO1xuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVIZWFkZXIodmFsdWU6IHN0cmluZykge1xuICByZXR1cm4gdmFsdWUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVdoaXRlc3BhY2UodmFsdWU6IHN0cmluZykge1xuICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKTtcbn1cblxuZnVuY3Rpb24gYnVpbGRMb29rdXAocm93czogR2FDb3VudHlSb3dbXSk6IEdhQ291bnR5TG9va3VwIHtcbiAgY29uc3QgYnlTbHVnID0gbmV3IE1hcDxzdHJpbmcsIEdhQ291bnR5Um93PigpO1xuICBjb25zdCBieU5hbWVFeGFjdCA9IG5ldyBNYXA8c3RyaW5nLCBHYUNvdW50eVJvdz4oKTtcbiAgY29uc3QgYnlOYW1lTm9ybWFsaXplZCA9IG5ldyBNYXA8c3RyaW5nLCBHYUNvdW50eVJvdz4oKTtcblxuICByb3dzLmZvckVhY2goKHJvdykgPT4ge1xuICAgIGlmIChyb3cuc2x1Zykge1xuICAgICAgYnlTbHVnLnNldChyb3cuc2x1Zy50b0xvd2VyQ2FzZSgpLCByb3cpO1xuICAgIH1cbiAgICBpZiAocm93Lm5hbWUpIHtcbiAgICAgIGJ5TmFtZUV4YWN0LnNldChyb3cubmFtZS50b0xvd2VyQ2FzZSgpLCByb3cpO1xuICAgICAgYnlOYW1lTm9ybWFsaXplZC5zZXQobm9ybWFsaXplV2hpdGVzcGFjZShyb3cubmFtZSkudG9Mb3dlckNhc2UoKSwgcm93KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7IHJvd3MsIGJ5U2x1ZywgYnlOYW1lRXhhY3QsIGJ5TmFtZU5vcm1hbGl6ZWQgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlR2FDb3VudGllc0Nzdihjc3ZUZXh0OiBzdHJpbmcpOiBHYUNvdW50eUxvb2t1cCB7XG4gIGNvbnN0IGxpbmVzID0gY3N2VGV4dC5zcGxpdCgvXFxyP1xcbi8pLmZpbHRlcigobGluZSkgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7XG4gIGlmIChsaW5lcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gYnVpbGRMb29rdXAoW10pO1xuICB9XG5cbiAgY29uc3QgaGVhZGVyQ2VsbHMgPSBwYXJzZUNzdkxpbmUobGluZXNbMF0gPz8gJycpO1xuICBjb25zdCBoZWFkZXJzID0gaGVhZGVyQ2VsbHMubWFwKChoZWFkZXIpID0+IGhlYWRlci50cmltKCkpO1xuICBjb25zdCBoZWFkZXJJbmRleCA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XG4gIGhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpZHgpID0+IHtcbiAgICBoZWFkZXJJbmRleC5zZXQobm9ybWFsaXplSGVhZGVyKGhlYWRlciksIGlkeCk7XG4gIH0pO1xuXG4gIGNvbnN0IGdldEluZGV4ID0gKG9wdGlvbnM6IHN0cmluZ1tdKSA9PiB7XG4gICAgZm9yIChjb25zdCBvcHRpb24gb2Ygb3B0aW9ucykge1xuICAgICAgY29uc3QgaWR4ID0gaGVhZGVySW5kZXguZ2V0KG9wdGlvbik7XG4gICAgICBpZiAodHlwZW9mIGlkeCA9PT0gJ251bWJlcicpIHJldHVybiBpZHg7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIGNvbnN0IHN0YXRlSWR4ID0gZ2V0SW5kZXgoWydzdGF0ZScsICdzdGF0ZV9jb2RlJywgJ3N0YXRlX2FiYnJldiddKTtcbiAgY29uc3QgbmFtZUlkeCA9IGdldEluZGV4KFsnY291bnR5X25hbWUnLCAnbmFtZSddKTtcbiAgY29uc3QgZGlzcGxheUlkeCA9IGdldEluZGV4KFsnY291bnR5X2Rpc3BsYXknLCAnZGlzcGxheScsICdjb3VudHlfZGlzcGxheV9uYW1lJ10pO1xuICBjb25zdCBzbHVnSWR4ID0gZ2V0SW5kZXgoWydjb3VudHlfc2x1ZycsICdzbHVnJ10pO1xuICBjb25zdCBmaXBzSWR4ID0gZ2V0SW5kZXgoWydjb3VudHlfZmlwcycsICdmaXBzJywgJ2NvdW50eV9maXBzX2NvZGUnXSk7XG5cbiAgY29uc3Qgcm93czogR2FDb3VudHlSb3dbXSA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBjb25zdCBjZWxscyA9IHBhcnNlQ3N2TGluZShsaW5lc1tpXSA/PyAnJyk7XG4gICAgaWYgKGNlbGxzLmxlbmd0aCA9PT0gMCkgY29udGludWU7XG5cbiAgICBjb25zdCBzdGF0ZVZhbHVlID1cbiAgICAgIHN0YXRlSWR4ICE9PSBudWxsICYmIGNlbGxzW3N0YXRlSWR4XSA/IG5vcm1hbGl6ZVdoaXRlc3BhY2UoY2VsbHNbc3RhdGVJZHhdKSA6IG51bGw7XG4gICAgaWYgKHN0YXRlVmFsdWUgJiYgc3RhdGVWYWx1ZS50b1VwcGVyQ2FzZSgpICE9PSAnR0EnKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCBuYW1lID0gbmFtZUlkeCAhPT0gbnVsbCA/IG5vcm1hbGl6ZVdoaXRlc3BhY2UoY2VsbHNbbmFtZUlkeF0gPz8gJycpIDogJyc7XG4gICAgaWYgKCFuYW1lKSBjb250aW51ZTtcblxuICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gZGlzcGxheUlkeCAhPT0gbnVsbCA/IG5vcm1hbGl6ZVdoaXRlc3BhY2UoY2VsbHNbZGlzcGxheUlkeF0gPz8gJycpIDogJyc7XG4gICAgY29uc3Qgc2x1ZyA9IHNsdWdJZHggIT09IG51bGwgPyBub3JtYWxpemVXaGl0ZXNwYWNlKGNlbGxzW3NsdWdJZHhdID8/ICcnKSA6ICcnO1xuICAgIGNvbnN0IGZpcHMgPSBmaXBzSWR4ICE9PSBudWxsID8gbm9ybWFsaXplV2hpdGVzcGFjZShjZWxsc1tmaXBzSWR4XSA/PyAnJykgOiAnJztcblxuICAgIGNvbnN0IHJhdzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgIGhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpZHgpID0+IHtcbiAgICAgIHJhd1toZWFkZXJdID0gY2VsbHNbaWR4XSA/PyAnJztcbiAgICB9KTtcblxuICAgIHJvd3MucHVzaCh7XG4gICAgICBuYW1lLFxuICAgICAgZGlzcGxheU5hbWU6IGRpc3BsYXlOYW1lIHx8IHVuZGVmaW5lZCxcbiAgICAgIHNsdWc6IHNsdWcgfHwgdW5kZWZpbmVkLFxuICAgICAgZmlwczogZmlwcyB8fCB1bmRlZmluZWQsXG4gICAgICByYXcsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gYnVpbGRMb29rdXAocm93cyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkR2FDb3VudGllcyhjc3ZQYXRoID0gREVGQVVMVF9HQV9DT1VOVElFU19QQVRIKTogR2FDb3VudHlMb29rdXAge1xuICBjb25zdCByZXNvbHZlZFBhdGggPSBwYXRoLnJlc29sdmUoY3N2UGF0aCk7XG4gIGlmIChjYWNoZWRMb29rdXAgJiYgY2FjaGVkUGF0aCA9PT0gcmVzb2x2ZWRQYXRoKSByZXR1cm4gY2FjaGVkTG9va3VwO1xuICBjb25zdCBjc3ZUZXh0ID0gZnMucmVhZEZpbGVTeW5jKHJlc29sdmVkUGF0aCwgJ3V0ZjgnKTtcbiAgY2FjaGVkTG9va3VwID0gcGFyc2VHYUNvdW50aWVzQ3N2KGNzdlRleHQpO1xuICBjYWNoZWRQYXRoID0gcmVzb2x2ZWRQYXRoO1xuICByZXR1cm4gY2FjaGVkTG9va3VwO1xufVxuIl0sIm5hbWVzIjpbImZzIiwicGF0aCIsInJlc29sdmVSZXBvUm9vdCIsImN3ZCIsInByb2Nlc3MiLCJleGlzdHNTeW5jIiwiam9pbiIsImNhbmRpZGF0ZSIsInJlc29sdmUiLCJERUZBVUxUX0dBX0NPVU5USUVTX1BBVEgiLCJjYWNoZWRMb29rdXAiLCJjYWNoZWRQYXRoIiwicGFyc2VDc3ZMaW5lIiwibGluZSIsInJlc3VsdCIsImN1cnJlbnQiLCJpblF1b3RlcyIsImkiLCJsZW5ndGgiLCJjaGFyIiwibmV4dCIsInB1c2giLCJub3JtYWxpemVIZWFkZXIiLCJ2YWx1ZSIsInRyaW0iLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVdoaXRlc3BhY2UiLCJyZXBsYWNlIiwiYnVpbGRMb29rdXAiLCJyb3dzIiwiYnlTbHVnIiwiTWFwIiwiYnlOYW1lRXhhY3QiLCJieU5hbWVOb3JtYWxpemVkIiwiZm9yRWFjaCIsInJvdyIsInNsdWciLCJzZXQiLCJuYW1lIiwicGFyc2VHYUNvdW50aWVzQ3N2IiwiY3N2VGV4dCIsImxpbmVzIiwic3BsaXQiLCJmaWx0ZXIiLCJoZWFkZXJDZWxscyIsImhlYWRlcnMiLCJtYXAiLCJoZWFkZXIiLCJoZWFkZXJJbmRleCIsImlkeCIsImdldEluZGV4Iiwib3B0aW9ucyIsIm9wdGlvbiIsImdldCIsInN0YXRlSWR4IiwibmFtZUlkeCIsImRpc3BsYXlJZHgiLCJzbHVnSWR4IiwiZmlwc0lkeCIsImNlbGxzIiwic3RhdGVWYWx1ZSIsInRvVXBwZXJDYXNlIiwiZGlzcGxheU5hbWUiLCJmaXBzIiwicmF3IiwidW5kZWZpbmVkIiwibG9hZEdhQ291bnRpZXMiLCJjc3ZQYXRoIiwicmVzb2x2ZWRQYXRoIiwicmVhZEZpbGVTeW5jIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/counties/gaCountiesLoader.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/counties/gaCountyNormalize.ts":
/*!*********************************************************!*\
  !*** ../../src/workflow3/counties/gaCountyNormalize.ts ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   normalizeCounty: () => (/* binding */ normalizeCounty)\n/* harmony export */ });\nfunction normalizeWhitespace(value) {\n    return value.replace(/\\s+/g, ' ').trim();\n}\nfunction normalizeInput(value) {\n    return normalizeWhitespace(value).toLowerCase();\n}\nfunction getCanonicalValue(row) {\n    if (row.slug && row.slug.trim().length > 0) {\n        return row.slug;\n    }\n    return row.name;\n}\nfunction normalizeCounty(rawValue, lookup) {\n    if (!rawValue || typeof rawValue !== 'string') {\n        return {\n            ok: false,\n            error: 'Missing county value'\n        };\n    }\n    const trimmed = rawValue.trim();\n    if (!trimmed) {\n        return {\n            ok: false,\n            error: 'Missing county value'\n        };\n    }\n    const slugKey = trimmed.toLowerCase();\n    const slugMatch = lookup.bySlug.get(slugKey);\n    if (slugMatch) {\n        return {\n            ok: true,\n            normalized_value: getCanonicalValue(slugMatch),\n            match_strategy: 'slug_exact',\n            canonical_row: slugMatch\n        };\n    }\n    const nameExactKey = trimmed.toLowerCase();\n    const nameExactMatch = lookup.byNameExact.get(nameExactKey);\n    if (nameExactMatch) {\n        return {\n            ok: true,\n            normalized_value: getCanonicalValue(nameExactMatch),\n            match_strategy: 'name_exact',\n            canonical_row: nameExactMatch\n        };\n    }\n    const normalizedKey = normalizeInput(rawValue);\n    const trimmedMatch = lookup.byNameNormalized.get(normalizedKey);\n    if (trimmedMatch) {\n        return {\n            ok: true,\n            normalized_value: getCanonicalValue(trimmedMatch),\n            match_strategy: 'name_trimmed',\n            canonical_row: trimmedMatch\n        };\n    }\n    return {\n        ok: false,\n        error: 'Unknown county'\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2NvdW50aWVzL2dhQ291bnR5Tm9ybWFsaXplLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFFQSxTQUFTQSxvQkFBb0JDLEtBQWE7SUFDeEMsT0FBT0EsTUFBTUMsT0FBTyxDQUFDLFFBQVEsS0FBS0MsSUFBSTtBQUN4QztBQUVBLFNBQVNDLGVBQWVILEtBQWE7SUFDbkMsT0FBT0Qsb0JBQW9CQyxPQUFPSSxXQUFXO0FBQy9DO0FBRUEsU0FBU0Msa0JBQWtCQyxHQUFvQztJQUM3RCxJQUFJQSxJQUFJQyxJQUFJLElBQUlELElBQUlDLElBQUksQ0FBQ0wsSUFBSSxHQUFHTSxNQUFNLEdBQUcsR0FBRztRQUMxQyxPQUFPRixJQUFJQyxJQUFJO0lBQ2pCO0lBQ0EsT0FBT0QsSUFBSUcsSUFBSTtBQUNqQjtBQUVPLFNBQVNDLGdCQUNkQyxRQUFtQyxFQUNuQ0MsTUFBc0I7SUFFdEIsSUFBSSxDQUFDRCxZQUFZLE9BQU9BLGFBQWEsVUFBVTtRQUM3QyxPQUFPO1lBQUVFLElBQUk7WUFBT0MsT0FBTztRQUF1QjtJQUNwRDtJQUVBLE1BQU1DLFVBQVVKLFNBQVNULElBQUk7SUFDN0IsSUFBSSxDQUFDYSxTQUFTO1FBQ1osT0FBTztZQUFFRixJQUFJO1lBQU9DLE9BQU87UUFBdUI7SUFDcEQ7SUFFQSxNQUFNRSxVQUFVRCxRQUFRWCxXQUFXO0lBRW5DLE1BQU1hLFlBQVlMLE9BQU9NLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDSDtJQUNwQyxJQUFJQyxXQUFXO1FBQ2IsT0FBTztZQUNMSixJQUFJO1lBQ0pPLGtCQUFrQmYsa0JBQWtCWTtZQUNwQ0ksZ0JBQWdCO1lBQ2hCQyxlQUFlTDtRQUNqQjtJQUNGO0lBRUEsTUFBTU0sZUFBZVIsUUFBUVgsV0FBVztJQUN4QyxNQUFNb0IsaUJBQWlCWixPQUFPYSxXQUFXLENBQUNOLEdBQUcsQ0FBQ0k7SUFDOUMsSUFBSUMsZ0JBQWdCO1FBQ2xCLE9BQU87WUFDTFgsSUFBSTtZQUNKTyxrQkFBa0JmLGtCQUFrQm1CO1lBQ3BDSCxnQkFBZ0I7WUFDaEJDLGVBQWVFO1FBQ2pCO0lBQ0Y7SUFFQSxNQUFNRSxnQkFBZ0J2QixlQUFlUTtJQUNyQyxNQUFNZ0IsZUFBZWYsT0FBT2dCLGdCQUFnQixDQUFDVCxHQUFHLENBQUNPO0lBQ2pELElBQUlDLGNBQWM7UUFDaEIsT0FBTztZQUNMZCxJQUFJO1lBQ0pPLGtCQUFrQmYsa0JBQWtCc0I7WUFDcENOLGdCQUFnQjtZQUNoQkMsZUFBZUs7UUFDakI7SUFDRjtJQUVBLE9BQU87UUFBRWQsSUFBSTtRQUFPQyxPQUFPO0lBQWlCO0FBQzlDIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL3NyYy93b3JrZmxvdzMvY291bnRpZXMvZ2FDb3VudHlOb3JtYWxpemUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDb3VudHlOb3JtYWxpemVSZXN1bHQsIEdhQ291bnR5TG9va3VwIH0gZnJvbSAnLi90eXBlcyc7XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVdoaXRlc3BhY2UodmFsdWU6IHN0cmluZykge1xuICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKTtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplSW5wdXQodmFsdWU6IHN0cmluZykge1xuICByZXR1cm4gbm9ybWFsaXplV2hpdGVzcGFjZSh2YWx1ZSkudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gZ2V0Q2Fub25pY2FsVmFsdWUocm93OiB7IHNsdWc/OiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9KSB7XG4gIGlmIChyb3cuc2x1ZyAmJiByb3cuc2x1Zy50cmltKCkubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiByb3cuc2x1ZztcbiAgfVxuICByZXR1cm4gcm93Lm5hbWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVDb3VudHkoXG4gIHJhd1ZhbHVlOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkLFxuICBsb29rdXA6IEdhQ291bnR5TG9va3VwLFxuKTogQ291bnR5Tm9ybWFsaXplUmVzdWx0IHtcbiAgaWYgKCFyYXdWYWx1ZSB8fCB0eXBlb2YgcmF3VmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ01pc3NpbmcgY291bnR5IHZhbHVlJyB9O1xuICB9XG5cbiAgY29uc3QgdHJpbW1lZCA9IHJhd1ZhbHVlLnRyaW0oKTtcbiAgaWYgKCF0cmltbWVkKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ01pc3NpbmcgY291bnR5IHZhbHVlJyB9O1xuICB9XG5cbiAgY29uc3Qgc2x1Z0tleSA9IHRyaW1tZWQudG9Mb3dlckNhc2UoKTtcblxuICBjb25zdCBzbHVnTWF0Y2ggPSBsb29rdXAuYnlTbHVnLmdldChzbHVnS2V5KTtcbiAgaWYgKHNsdWdNYXRjaCkge1xuICAgIHJldHVybiB7XG4gICAgICBvazogdHJ1ZSxcbiAgICAgIG5vcm1hbGl6ZWRfdmFsdWU6IGdldENhbm9uaWNhbFZhbHVlKHNsdWdNYXRjaCksXG4gICAgICBtYXRjaF9zdHJhdGVneTogJ3NsdWdfZXhhY3QnLFxuICAgICAgY2Fub25pY2FsX3Jvdzogc2x1Z01hdGNoLFxuICAgIH07XG4gIH1cblxuICBjb25zdCBuYW1lRXhhY3RLZXkgPSB0cmltbWVkLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IG5hbWVFeGFjdE1hdGNoID0gbG9va3VwLmJ5TmFtZUV4YWN0LmdldChuYW1lRXhhY3RLZXkpO1xuICBpZiAobmFtZUV4YWN0TWF0Y2gpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb2s6IHRydWUsXG4gICAgICBub3JtYWxpemVkX3ZhbHVlOiBnZXRDYW5vbmljYWxWYWx1ZShuYW1lRXhhY3RNYXRjaCksXG4gICAgICBtYXRjaF9zdHJhdGVneTogJ25hbWVfZXhhY3QnLFxuICAgICAgY2Fub25pY2FsX3JvdzogbmFtZUV4YWN0TWF0Y2gsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IG5vcm1hbGl6ZWRLZXkgPSBub3JtYWxpemVJbnB1dChyYXdWYWx1ZSk7XG4gIGNvbnN0IHRyaW1tZWRNYXRjaCA9IGxvb2t1cC5ieU5hbWVOb3JtYWxpemVkLmdldChub3JtYWxpemVkS2V5KTtcbiAgaWYgKHRyaW1tZWRNYXRjaCkge1xuICAgIHJldHVybiB7XG4gICAgICBvazogdHJ1ZSxcbiAgICAgIG5vcm1hbGl6ZWRfdmFsdWU6IGdldENhbm9uaWNhbFZhbHVlKHRyaW1tZWRNYXRjaCksXG4gICAgICBtYXRjaF9zdHJhdGVneTogJ25hbWVfdHJpbW1lZCcsXG4gICAgICBjYW5vbmljYWxfcm93OiB0cmltbWVkTWF0Y2gsXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdVbmtub3duIGNvdW50eScgfTtcbn1cbiJdLCJuYW1lcyI6WyJub3JtYWxpemVXaGl0ZXNwYWNlIiwidmFsdWUiLCJyZXBsYWNlIiwidHJpbSIsIm5vcm1hbGl6ZUlucHV0IiwidG9Mb3dlckNhc2UiLCJnZXRDYW5vbmljYWxWYWx1ZSIsInJvdyIsInNsdWciLCJsZW5ndGgiLCJuYW1lIiwibm9ybWFsaXplQ291bnR5IiwicmF3VmFsdWUiLCJsb29rdXAiLCJvayIsImVycm9yIiwidHJpbW1lZCIsInNsdWdLZXkiLCJzbHVnTWF0Y2giLCJieVNsdWciLCJnZXQiLCJub3JtYWxpemVkX3ZhbHVlIiwibWF0Y2hfc3RyYXRlZ3kiLCJjYW5vbmljYWxfcm93IiwibmFtZUV4YWN0S2V5IiwibmFtZUV4YWN0TWF0Y2giLCJieU5hbWVFeGFjdCIsIm5vcm1hbGl6ZWRLZXkiLCJ0cmltbWVkTWF0Y2giLCJieU5hbWVOb3JtYWxpemVkIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/counties/gaCountyNormalize.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/evaluator/applyWhen.ts":
/*!**************************************************!*\
  !*** ../../src/workflow3/evaluator/applyWhen.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appliesWhen: () => (/* binding */ appliesWhen)\n/* harmony export */ });\n/* harmony import */ var _getField__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getField */ \"(api-node)/../../src/workflow3/evaluator/getField.ts\");\n/* harmony import */ var _requirements__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./requirements */ \"(api-node)/../../src/workflow3/evaluator/requirements.ts\");\n\n\nfunction compareNumeric(value, operator, expected) {\n    if (typeof value !== 'number' || Number.isNaN(value)) return false;\n    switch(operator){\n        case 'gt':\n            return value > expected;\n        case 'gte':\n            return value >= expected;\n        case 'lt':\n            return value < expected;\n        case 'lte':\n            return value <= expected;\n        default:\n            return false;\n    }\n}\nfunction appliesWhen(payload, applies) {\n    if (!applies || !Array.isArray(applies.all)) return true;\n    return applies.all.every((condition)=>{\n        const value = (0,_getField__WEBPACK_IMPORTED_MODULE_0__.getField)(payload, condition.path);\n        if (typeof condition.exists === 'boolean') {\n            const exists = !(0,_requirements__WEBPACK_IMPORTED_MODULE_1__.isMissingValue)(value);\n            if (exists !== condition.exists) return false;\n        }\n        if (condition.equals !== undefined) {\n            if (value !== condition.equals) return false;\n        }\n        if (condition.gt !== undefined && !compareNumeric(value, 'gt', condition.gt)) return false;\n        if (condition.gte !== undefined && !compareNumeric(value, 'gte', condition.gte)) return false;\n        if (condition.lt !== undefined && !compareNumeric(value, 'lt', condition.lt)) return false;\n        if (condition.lte !== undefined && !compareNumeric(value, 'lte', condition.lte)) return false;\n        return true;\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2V2YWx1YXRvci9hcHBseVdoZW4udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ3NDO0FBQ1U7QUFJaEQsU0FBU0UsZUFBZUMsS0FBYyxFQUFFQyxRQUF5QixFQUFFQyxRQUFnQjtJQUNqRixJQUFJLE9BQU9GLFVBQVUsWUFBWUcsT0FBT0MsS0FBSyxDQUFDSixRQUFRLE9BQU87SUFDN0QsT0FBUUM7UUFDTixLQUFLO1lBQ0gsT0FBT0QsUUFBUUU7UUFDakIsS0FBSztZQUNILE9BQU9GLFNBQVNFO1FBQ2xCLEtBQUs7WUFDSCxPQUFPRixRQUFRRTtRQUNqQixLQUFLO1lBQ0gsT0FBT0YsU0FBU0U7UUFDbEI7WUFDRSxPQUFPO0lBQ1g7QUFDRjtBQUVPLFNBQVNHLFlBQVlDLE9BQWdCLEVBQUVDLE9BQW9DO0lBQ2hGLElBQUksQ0FBQ0EsV0FBVyxDQUFDQyxNQUFNQyxPQUFPLENBQUNGLFFBQVFHLEdBQUcsR0FBRyxPQUFPO0lBRXBELE9BQU9ILFFBQVFHLEdBQUcsQ0FBQ0MsS0FBSyxDQUFDLENBQUNDO1FBQ3hCLE1BQU1aLFFBQVFILG1EQUFRQSxDQUFDUyxTQUFTTSxVQUFVQyxJQUFJO1FBRTlDLElBQUksT0FBT0QsVUFBVUUsTUFBTSxLQUFLLFdBQVc7WUFDekMsTUFBTUEsU0FBUyxDQUFDaEIsNkRBQWNBLENBQUNFO1lBQy9CLElBQUljLFdBQVdGLFVBQVVFLE1BQU0sRUFBRSxPQUFPO1FBQzFDO1FBRUEsSUFBSUYsVUFBVUcsTUFBTSxLQUFLQyxXQUFXO1lBQ2xDLElBQUloQixVQUFVWSxVQUFVRyxNQUFNLEVBQUUsT0FBTztRQUN6QztRQUVBLElBQUlILFVBQVVLLEVBQUUsS0FBS0QsYUFBYSxDQUFDakIsZUFBZUMsT0FBTyxNQUFNWSxVQUFVSyxFQUFFLEdBQUcsT0FBTztRQUNyRixJQUFJTCxVQUFVTSxHQUFHLEtBQUtGLGFBQWEsQ0FBQ2pCLGVBQWVDLE9BQU8sT0FBT1ksVUFBVU0sR0FBRyxHQUFHLE9BQU87UUFDeEYsSUFBSU4sVUFBVU8sRUFBRSxLQUFLSCxhQUFhLENBQUNqQixlQUFlQyxPQUFPLE1BQU1ZLFVBQVVPLEVBQUUsR0FBRyxPQUFPO1FBQ3JGLElBQUlQLFVBQVVRLEdBQUcsS0FBS0osYUFBYSxDQUFDakIsZUFBZUMsT0FBTyxPQUFPWSxVQUFVUSxHQUFHLEdBQUcsT0FBTztRQUV4RixPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9zcmMvd29ya2Zsb3czL2V2YWx1YXRvci9hcHBseVdoZW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBSdWxlQXBwbGllc1doZW4gfSBmcm9tICcuLi9jYXRhbG9nL3R5cGVzJztcbmltcG9ydCB7IGdldEZpZWxkIH0gZnJvbSAnLi9nZXRGaWVsZCc7XG5pbXBvcnQgeyBpc01pc3NpbmdWYWx1ZSB9IGZyb20gJy4vcmVxdWlyZW1lbnRzJztcblxudHlwZSBOdW1lcmljT3BlcmF0b3IgPSAnZ3QnIHwgJ2d0ZScgfCAnbHQnIHwgJ2x0ZSc7XG5cbmZ1bmN0aW9uIGNvbXBhcmVOdW1lcmljKHZhbHVlOiB1bmtub3duLCBvcGVyYXRvcjogTnVtZXJpY09wZXJhdG9yLCBleHBlY3RlZDogbnVtYmVyKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09ICdudW1iZXInIHx8IE51bWJlci5pc05hTih2YWx1ZSkpIHJldHVybiBmYWxzZTtcbiAgc3dpdGNoIChvcGVyYXRvcikge1xuICAgIGNhc2UgJ2d0JzpcbiAgICAgIHJldHVybiB2YWx1ZSA+IGV4cGVjdGVkO1xuICAgIGNhc2UgJ2d0ZSc6XG4gICAgICByZXR1cm4gdmFsdWUgPj0gZXhwZWN0ZWQ7XG4gICAgY2FzZSAnbHQnOlxuICAgICAgcmV0dXJuIHZhbHVlIDwgZXhwZWN0ZWQ7XG4gICAgY2FzZSAnbHRlJzpcbiAgICAgIHJldHVybiB2YWx1ZSA8PSBleHBlY3RlZDtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBsaWVzV2hlbihwYXlsb2FkOiB1bmtub3duLCBhcHBsaWVzOiBSdWxlQXBwbGllc1doZW4gfCB1bmRlZmluZWQpOiBib29sZWFuIHtcbiAgaWYgKCFhcHBsaWVzIHx8ICFBcnJheS5pc0FycmF5KGFwcGxpZXMuYWxsKSkgcmV0dXJuIHRydWU7XG5cbiAgcmV0dXJuIGFwcGxpZXMuYWxsLmV2ZXJ5KChjb25kaXRpb24pID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9IGdldEZpZWxkKHBheWxvYWQsIGNvbmRpdGlvbi5wYXRoKTtcblxuICAgIGlmICh0eXBlb2YgY29uZGl0aW9uLmV4aXN0cyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICBjb25zdCBleGlzdHMgPSAhaXNNaXNzaW5nVmFsdWUodmFsdWUpO1xuICAgICAgaWYgKGV4aXN0cyAhPT0gY29uZGl0aW9uLmV4aXN0cykgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChjb25kaXRpb24uZXF1YWxzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICh2YWx1ZSAhPT0gY29uZGl0aW9uLmVxdWFscykgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChjb25kaXRpb24uZ3QgIT09IHVuZGVmaW5lZCAmJiAhY29tcGFyZU51bWVyaWModmFsdWUsICdndCcsIGNvbmRpdGlvbi5ndCkpIHJldHVybiBmYWxzZTtcbiAgICBpZiAoY29uZGl0aW9uLmd0ZSAhPT0gdW5kZWZpbmVkICYmICFjb21wYXJlTnVtZXJpYyh2YWx1ZSwgJ2d0ZScsIGNvbmRpdGlvbi5ndGUpKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGNvbmRpdGlvbi5sdCAhPT0gdW5kZWZpbmVkICYmICFjb21wYXJlTnVtZXJpYyh2YWx1ZSwgJ2x0JywgY29uZGl0aW9uLmx0KSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChjb25kaXRpb24ubHRlICE9PSB1bmRlZmluZWQgJiYgIWNvbXBhcmVOdW1lcmljKHZhbHVlLCAnbHRlJywgY29uZGl0aW9uLmx0ZSkpIHJldHVybiBmYWxzZTtcblxuICAgIHJldHVybiB0cnVlO1xuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJnZXRGaWVsZCIsImlzTWlzc2luZ1ZhbHVlIiwiY29tcGFyZU51bWVyaWMiLCJ2YWx1ZSIsIm9wZXJhdG9yIiwiZXhwZWN0ZWQiLCJOdW1iZXIiLCJpc05hTiIsImFwcGxpZXNXaGVuIiwicGF5bG9hZCIsImFwcGxpZXMiLCJBcnJheSIsImlzQXJyYXkiLCJhbGwiLCJldmVyeSIsImNvbmRpdGlvbiIsInBhdGgiLCJleGlzdHMiLCJlcXVhbHMiLCJ1bmRlZmluZWQiLCJndCIsImd0ZSIsImx0IiwibHRlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/evaluator/applyWhen.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/evaluator/evaluateRules.ts":
/*!******************************************************!*\
  !*** ../../src/workflow3/evaluator/evaluateRules.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   evaluateRules: () => (/* binding */ evaluateRules)\n/* harmony export */ });\n/* harmony import */ var _counties_gaCountyNormalize__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../counties/gaCountyNormalize */ \"(api-node)/../../src/workflow3/counties/gaCountyNormalize.ts\");\n/* harmony import */ var _applyWhen__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./applyWhen */ \"(api-node)/../../src/workflow3/evaluator/applyWhen.ts\");\n/* harmony import */ var _getField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./getField */ \"(api-node)/../../src/workflow3/evaluator/getField.ts\");\n/* harmony import */ var _requirements__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./requirements */ \"(api-node)/../../src/workflow3/evaluator/requirements.ts\");\n\n\n\n\nfunction buildPathsEvidence(payload, paths) {\n    const values = {};\n    paths.forEach((path)=>{\n        const value = (0,_getField__WEBPACK_IMPORTED_MODULE_2__.getField)(payload, path);\n        values[path] = (0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(value) ? null : value;\n    });\n    return {\n        paths: values\n    };\n}\nfunction mapMatchStrategy(strategy) {\n    if (strategy === 'slug_exact') return 'slug';\n    return 'name';\n}\nfunction evaluateMissingOrNull(payload, strategy) {\n    const missingPaths = (0,_requirements__WEBPACK_IMPORTED_MODULE_3__.findMissingPaths)(payload, strategy.paths);\n    const evidence = buildPathsEvidence(payload, strategy.paths);\n    const passed = missingPaths.length === 0;\n    return {\n        passed,\n        evidence,\n        missingPaths\n    };\n}\nfunction evaluateEnumMembership(payload, rule) {\n    const strategy = rule.evidence_strategy;\n    if (strategy.type !== 'enum_membership') {\n        return {\n            passed: true,\n            evidence: {}\n        };\n    }\n    const value = (0,_getField__WEBPACK_IMPORTED_MODULE_2__.getField)(payload, strategy.path);\n    if ((0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(value)) {\n        return {\n            passed: true,\n            evidence: {\n                path: strategy.path,\n                value: null\n            }\n        };\n    }\n    if (typeof value !== 'string') {\n        return {\n            passed: false,\n            evidence: {\n                path: strategy.path,\n                value,\n                allowed_values: strategy.allowed_values\n            }\n        };\n    }\n    const passed = strategy.allowed_values.includes(value);\n    return {\n        passed,\n        evidence: {\n            path: strategy.path,\n            value,\n            allowed_values: strategy.allowed_values\n        }\n    };\n}\nfunction evaluateTypeCheck(payload, rule) {\n    const strategy = rule.evidence_strategy;\n    if (strategy.type !== 'type_check') {\n        return {\n            passed: true,\n            evidence: {}\n        };\n    }\n    const value = (0,_getField__WEBPACK_IMPORTED_MODULE_2__.getField)(payload, strategy.path);\n    if ((0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(value)) {\n        return {\n            passed: true,\n            evidence: {\n                path: strategy.path,\n                value: null\n            }\n        };\n    }\n    let passed = false;\n    if (strategy.expected_type === 'number') {\n        passed = typeof value === 'number' && !Number.isNaN(value);\n    } else if (strategy.expected_type === 'boolean') {\n        passed = typeof value === 'boolean';\n    } else if (strategy.expected_type === 'date') {\n        passed = typeof value === 'string' && !Number.isNaN(Date.parse(value));\n    }\n    return {\n        passed,\n        evidence: {\n            path: strategy.path,\n            value,\n            expected_type: strategy.expected_type\n        }\n    };\n}\nfunction evaluateDateOrder(payload, rule) {\n    const strategy = rule.evidence_strategy;\n    if (strategy.type !== 'date_order') {\n        return {\n            passed: true,\n            evidence: {}\n        };\n    }\n    const earlierValue = (0,_getField__WEBPACK_IMPORTED_MODULE_2__.getField)(payload, strategy.earlier_path);\n    const laterValue = (0,_getField__WEBPACK_IMPORTED_MODULE_2__.getField)(payload, strategy.later_path);\n    if ((0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(earlierValue) || (0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(laterValue)) {\n        return {\n            passed: true,\n            evidence: {\n                earlier_path: strategy.earlier_path,\n                later_path: strategy.later_path,\n                earlier_value: (0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(earlierValue) ? null : earlierValue,\n                later_value: (0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(laterValue) ? null : laterValue,\n                operator: strategy.operator\n            }\n        };\n    }\n    const earlierDate = Date.parse(String(earlierValue));\n    const laterDate = Date.parse(String(laterValue));\n    if (Number.isNaN(earlierDate) || Number.isNaN(laterDate)) {\n        return {\n            passed: true,\n            evidence: {\n                earlier_path: strategy.earlier_path,\n                later_path: strategy.later_path,\n                earlier_value: earlierValue,\n                later_value: laterValue,\n                operator: strategy.operator\n            }\n        };\n    }\n    let passed = true;\n    switch(strategy.operator){\n        case '<=':\n            passed = earlierDate <= laterDate;\n            break;\n        case '<':\n            passed = earlierDate < laterDate;\n            break;\n        case '>=':\n            passed = earlierDate >= laterDate;\n            break;\n        case '>':\n            passed = earlierDate > laterDate;\n            break;\n        default:\n            passed = true;\n    }\n    return {\n        passed,\n        evidence: {\n            earlier_path: strategy.earlier_path,\n            later_path: strategy.later_path,\n            earlier_value: earlierValue,\n            later_value: laterValue,\n            operator: strategy.operator\n        }\n    };\n}\nfunction evaluateCsvLookup(payload, rule, lookup) {\n    const strategy = rule.evidence_strategy;\n    if (strategy.type !== 'csv_lookup') {\n        return {\n            passed: true,\n            evidence: {},\n            normalization: null\n        };\n    }\n    const value = (0,_getField__WEBPACK_IMPORTED_MODULE_2__.getField)(payload, strategy.input_path);\n    if ((0,_requirements__WEBPACK_IMPORTED_MODULE_3__.isMissingValue)(value)) {\n        return {\n            passed: true,\n            evidence: {\n                input_path: strategy.input_path,\n                input_value: null\n            },\n            normalization: null\n        };\n    }\n    const rawValue = String(value);\n    const normalized = (0,_counties_gaCountyNormalize__WEBPACK_IMPORTED_MODULE_0__.normalizeCounty)(rawValue, lookup);\n    if (!normalized.ok) {\n        return {\n            passed: false,\n            evidence: {\n                input_path: strategy.input_path,\n                input_value: rawValue,\n                error: normalized.error,\n                source: strategy.csv\n            },\n            normalization: null\n        };\n    }\n    const normalization = {\n        kind: 'county_normalization',\n        field_path: strategy.input_path,\n        input_value: rawValue,\n        normalized_value: normalized.normalized_value,\n        match_strategy: mapMatchStrategy(normalized.match_strategy),\n        source: strategy.csv\n    };\n    return {\n        passed: true,\n        evidence: {\n            input_path: strategy.input_path,\n            input_value: rawValue,\n            normalized_value: normalized.normalized_value,\n            match_strategy: normalization.match_strategy,\n            source: strategy.csv\n        },\n        normalization\n    };\n}\nfunction evaluateRule(payload, rule, lookup) {\n    if (rule.evidence_strategy.type === 'missing_or_null') {\n        const result = evaluateMissingOrNull(payload, rule.evidence_strategy);\n        return {\n            passed: result.passed,\n            evidence: result.evidence,\n            missingPaths: result.missingPaths,\n            normalization: null\n        };\n    }\n    if (rule.evidence_strategy.type === 'enum_membership') {\n        const result = evaluateEnumMembership(payload, rule);\n        return {\n            passed: result.passed,\n            evidence: result.evidence,\n            missingPaths: [],\n            normalization: null\n        };\n    }\n    if (rule.evidence_strategy.type === 'type_check') {\n        const result = evaluateTypeCheck(payload, rule);\n        return {\n            passed: result.passed,\n            evidence: result.evidence,\n            missingPaths: [],\n            normalization: null\n        };\n    }\n    if (rule.evidence_strategy.type === 'date_order') {\n        const result = evaluateDateOrder(payload, rule);\n        return {\n            passed: result.passed,\n            evidence: result.evidence,\n            missingPaths: [],\n            normalization: null\n        };\n    }\n    if (rule.evidence_strategy.type === 'csv_lookup') {\n        const result = evaluateCsvLookup(payload, rule, lookup);\n        return {\n            passed: result.passed,\n            evidence: result.evidence,\n            missingPaths: [],\n            normalization: result.normalization\n        };\n    }\n    return {\n        passed: true,\n        evidence: {},\n        missingPaths: [],\n        normalization: null\n    };\n}\nfunction evaluateRules(payload, catalog, countyLookup, options = {}) {\n    const evaluatedAt = options.evaluatedAt ?? new Date().toISOString();\n    const rulesetVersion = catalog.ruleset_version;\n    const requiredMissing = new Set();\n    const blocks = [];\n    const warnings = [];\n    const ruleEvaluations = [];\n    const normalizationMap = new Map();\n    catalog.rules.forEach((rule)=>{\n        const applicable = (0,_applyWhen__WEBPACK_IMPORTED_MODULE_1__.appliesWhen)(payload, rule.applies_when);\n        if (!applicable) {\n            ruleEvaluations.push({\n                rule_id: rule.rule_id,\n                severity: rule.severity,\n                passed: true,\n                field_paths: rule.field_paths,\n                evidence: {\n                    skipped: true\n                },\n                message: '',\n                evaluated_at: evaluatedAt,\n                ruleset_version: rulesetVersion\n            });\n            return;\n        }\n        const { passed, evidence, missingPaths, normalization } = evaluateRule(payload, rule, countyLookup);\n        if (missingPaths.length > 0 && rule.evidence_strategy.type === 'missing_or_null' && rule.severity === 'block') {\n            missingPaths.forEach((path)=>requiredMissing.add(path));\n        }\n        if (normalization) {\n            normalizationMap.set(normalization.field_path, normalization);\n        }\n        if (!passed) {\n            const finding = {\n                rule_id: rule.rule_id,\n                severity: rule.severity,\n                message: rule.message_template,\n                field_paths: rule.field_paths,\n                evidence,\n                evaluated_at: evaluatedAt,\n                ruleset_version: rulesetVersion\n            };\n            if (rule.severity === 'block') {\n                blocks.push(finding);\n            } else {\n                warnings.push(finding);\n            }\n        }\n        ruleEvaluations.push({\n            rule_id: rule.rule_id,\n            severity: rule.severity,\n            passed,\n            field_paths: rule.field_paths,\n            evidence,\n            message: passed ? '' : rule.message_template,\n            evaluated_at: evaluatedAt,\n            ruleset_version: rulesetVersion\n        });\n    });\n    return {\n        ruleset_version: rulesetVersion,\n        evaluated_at: evaluatedAt,\n        required_fields_missing: Array.from(requiredMissing),\n        blocks,\n        warnings,\n        normalizations: Array.from(normalizationMap.values()),\n        rule_evaluations: ruleEvaluations\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2V2YWx1YXRvci9ldmFsdWF0ZVJ1bGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBRWdFO0FBQ3RCO0FBQ0o7QUFDNEI7QUFPbEUsU0FBU0ssbUJBQW1CQyxPQUFnQixFQUFFQyxLQUFlO0lBQzNELE1BQU1DLFNBQWtDLENBQUM7SUFDekNELE1BQU1FLE9BQU8sQ0FBQyxDQUFDQztRQUNiLE1BQU1DLFFBQVFULG1EQUFRQSxDQUFDSSxTQUFTSTtRQUNoQ0YsTUFBTSxDQUFDRSxLQUFLLEdBQUdOLDZEQUFjQSxDQUFDTyxTQUFTLE9BQU9BO0lBQ2hEO0lBQ0EsT0FBTztRQUFFSixPQUFPQztJQUFPO0FBQ3pCO0FBRUEsU0FBU0ksaUJBQWlCQyxRQUFnQjtJQUN4QyxJQUFJQSxhQUFhLGNBQWMsT0FBTztJQUN0QyxPQUFPO0FBQ1Q7QUFFQSxTQUFTQyxzQkFBc0JSLE9BQWdCLEVBQUVPLFFBQStCO0lBQzlFLE1BQU1FLGVBQWVaLCtEQUFnQkEsQ0FBQ0csU0FBU08sU0FBU04sS0FBSztJQUM3RCxNQUFNUyxXQUFXWCxtQkFBbUJDLFNBQVNPLFNBQVNOLEtBQUs7SUFDM0QsTUFBTVUsU0FBU0YsYUFBYUcsTUFBTSxLQUFLO0lBQ3ZDLE9BQU87UUFBRUQ7UUFBUUQ7UUFBVUQ7SUFBYTtBQUMxQztBQUVBLFNBQVNJLHVCQUF1QmIsT0FBZ0IsRUFBRWMsSUFBb0I7SUFDcEUsTUFBTVAsV0FBV08sS0FBS0MsaUJBQWlCO0lBQ3ZDLElBQUlSLFNBQVNTLElBQUksS0FBSyxtQkFBbUI7UUFDdkMsT0FBTztZQUFFTCxRQUFRO1lBQU1ELFVBQVUsQ0FBQztRQUFFO0lBQ3RDO0lBQ0EsTUFBTUwsUUFBUVQsbURBQVFBLENBQUNJLFNBQVNPLFNBQVNILElBQUk7SUFDN0MsSUFBSU4sNkRBQWNBLENBQUNPLFFBQVE7UUFDekIsT0FBTztZQUFFTSxRQUFRO1lBQU1ELFVBQVU7Z0JBQUVOLE1BQU1HLFNBQVNILElBQUk7Z0JB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RUFmLGdCQUFnQk0sSUFBSSxDQUFDO1lBQ25CQyxTQUFTMUQsS0FBSzBELE9BQU87WUFDckJDLFVBQVUzRCxLQUFLMkQsUUFBUTtZQUN2QjlEO1lBQ0ErRCxhQUFhNUQsS0FBSzRELFdBQVc7WUFDN0JoRTtZQUNBa0UsU0FBU2pFLFNBQVMsS0FBS0csS0FBS21FLGdCQUFnQjtZQUM1Q0osY0FBY3BCO1lBQ2RHLGlCQUFpQkQ7UUFDbkI7SUFDRjtJQUVBLE9BQU87UUFDTEMsaUJBQWlCRDtRQUNqQmtCLGNBQWNwQjtRQUNkeUIseUJBQXlCQyxNQUFNQyxJQUFJLENBQUN2QjtRQUNwQ0U7UUFDQUM7UUFDQXFCLGdCQUFnQkYsTUFBTUMsSUFBSSxDQUFDbEIsaUJBQWlCaEUsTUFBTTtRQUNsRG9GLGtCQUFrQnJCO0lBQ3BCO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9kb21pbmljcmFuZ2hpYXNjaS92ZXJpbGV4LWxhbmRpbmcvc3JjL3dvcmtmbG93My9ldmFsdWF0b3IvZXZhbHVhdGVSdWxlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEV2aWRlbmNlTWlzc2luZ09yTnVsbCwgUnVsZUNhdGFsb2csIFJ1bGVEZWZpbml0aW9uIH0gZnJvbSAnLi4vY2F0YWxvZy90eXBlcyc7XG5pbXBvcnQgdHlwZSB7IEdhQ291bnR5TG9va3VwIH0gZnJvbSAnLi4vY291bnRpZXMvdHlwZXMnO1xuaW1wb3J0IHsgbm9ybWFsaXplQ291bnR5IH0gZnJvbSAnLi4vY291bnRpZXMvZ2FDb3VudHlOb3JtYWxpemUnO1xuaW1wb3J0IHsgYXBwbGllc1doZW4gfSBmcm9tICcuL2FwcGx5V2hlbic7XG5pbXBvcnQgeyBnZXRGaWVsZCB9IGZyb20gJy4vZ2V0RmllbGQnO1xuaW1wb3J0IHsgZmluZE1pc3NpbmdQYXRocywgaXNNaXNzaW5nVmFsdWUgfSBmcm9tICcuL3JlcXVpcmVtZW50cyc7XG5pbXBvcnQgdHlwZSB7IENvdW50eU5vcm1hbGl6YXRpb24sIFJ1bGVFdmlkZW5jZSwgUnVsZUV2YWx1YXRpb24sIFJ1bGVGaW5kaW5nLCBSdWxlc0VuZ2luZVJlc3VsdCB9IGZyb20gJy4vdHlwZXMnO1xuXG50eXBlIEV2YWx1YXRlUnVsZXNPcHRpb25zID0ge1xuICBldmFsdWF0ZWRBdD86IHN0cmluZztcbn07XG5cbmZ1bmN0aW9uIGJ1aWxkUGF0aHNFdmlkZW5jZShwYXlsb2FkOiB1bmtub3duLCBwYXRoczogc3RyaW5nW10pOiBSdWxlRXZpZGVuY2Uge1xuICBjb25zdCB2YWx1ZXM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG4gIHBhdGhzLmZvckVhY2goKHBhdGgpID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9IGdldEZpZWxkKHBheWxvYWQsIHBhdGgpO1xuICAgIHZhbHVlc1twYXRoXSA9IGlzTWlzc2luZ1ZhbHVlKHZhbHVlKSA/IG51bGwgOiB2YWx1ZTtcbiAgfSk7XG4gIHJldHVybiB7IHBhdGhzOiB2YWx1ZXMgfTtcbn1cblxuZnVuY3Rpb24gbWFwTWF0Y2hTdHJhdGVneShzdHJhdGVneTogc3RyaW5nKTogJ3NsdWcnIHwgJ25hbWUnIHtcbiAgaWYgKHN0cmF0ZWd5ID09PSAnc2x1Z19leGFjdCcpIHJldHVybiAnc2x1Zyc7XG4gIHJldHVybiAnbmFtZSc7XG59XG5cbmZ1bmN0aW9uIGV2YWx1YXRlTWlzc2luZ09yTnVsbChwYXlsb2FkOiB1bmtub3duLCBzdHJhdGVneTogRXZpZGVuY2VNaXNzaW5nT3JOdWxsKSB7XG4gIGNvbnN0IG1pc3NpbmdQYXRocyA9IGZpbmRNaXNzaW5nUGF0aHMocGF5bG9hZCwgc3RyYXRlZ3kucGF0aHMpO1xuICBjb25zdCBldmlkZW5jZSA9IGJ1aWxkUGF0aHNFdmlkZW5jZShwYXlsb2FkLCBzdHJhdGVneS5wYXRocyk7XG4gIGNvbnN0IHBhc3NlZCA9IG1pc3NpbmdQYXRocy5sZW5ndGggPT09IDA7XG4gIHJldHVybiB7IHBhc3NlZCwgZXZpZGVuY2UsIG1pc3NpbmdQYXRocyB9O1xufVxuXG5mdW5jdGlvbiBldmFsdWF0ZUVudW1NZW1iZXJzaGlwKHBheWxvYWQ6IHVua25vd24sIHJ1bGU6IFJ1bGVEZWZpbml0aW9uKSB7XG4gIGNvbnN0IHN0cmF0ZWd5ID0gcnVsZS5ldmlkZW5jZV9zdHJhdGVneTtcbiAgaWYgKHN0cmF0ZWd5LnR5cGUgIT09ICdlbnVtX21lbWJlcnNoaXAnKSB7XG4gICAgcmV0dXJuIHsgcGFzc2VkOiB0cnVlLCBldmlkZW5jZToge30gfTtcbiAgfVxuICBjb25zdCB2YWx1ZSA9IGdldEZpZWxkKHBheWxvYWQsIHN0cmF0ZWd5LnBhdGgpO1xuICBpZiAoaXNNaXNzaW5nVmFsdWUodmFsdWUpKSB7XG4gICAgcmV0dXJuIHsgcGFzc2VkOiB0cnVlLCBldmlkZW5jZTogeyBwYXRoOiBzdHJhdGVneS5wYXRoLCB2YWx1ZTogbnVsbCB9IH07XG4gIH1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcGFzc2VkOiBmYWxzZSxcbiAgICAgIGV2aWRlbmNlOiB7XG4gICAgICAgIHBhdGg6IHN0cmF0ZWd5LnBhdGgsXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBhbGxvd2VkX3ZhbHVlczogc3RyYXRlZ3kuYWxsb3dlZF92YWx1ZXMsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbiAgY29uc3QgcGFzc2VkID0gc3RyYXRlZ3kuYWxsb3dlZF92YWx1ZXMuaW5jbHVkZXModmFsdWUpO1xuICByZXR1cm4ge1xuICAgIHBhc3NlZCxcbiAgICBldmlkZW5jZToge1xuICAgICAgcGF0aDogc3RyYXRlZ3kucGF0aCxcbiAgICAgIHZhbHVlLFxuICAgICAgYWxsb3dlZF92YWx1ZXM6IHN0cmF0ZWd5LmFsbG93ZWRfdmFsdWVzLFxuICAgIH0sXG4gIH07XG59XG5cbmZ1bmN0aW9uIGV2YWx1YXRlVHlwZUNoZWNrKHBheWxvYWQ6IHVua25vd24sIHJ1bGU6IFJ1bGVEZWZpbml0aW9uKSB7XG4gIGNvbnN0IHN0cmF0ZWd5ID0gcnVsZS5ldmlkZW5jZV9zdHJhdGVneTtcbiAgaWYgKHN0cmF0ZWd5LnR5cGUgIT09ICd0eXBlX2NoZWNrJykge1xuICAgIHJldHVybiB7IHBhc3NlZDogdHJ1ZSwgZXZpZGVuY2U6IHt9IH07XG4gIH1cbiAgY29uc3QgdmFsdWUgPSBnZXRGaWVsZChwYXlsb2FkLCBzdHJhdGVneS5wYXRoKTtcbiAgaWYgKGlzTWlzc2luZ1ZhbHVlKHZhbHVlKSkge1xuICAgIHJldHVybiB7IHBhc3NlZDogdHJ1ZSwgZXZpZGVuY2U6IHsgcGF0aDogc3RyYXRlZ3kucGF0aCwgdmFsdWU6IG51bGwgfSB9O1xuICB9XG5cbiAgbGV0IHBhc3NlZCA9IGZhbHNlO1xuICBpZiAoc3RyYXRlZ3kuZXhwZWN0ZWRfdHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICBwYXNzZWQgPSB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmICFOdW1iZXIuaXNOYU4odmFsdWUpO1xuICB9IGVsc2UgaWYgKHN0cmF0ZWd5LmV4cGVjdGVkX3R5cGUgPT09ICdib29sZWFuJykge1xuICAgIHBhc3NlZCA9IHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nO1xuICB9IGVsc2UgaWYgKHN0cmF0ZWd5LmV4cGVjdGVkX3R5cGUgPT09ICdkYXRlJykge1xuICAgIHBhc3NlZCA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgIU51bWJlci5pc05hTihEYXRlLnBhcnNlKHZhbHVlKSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHBhc3NlZCxcbiAgICBldmlkZW5jZToge1xuICAgICAgcGF0aDogc3RyYXRlZ3kucGF0aCxcbiAgICAgIHZhbHVlLFxuICAgICAgZXhwZWN0ZWRfdHlwZTogc3RyYXRlZ3kuZXhwZWN0ZWRfdHlwZSxcbiAgICB9LFxuICB9O1xufVxuXG5mdW5jdGlvbiBldmFsdWF0ZURhdGVPcmRlcihwYXlsb2FkOiB1bmtub3duLCBydWxlOiBSdWxlRGVmaW5pdGlvbikge1xuICBjb25zdCBzdHJhdGVneSA9IHJ1bGUuZXZpZGVuY2Vfc3RyYXRlZ3k7XG4gIGlmIChzdHJhdGVneS50eXBlICE9PSAnZGF0ZV9vcmRlcicpIHtcbiAgICByZXR1cm4geyBwYXNzZWQ6IHRydWUsIGV2aWRlbmNlOiB7fSB9O1xuICB9XG4gIGNvbnN0IGVhcmxpZXJWYWx1ZSA9IGdldEZpZWxkKHBheWxvYWQsIHN0cmF0ZWd5LmVhcmxpZXJfcGF0aCk7XG4gIGNvbnN0IGxhdGVyVmFsdWUgPSBnZXRGaWVsZChwYXlsb2FkLCBzdHJhdGVneS5sYXRlcl9wYXRoKTtcblxuICBpZiAoaXNNaXNzaW5nVmFsdWUoZWFybGllclZhbHVlKSB8fCBpc01pc3NpbmdWYWx1ZShsYXRlclZhbHVlKSkge1xuICAgIHJldHVybiB7XG4gICAgICBwYXNzZWQ6IHRydWUsXG4gICAgICBldmlkZW5jZToge1xuICAgICAgICBlYXJsaWVyX3BhdGg6IHN0cmF0ZWd5LmVhcmxpZXJfcGF0aCxcbiAgICAgICAgbGF0ZXJfcGF0aDogc3RyYXRlZ3kubGF0ZXJfcGF0aCxcbiAgICAgICAgZWFybGllcl92YWx1ZTogaXNNaXNzaW5nVmFsdWUoZWFybGllclZhbHVlKSA/IG51bGwgOiBlYXJsaWVyVmFsdWUsXG4gICAgICAgIGxhdGVyX3ZhbHVlOiBpc01pc3NpbmdWYWx1ZShsYXRlclZhbHVlKSA/IG51bGwgOiBsYXRlclZhbHVlLFxuICAgICAgICBvcGVyYXRvcjogc3RyYXRlZ3kub3BlcmF0b3IsXG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICBjb25zdCBlYXJsaWVyRGF0ZSA9IERhdGUucGFyc2UoU3RyaW5nKGVhcmxpZXJWYWx1ZSkpO1xuICBjb25zdCBsYXRlckRhdGUgPSBEYXRlLnBhcnNlKFN0cmluZyhsYXRlclZhbHVlKSk7XG4gIGlmIChOdW1iZXIuaXNOYU4oZWFybGllckRhdGUpIHx8IE51bWJlci5pc05hTihsYXRlckRhdGUpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhc3NlZDogdHJ1ZSxcbiAgICAgIGV2aWRlbmNlOiB7XG4gICAgICAgIGVhcmxpZXJfcGF0aDogc3RyYXRlZ3kuZWFybGllcl9wYXRoLFxuICAgICAgICBsYXRlcl9wYXRoOiBzdHJhdGVneS5sYXRlcl9wYXRoLFxuICAgICAgICBlYXJsaWVyX3ZhbHVlOiBlYXJsaWVyVmFsdWUsXG4gICAgICAgIGxhdGVyX3ZhbHVlOiBsYXRlclZhbHVlLFxuICAgICAgICBvcGVyYXRvcjogc3RyYXRlZ3kub3BlcmF0b3IsXG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICBsZXQgcGFzc2VkID0gdHJ1ZTtcbiAgc3dpdGNoIChzdHJhdGVneS5vcGVyYXRvcikge1xuICAgIGNhc2UgJzw9JzpcbiAgICAgIHBhc3NlZCA9IGVhcmxpZXJEYXRlIDw9IGxhdGVyRGF0ZTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJzwnOlxuICAgICAgcGFzc2VkID0gZWFybGllckRhdGUgPCBsYXRlckRhdGU7XG4gICAgICBicmVhaztcbiAgICBjYXNlICc+PSc6XG4gICAgICBwYXNzZWQgPSBlYXJsaWVyRGF0ZSA+PSBsYXRlckRhdGU7XG4gICAgICBicmVhaztcbiAgICBjYXNlICc+JzpcbiAgICAgIHBhc3NlZCA9IGVhcmxpZXJEYXRlID4gbGF0ZXJEYXRlO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHBhc3NlZCA9IHRydWU7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHBhc3NlZCxcbiAgICBldmlkZW5jZToge1xuICAgICAgZWFybGllcl9wYXRoOiBzdHJhdGVneS5lYXJsaWVyX3BhdGgsXG4gICAgICBsYXRlcl9wYXRoOiBzdHJhdGVneS5sYXRlcl9wYXRoLFxuICAgICAgZWFybGllcl92YWx1ZTogZWFybGllclZhbHVlLFxuICAgICAgbGF0ZXJfdmFsdWU6IGxhdGVyVmFsdWUsXG4gICAgICBvcGVyYXRvcjogc3RyYXRlZ3kub3BlcmF0b3IsXG4gICAgfSxcbiAgfTtcbn1cblxuZnVuY3Rpb24gZXZhbHVhdGVDc3ZMb29rdXAocGF5bG9hZDogdW5rbm93biwgcnVsZTogUnVsZURlZmluaXRpb24sIGxvb2t1cDogR2FDb3VudHlMb29rdXApIHtcbiAgY29uc3Qgc3RyYXRlZ3kgPSBydWxlLmV2aWRlbmNlX3N0cmF0ZWd5O1xuICBpZiAoc3RyYXRlZ3kudHlwZSAhPT0gJ2Nzdl9sb29rdXAnKSB7XG4gICAgcmV0dXJuIHsgcGFzc2VkOiB0cnVlLCBldmlkZW5jZToge30sIG5vcm1hbGl6YXRpb246IG51bGwgfTtcbiAgfVxuXG4gIGNvbnN0IHZhbHVlID0gZ2V0RmllbGQocGF5bG9hZCwgc3RyYXRlZ3kuaW5wdXRfcGF0aCk7XG4gIGlmIChpc01pc3NpbmdWYWx1ZSh2YWx1ZSkpIHtcbiAgICByZXR1cm4geyBwYXNzZWQ6IHRydWUsIGV2aWRlbmNlOiB7IGlucHV0X3BhdGg6IHN0cmF0ZWd5LmlucHV0X3BhdGgsIGlucHV0X3ZhbHVlOiBudWxsIH0sIG5vcm1hbGl6YXRpb246IG51bGwgfTtcbiAgfVxuXG4gIGNvbnN0IHJhd1ZhbHVlID0gU3RyaW5nKHZhbHVlKTtcbiAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUNvdW50eShyYXdWYWx1ZSwgbG9va3VwKTtcbiAgaWYgKCFub3JtYWxpemVkLm9rKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhc3NlZDogZmFsc2UsXG4gICAgICBldmlkZW5jZToge1xuICAgICAgICBpbnB1dF9wYXRoOiBzdHJhdGVneS5pbnB1dF9wYXRoLFxuICAgICAgICBpbnB1dF92YWx1ZTogcmF3VmFsdWUsXG4gICAgICAgIGVycm9yOiBub3JtYWxpemVkLmVycm9yLFxuICAgICAgICBzb3VyY2U6IHN0cmF0ZWd5LmNzdixcbiAgICAgIH0sXG4gICAgICBub3JtYWxpemF0aW9uOiBudWxsLFxuICAgIH07XG4gIH1cblxuICBjb25zdCBub3JtYWxpemF0aW9uOiBDb3VudHlOb3JtYWxpemF0aW9uID0ge1xuICAgIGtpbmQ6ICdjb3VudHlfbm9ybWFsaXphdGlvbicsXG4gICAgZmllbGRfcGF0aDogc3RyYXRlZ3kuaW5wdXRfcGF0aCxcbiAgICBpbnB1dF92YWx1ZTogcmF3VmFsdWUsXG4gICAgbm9ybWFsaXplZF92YWx1ZTogbm9ybWFsaXplZC5ub3JtYWxpemVkX3ZhbHVlLFxuICAgIG1hdGNoX3N0cmF0ZWd5OiBtYXBNYXRjaFN0cmF0ZWd5KG5vcm1hbGl6ZWQubWF0Y2hfc3RyYXRlZ3kpLFxuICAgIHNvdXJjZTogc3RyYXRlZ3kuY3N2LFxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgcGFzc2VkOiB0cnVlLFxuICAgIGV2aWRlbmNlOiB7XG4gICAgICBpbnB1dF9wYXRoOiBzdHJhdGVneS5pbnB1dF9wYXRoLFxuICAgICAgaW5wdXRfdmFsdWU6IHJhd1ZhbHVlLFxuICAgICAgbm9ybWFsaXplZF92YWx1ZTogbm9ybWFsaXplZC5ub3JtYWxpemVkX3ZhbHVlLFxuICAgICAgbWF0Y2hfc3RyYXRlZ3k6IG5vcm1hbGl6YXRpb24ubWF0Y2hfc3RyYXRlZ3ksXG4gICAgICBzb3VyY2U6IHN0cmF0ZWd5LmNzdixcbiAgICB9LFxuICAgIG5vcm1hbGl6YXRpb24sXG4gIH07XG59XG5cbmZ1bmN0aW9uIGV2YWx1YXRlUnVsZShcbiAgcGF5bG9hZDogdW5rbm93bixcbiAgcnVsZTogUnVsZURlZmluaXRpb24sXG4gIGxvb2t1cDogR2FDb3VudHlMb29rdXAsXG4pOiB7IHBhc3NlZDogYm9vbGVhbjsgZXZpZGVuY2U6IFJ1bGVFdmlkZW5jZTsgbWlzc2luZ1BhdGhzOiBzdHJpbmdbXTsgbm9ybWFsaXphdGlvbjogQ291bnR5Tm9ybWFsaXphdGlvbiB8IG51bGwgfSB7XG4gIGlmIChydWxlLmV2aWRlbmNlX3N0cmF0ZWd5LnR5cGUgPT09ICdtaXNzaW5nX29yX251bGwnKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gZXZhbHVhdGVNaXNzaW5nT3JOdWxsKHBheWxvYWQsIHJ1bGUuZXZpZGVuY2Vfc3RyYXRlZ3kpO1xuICAgIHJldHVybiB7XG4gICAgICBwYXNzZWQ6IHJlc3VsdC5wYXNzZWQsXG4gICAgICBldmlkZW5jZTogcmVzdWx0LmV2aWRlbmNlLFxuICAgICAgbWlzc2luZ1BhdGhzOiByZXN1bHQubWlzc2luZ1BhdGhzLFxuICAgICAgbm9ybWFsaXphdGlvbjogbnVsbCxcbiAgICB9O1xuICB9XG5cbiAgaWYgKHJ1bGUuZXZpZGVuY2Vfc3RyYXRlZ3kudHlwZSA9PT0gJ2VudW1fbWVtYmVyc2hpcCcpIHtcbiAgICBjb25zdCByZXN1bHQgPSBldmFsdWF0ZUVudW1NZW1iZXJzaGlwKHBheWxvYWQsIHJ1bGUpO1xuICAgIHJldHVybiB7IHBhc3NlZDogcmVzdWx0LnBhc3NlZCwgZXZpZGVuY2U6IHJlc3VsdC5ldmlkZW5jZSwgbWlzc2luZ1BhdGhzOiBbXSwgbm9ybWFsaXphdGlvbjogbnVsbCB9O1xuICB9XG5cbiAgaWYgKHJ1bGUuZXZpZGVuY2Vfc3RyYXRlZ3kudHlwZSA9PT0gJ3R5cGVfY2hlY2snKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gZXZhbHVhdGVUeXBlQ2hlY2socGF5bG9hZCwgcnVsZSk7XG4gICAgcmV0dXJuIHsgcGFzc2VkOiByZXN1bHQucGFzc2VkLCBldmlkZW5jZTogcmVzdWx0LmV2aWRlbmNlLCBtaXNzaW5nUGF0aHM6IFtdLCBub3JtYWxpemF0aW9uOiBudWxsIH07XG4gIH1cblxuICBpZiAocnVsZS5ldmlkZW5jZV9zdHJhdGVneS50eXBlID09PSAnZGF0ZV9vcmRlcicpIHtcbiAgICBjb25zdCByZXN1bHQgPSBldmFsdWF0ZURhdGVPcmRlcihwYXlsb2FkLCBydWxlKTtcbiAgICByZXR1cm4geyBwYXNzZWQ6IHJlc3VsdC5wYXNzZWQsIGV2aWRlbmNlOiByZXN1bHQuZXZpZGVuY2UsIG1pc3NpbmdQYXRoczogW10sIG5vcm1hbGl6YXRpb246IG51bGwgfTtcbiAgfVxuXG4gIGlmIChydWxlLmV2aWRlbmNlX3N0cmF0ZWd5LnR5cGUgPT09ICdjc3ZfbG9va3VwJykge1xuICAgIGNvbnN0IHJlc3VsdCA9IGV2YWx1YXRlQ3N2TG9va3VwKHBheWxvYWQsIHJ1bGUsIGxvb2t1cCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBhc3NlZDogcmVzdWx0LnBhc3NlZCxcbiAgICAgIGV2aWRlbmNlOiByZXN1bHQuZXZpZGVuY2UsXG4gICAgICBtaXNzaW5nUGF0aHM6IFtdLFxuICAgICAgbm9ybWFsaXphdGlvbjogcmVzdWx0Lm5vcm1hbGl6YXRpb24sXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7IHBhc3NlZDogdHJ1ZSwgZXZpZGVuY2U6IHt9LCBtaXNzaW5nUGF0aHM6IFtdLCBub3JtYWxpemF0aW9uOiBudWxsIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBldmFsdWF0ZVJ1bGVzKFxuICBwYXlsb2FkOiB1bmtub3duLFxuICBjYXRhbG9nOiBSdWxlQ2F0YWxvZyxcbiAgY291bnR5TG9va3VwOiBHYUNvdW50eUxvb2t1cCxcbiAgb3B0aW9uczogRXZhbHVhdGVSdWxlc09wdGlvbnMgPSB7fSxcbik6IFJ1bGVzRW5naW5lUmVzdWx0IHtcbiAgY29uc3QgZXZhbHVhdGVkQXQgPSBvcHRpb25zLmV2YWx1YXRlZEF0ID8/IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgY29uc3QgcnVsZXNldFZlcnNpb24gPSBjYXRhbG9nLnJ1bGVzZXRfdmVyc2lvbjtcbiAgY29uc3QgcmVxdWlyZWRNaXNzaW5nID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGNvbnN0IGJsb2NrczogUnVsZUZpbmRpbmdbXSA9IFtdO1xuICBjb25zdCB3YXJuaW5nczogUnVsZUZpbmRpbmdbXSA9IFtdO1xuICBjb25zdCBydWxlRXZhbHVhdGlvbnM6IFJ1bGVFdmFsdWF0aW9uW10gPSBbXTtcbiAgY29uc3Qgbm9ybWFsaXphdGlvbk1hcCA9IG5ldyBNYXA8c3RyaW5nLCBDb3VudHlOb3JtYWxpemF0aW9uPigpO1xuXG4gIGNhdGFsb2cucnVsZXMuZm9yRWFjaCgocnVsZSkgPT4ge1xuICAgIGNvbnN0IGFwcGxpY2FibGUgPSBhcHBsaWVzV2hlbihwYXlsb2FkLCBydWxlLmFwcGxpZXNfd2hlbik7XG5cbiAgICBpZiAoIWFwcGxpY2FibGUpIHtcbiAgICAgIHJ1bGVFdmFsdWF0aW9ucy5wdXNoKHtcbiAgICAgICAgcnVsZV9pZDogcnVsZS5ydWxlX2lkLFxuICAgICAgICBzZXZlcml0eTogcnVsZS5zZXZlcml0eSxcbiAgICAgICAgcGFzc2VkOiB0cnVlLFxuICAgICAgICBmaWVsZF9wYXRoczogcnVsZS5maWVsZF9wYXRocyxcbiAgICAgICAgZXZpZGVuY2U6IHsgc2tpcHBlZDogdHJ1ZSB9LFxuICAgICAgICBtZXNzYWdlOiAnJyxcbiAgICAgICAgZXZhbHVhdGVkX2F0OiBldmFsdWF0ZWRBdCxcbiAgICAgICAgcnVsZXNldF92ZXJzaW9uOiBydWxlc2V0VmVyc2lvbixcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHsgcGFzc2VkLCBldmlkZW5jZSwgbWlzc2luZ1BhdGhzLCBub3JtYWxpemF0aW9uIH0gPSBldmFsdWF0ZVJ1bGUocGF5bG9hZCwgcnVsZSwgY291bnR5TG9va3VwKTtcblxuICAgIGlmIChcbiAgICAgIG1pc3NpbmdQYXRocy5sZW5ndGggPiAwICYmXG4gICAgICBydWxlLmV2aWRlbmNlX3N0cmF0ZWd5LnR5cGUgPT09ICdtaXNzaW5nX29yX251bGwnICYmXG4gICAgICBydWxlLnNldmVyaXR5ID09PSAnYmxvY2snXG4gICAgKSB7XG4gICAgICBtaXNzaW5nUGF0aHMuZm9yRWFjaCgocGF0aCkgPT4gcmVxdWlyZWRNaXNzaW5nLmFkZChwYXRoKSk7XG4gICAgfVxuXG4gICAgaWYgKG5vcm1hbGl6YXRpb24pIHtcbiAgICAgIG5vcm1hbGl6YXRpb25NYXAuc2V0KG5vcm1hbGl6YXRpb24uZmllbGRfcGF0aCwgbm9ybWFsaXphdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKCFwYXNzZWQpIHtcbiAgICAgIGNvbnN0IGZpbmRpbmc6IFJ1bGVGaW5kaW5nID0ge1xuICAgICAgICBydWxlX2lkOiBydWxlLnJ1bGVfaWQsXG4gICAgICAgIHNldmVyaXR5OiBydWxlLnNldmVyaXR5LFxuICAgICAgICBtZXNzYWdlOiBydWxlLm1lc3NhZ2VfdGVtcGxhdGUsXG4gICAgICAgIGZpZWxkX3BhdGhzOiBydWxlLmZpZWxkX3BhdGhzLFxuICAgICAgICBldmlkZW5jZSxcbiAgICAgICAgZXZhbHVhdGVkX2F0OiBldmFsdWF0ZWRBdCxcbiAgICAgICAgcnVsZXNldF92ZXJzaW9uOiBydWxlc2V0VmVyc2lvbixcbiAgICAgIH07XG4gICAgICBpZiAocnVsZS5zZXZlcml0eSA9PT0gJ2Jsb2NrJykge1xuICAgICAgICBibG9ja3MucHVzaChmaW5kaW5nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goZmluZGluZyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcnVsZUV2YWx1YXRpb25zLnB1c2goe1xuICAgICAgcnVsZV9pZDogcnVsZS5ydWxlX2lkLFxuICAgICAgc2V2ZXJpdHk6IHJ1bGUuc2V2ZXJpdHksXG4gICAgICBwYXNzZWQsXG4gICAgICBmaWVsZF9wYXRoczogcnVsZS5maWVsZF9wYXRocyxcbiAgICAgIGV2aWRlbmNlLFxuICAgICAgbWVzc2FnZTogcGFzc2VkID8gJycgOiBydWxlLm1lc3NhZ2VfdGVtcGxhdGUsXG4gICAgICBldmFsdWF0ZWRfYXQ6IGV2YWx1YXRlZEF0LFxuICAgICAgcnVsZXNldF92ZXJzaW9uOiBydWxlc2V0VmVyc2lvbixcbiAgICB9KTtcbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBydWxlc2V0X3ZlcnNpb246IHJ1bGVzZXRWZXJzaW9uLFxuICAgIGV2YWx1YXRlZF9hdDogZXZhbHVhdGVkQXQsXG4gICAgcmVxdWlyZWRfZmllbGRzX21pc3Npbmc6IEFycmF5LmZyb20ocmVxdWlyZWRNaXNzaW5nKSxcbiAgICBibG9ja3MsXG4gICAgd2FybmluZ3MsXG4gICAgbm9ybWFsaXphdGlvbnM6IEFycmF5LmZyb20obm9ybWFsaXphdGlvbk1hcC52YWx1ZXMoKSksXG4gICAgcnVsZV9ldmFsdWF0aW9uczogcnVsZUV2YWx1YXRpb25zLFxuICB9O1xufVxuIl0sIm5hbWVzIjpbIm5vcm1hbGl6ZUNvdW50eSIsImFwcGxpZXNXaGVuIiwiZ2V0RmllbGQiLCJmaW5kTWlzc2luZ1BhdGhzIiwiaXNNaXNzaW5nVmFsdWUiLCJidWlsZFBhdGhzRXZpZGVuY2UiLCJwYXlsb2FkIiwicGF0aHMiLCJ2YWx1ZXMiLCJmb3JFYWNoIiwicGF0aCIsInZhbHVlIiwibWFwTWF0Y2hTdHJhdGVneSIsInN0cmF0ZWd5IiwiZXZhbHVhdGVNaXNzaW5nT3JOdWxsIiwibWlzc2luZ1BhdGhzIiwiZXZpZGVuY2UiLCJwYXNzZWQiLCJsZW5ndGgiLCJldmFsdWF0ZUVudW1NZW1iZXJzaGlwIiwicnVsZSIsImV2aWRlbmNlX3N0cmF0ZWd5IiwidHlwZSIsImFsbG93ZWRfdmFsdWVzIiwiaW5jbHVkZXMiLCJldmFsdWF0ZVR5cGVDaGVjayIsImV4cGVjdGVkX3R5cGUiLCJOdW1iZXIiLCJpc05hTiIsIkRhdGUiLCJwYXJzZSIsImV2YWx1YXRlRGF0ZU9yZGVyIiwiZWFybGllclZhbHVlIiwiZWFybGllcl9wYXRoIiwibGF0ZXJWYWx1ZSIsImxhdGVyX3BhdGgiLCJlYXJsaWVyX3ZhbHVlIiwibGF0ZXJfdmFsdWUiLCJvcGVyYXRvciIsImVhcmxpZXJEYXRlIiwiU3RyaW5nIiwibGF0ZXJEYXRlIiwiZXZhbHVhdGVDc3ZMb29rdXAiLCJsb29rdXAiLCJub3JtYWxpemF0aW9uIiwiaW5wdXRfcGF0aCIsImlucHV0X3ZhbHVlIiwicmF3VmFsdWUiLCJub3JtYWxpemVkIiwib2siLCJlcnJvciIsInNvdXJjZSIsImNzdiIsImtpbmQiLCJmaWVsZF9wYXRoIiwibm9ybWFsaXplZF92YWx1ZSIsIm1hdGNoX3N0cmF0ZWd5IiwiZXZhbHVhdGVSdWxlIiwicmVzdWx0IiwiZXZhbHVhdGVSdWxlcyIsImNhdGFsb2ciLCJjb3VudHlMb29rdXAiLCJvcHRpb25zIiwiZXZhbHVhdGVkQXQiLCJ0b0lTT1N0cmluZyIsInJ1bGVzZXRWZXJzaW9uIiwicnVsZXNldF92ZXJzaW9uIiwicmVxdWlyZWRNaXNzaW5nIiwiU2V0IiwiYmxvY2tzIiwid2FybmluZ3MiLCJydWxlRXZhbHVhdGlvbnMiLCJub3JtYWxpemF0aW9uTWFwIiwiTWFwIiwicnVsZXMiLCJhcHBsaWNhYmxlIiwiYXBwbGllc193aGVuIiwicHVzaCIsInJ1bGVfaWQiLCJzZXZlcml0eSIsImZpZWxkX3BhdGhzIiwic2tpcHBlZCIsIm1lc3NhZ2UiLCJldmFsdWF0ZWRfYXQiLCJhZGQiLCJzZXQiLCJmaW5kaW5nIiwibWVzc2FnZV90ZW1wbGF0ZSIsInJlcXVpcmVkX2ZpZWxkc19taXNzaW5nIiwiQXJyYXkiLCJmcm9tIiwibm9ybWFsaXphdGlvbnMiLCJydWxlX2V2YWx1YXRpb25zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/evaluator/evaluateRules.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/evaluator/getField.ts":
/*!*************************************************!*\
  !*** ../../src/workflow3/evaluator/getField.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getField: () => (/* binding */ getField)\n/* harmony export */ });\nfunction parsePath(path) {\n    if (!path.startsWith('$')) return [];\n    let remainder = path.slice(1);\n    if (remainder.startsWith('.')) remainder = remainder.slice(1);\n    const segments = [];\n    const regex = /([^.\\[\\]]+)|\\[(\\d+)\\]/g;\n    let match;\n    while((match = regex.exec(remainder)) !== null){\n        if (match[1]) {\n            segments.push(match[1]);\n        } else if (match[2]) {\n            segments.push(Number(match[2]));\n        }\n    }\n    return segments;\n}\nfunction getField(payload, path) {\n    const segments = parsePath(path);\n    let current = payload;\n    for (const segment of segments){\n        if (current === null || current === undefined) return undefined;\n        if (typeof segment === 'number') {\n            if (!Array.isArray(current)) return undefined;\n            current = current[segment];\n            continue;\n        }\n        if (typeof current !== 'object') return undefined;\n        current = current[segment];\n    }\n    return current;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2V2YWx1YXRvci9nZXRGaWVsZC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBRUEsU0FBU0EsVUFBVUMsSUFBWTtJQUM3QixJQUFJLENBQUNBLEtBQUtDLFVBQVUsQ0FBQyxNQUFNLE9BQU8sRUFBRTtJQUNwQyxJQUFJQyxZQUFZRixLQUFLRyxLQUFLLENBQUM7SUFDM0IsSUFBSUQsVUFBVUQsVUFBVSxDQUFDLE1BQU1DLFlBQVlBLFVBQVVDLEtBQUssQ0FBQztJQUMzRCxNQUFNQyxXQUEwQixFQUFFO0lBQ2xDLE1BQU1DLFFBQVE7SUFDZCxJQUFJQztJQUNKLE1BQU8sQ0FBQ0EsUUFBUUQsTUFBTUUsSUFBSSxDQUFDTCxVQUFTLE1BQU8sS0FBTTtRQUMvQyxJQUFJSSxLQUFLLENBQUMsRUFBRSxFQUFFO1lBQ1pGLFNBQVNJLElBQUksQ0FBQ0YsS0FBSyxDQUFDLEVBQUU7UUFDeEIsT0FBTyxJQUFJQSxLQUFLLENBQUMsRUFBRSxFQUFFO1lBQ25CRixTQUFTSSxJQUFJLENBQUNDLE9BQU9ILEtBQUssQ0FBQyxFQUFFO1FBQy9CO0lBQ0Y7SUFDQSxPQUFPRjtBQUNUO0FBRU8sU0FBU00sU0FBU0MsT0FBZ0IsRUFBRVgsSUFBWTtJQUNyRCxNQUFNSSxXQUFXTCxVQUFVQztJQUMzQixJQUFJWSxVQUFtQkQ7SUFDdkIsS0FBSyxNQUFNRSxXQUFXVCxTQUFVO1FBQzlCLElBQUlRLFlBQVksUUFBUUEsWUFBWUUsV0FBVyxPQUFPQTtRQUN0RCxJQUFJLE9BQU9ELFlBQVksVUFBVTtZQUMvQixJQUFJLENBQUNFLE1BQU1DLE9BQU8sQ0FBQ0osVUFBVSxPQUFPRTtZQUNwQ0YsVUFBVUEsT0FBTyxDQUFDQyxRQUFRO1lBQzFCO1FBQ0Y7UUFDQSxJQUFJLE9BQU9ELFlBQVksVUFBVSxPQUFPRTtRQUN4Q0YsVUFBVSxPQUFvQyxDQUFDQyxRQUFRO0lBQ3pEO0lBQ0EsT0FBT0Q7QUFDVCIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9zcmMvd29ya2Zsb3czL2V2YWx1YXRvci9nZXRGaWVsZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIFBhdGhTZWdtZW50ID0gc3RyaW5nIHwgbnVtYmVyO1xuXG5mdW5jdGlvbiBwYXJzZVBhdGgocGF0aDogc3RyaW5nKTogUGF0aFNlZ21lbnRbXSB7XG4gIGlmICghcGF0aC5zdGFydHNXaXRoKCckJykpIHJldHVybiBbXTtcbiAgbGV0IHJlbWFpbmRlciA9IHBhdGguc2xpY2UoMSk7XG4gIGlmIChyZW1haW5kZXIuc3RhcnRzV2l0aCgnLicpKSByZW1haW5kZXIgPSByZW1haW5kZXIuc2xpY2UoMSk7XG4gIGNvbnN0IHNlZ21lbnRzOiBQYXRoU2VnbWVudFtdID0gW107XG4gIGNvbnN0IHJlZ2V4ID0gLyhbXi5cXFtcXF1dKyl8XFxbKFxcZCspXFxdL2c7XG4gIGxldCBtYXRjaDogUmVnRXhwRXhlY0FycmF5IHwgbnVsbDtcbiAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMocmVtYWluZGVyKSkgIT09IG51bGwpIHtcbiAgICBpZiAobWF0Y2hbMV0pIHtcbiAgICAgIHNlZ21lbnRzLnB1c2gobWF0Y2hbMV0pO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hbMl0pIHtcbiAgICAgIHNlZ21lbnRzLnB1c2goTnVtYmVyKG1hdGNoWzJdKSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBzZWdtZW50cztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpZWxkKHBheWxvYWQ6IHVua25vd24sIHBhdGg6IHN0cmluZyk6IHVua25vd24ge1xuICBjb25zdCBzZWdtZW50cyA9IHBhcnNlUGF0aChwYXRoKTtcbiAgbGV0IGN1cnJlbnQ6IHVua25vd24gPSBwYXlsb2FkO1xuICBmb3IgKGNvbnN0IHNlZ21lbnQgb2Ygc2VnbWVudHMpIHtcbiAgICBpZiAoY3VycmVudCA9PT0gbnVsbCB8fCBjdXJyZW50ID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgaWYgKHR5cGVvZiBzZWdtZW50ID09PSAnbnVtYmVyJykge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGN1cnJlbnQpKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgY3VycmVudCA9IGN1cnJlbnRbc2VnbWVudF07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjdXJyZW50ICE9PSAnb2JqZWN0JykgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBjdXJyZW50ID0gKGN1cnJlbnQgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW3NlZ21lbnRdO1xuICB9XG4gIHJldHVybiBjdXJyZW50O1xufVxuIl0sIm5hbWVzIjpbInBhcnNlUGF0aCIsInBhdGgiLCJzdGFydHNXaXRoIiwicmVtYWluZGVyIiwic2xpY2UiLCJzZWdtZW50cyIsInJlZ2V4IiwibWF0Y2giLCJleGVjIiwicHVzaCIsIk51bWJlciIsImdldEZpZWxkIiwicGF5bG9hZCIsImN1cnJlbnQiLCJzZWdtZW50IiwidW5kZWZpbmVkIiwiQXJyYXkiLCJpc0FycmF5Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/evaluator/getField.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/evaluator/requirements.ts":
/*!*****************************************************!*\
  !*** ../../src/workflow3/evaluator/requirements.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   findMissingPaths: () => (/* binding */ findMissingPaths),\n/* harmony export */   isMissingValue: () => (/* binding */ isMissingValue)\n/* harmony export */ });\n/* harmony import */ var _getField__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getField */ \"(api-node)/../../src/workflow3/evaluator/getField.ts\");\n\nfunction isMissingValue(value) {\n    if (value === null || value === undefined) return true;\n    if (typeof value === 'string') return value.trim().length === 0;\n    return false;\n}\nfunction findMissingPaths(payload, paths) {\n    const missing = [];\n    paths.forEach((path)=>{\n        const value = (0,_getField__WEBPACK_IMPORTED_MODULE_0__.getField)(payload, path);\n        if (isMissingValue(value)) {\n            missing.push(path);\n        }\n    });\n    return missing;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL2V2YWx1YXRvci9yZXF1aXJlbWVudHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXNDO0FBRS9CLFNBQVNDLGVBQWVDLEtBQWM7SUFDM0MsSUFBSUEsVUFBVSxRQUFRQSxVQUFVQyxXQUFXLE9BQU87SUFDbEQsSUFBSSxPQUFPRCxVQUFVLFVBQVUsT0FBT0EsTUFBTUUsSUFBSSxHQUFHQyxNQUFNLEtBQUs7SUFDOUQsT0FBTztBQUNUO0FBRU8sU0FBU0MsaUJBQWlCQyxPQUFnQixFQUFFQyxLQUFlO0lBQ2hFLE1BQU1DLFVBQW9CLEVBQUU7SUFDNUJELE1BQU1FLE9BQU8sQ0FBQyxDQUFDQztRQUNiLE1BQU1ULFFBQVFGLG1EQUFRQSxDQUFDTyxTQUFTSTtRQUNoQyxJQUFJVixlQUFlQyxRQUFRO1lBQ3pCTyxRQUFRRyxJQUFJLENBQUNEO1FBQ2Y7SUFDRjtJQUNBLE9BQU9GO0FBQ1QiLCJzb3VyY2VzIjpbIi9Vc2Vycy9kb21pbmljcmFuZ2hpYXNjaS92ZXJpbGV4LWxhbmRpbmcvc3JjL3dvcmtmbG93My9ldmFsdWF0b3IvcmVxdWlyZW1lbnRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEZpZWxkIH0gZnJvbSAnLi9nZXRGaWVsZCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01pc3NpbmdWYWx1ZSh2YWx1ZTogdW5rbm93bik6IGJvb2xlYW4ge1xuICBpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWU7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSByZXR1cm4gdmFsdWUudHJpbSgpLmxlbmd0aCA9PT0gMDtcbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZE1pc3NpbmdQYXRocyhwYXlsb2FkOiB1bmtub3duLCBwYXRoczogc3RyaW5nW10pOiBzdHJpbmdbXSB7XG4gIGNvbnN0IG1pc3Npbmc6IHN0cmluZ1tdID0gW107XG4gIHBhdGhzLmZvckVhY2goKHBhdGgpID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9IGdldEZpZWxkKHBheWxvYWQsIHBhdGgpO1xuICAgIGlmIChpc01pc3NpbmdWYWx1ZSh2YWx1ZSkpIHtcbiAgICAgIG1pc3NpbmcucHVzaChwYXRoKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gbWlzc2luZztcbn1cbiJdLCJuYW1lcyI6WyJnZXRGaWVsZCIsImlzTWlzc2luZ1ZhbHVlIiwidmFsdWUiLCJ1bmRlZmluZWQiLCJ0cmltIiwibGVuZ3RoIiwiZmluZE1pc3NpbmdQYXRocyIsInBheWxvYWQiLCJwYXRocyIsIm1pc3NpbmciLCJmb3JFYWNoIiwicGF0aCIsInB1c2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/evaluator/requirements.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/runWorkflow3Rules.ts":
/*!************************************************!*\
  !*** ../../src/workflow3/runWorkflow3Rules.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   runWorkflow3Rules: () => (/* binding */ runWorkflow3Rules)\n/* harmony export */ });\n/* harmony import */ var _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/server/supabaseAdmin */ \"(api-node)/../../lib/server/supabaseAdmin.ts\");\n/* harmony import */ var _counties_gaCountiesLoader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./counties/gaCountiesLoader */ \"(api-node)/../../src/workflow3/counties/gaCountiesLoader.ts\");\n/* harmony import */ var _catalog_loadRuleCatalog__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./catalog/loadRuleCatalog */ \"(api-node)/../../src/workflow3/catalog/loadRuleCatalog.ts\");\n/* harmony import */ var _evaluator_evaluateRules__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./evaluator/evaluateRules */ \"(api-node)/../../src/workflow3/evaluator/evaluateRules.ts\");\n/* harmony import */ var _storage_writeRulesEvaluation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./storage/writeRulesEvaluation */ \"(api-node)/../../src/workflow3/storage/writeRulesEvaluation.ts\");\n\n\n\n\n\nfunction isPlainObject(value) {\n    return Boolean(value) && typeof value === 'object' && !Array.isArray(value);\n}\nasync function loadIntake(intakeId) {\n    const { data, error } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intakes').select('id, firm_id, status, submitted_at, raw_payload').eq('id', intakeId).maybeSingle();\n    if (error) {\n        throw new Error('Unable to load intake');\n    }\n    if (!data) {\n        throw new Error('Intake not found');\n    }\n    return data;\n}\nasync function findExistingEvaluation(intakeId, rulesetVersion) {\n    const { data, error } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intake_extractions').select('id, version, extracted_data, schema_version, created_at').eq('intake_id', intakeId).eq('extracted_data->rules_engine->>ruleset_version', rulesetVersion).order('version', {\n        ascending: false\n    }).limit(1).maybeSingle();\n    if (error) {\n        throw new Error('Unable to query existing rules evaluation');\n    }\n    if (!data) return null;\n    const extracted = data.extracted_data;\n    if (!extracted?.rules_engine) return null;\n    return {\n        ...data,\n        rules_engine: extracted.rules_engine\n    };\n}\nasync function runWorkflow3Rules(input) {\n    const intake = await loadIntake(input.intake_id);\n    if (input.firm_id && input.firm_id !== intake.firm_id) {\n        throw new Error('Intake firm mismatch');\n    }\n    if (!intake.submitted_at && intake.status !== 'submitted') {\n        throw new Error('Intake is not submitted');\n    }\n    const { catalog, ruleset_version } = (0,_catalog_loadRuleCatalog__WEBPACK_IMPORTED_MODULE_2__.getRuleCatalog)();\n    const existing = await findExistingEvaluation(intake.id, ruleset_version);\n    if (existing) {\n        return {\n            evaluation: existing.rules_engine,\n            ruleset_version,\n            written: false,\n            extraction_id: existing.id,\n            version: existing.version\n        };\n    }\n    const payload = isPlainObject(intake.raw_payload) ? intake.raw_payload : {};\n    const counties = (0,_counties_gaCountiesLoader__WEBPACK_IMPORTED_MODULE_1__.loadGaCounties)();\n    const evaluation = (0,_evaluator_evaluateRules__WEBPACK_IMPORTED_MODULE_3__.evaluateRules)(payload, catalog, counties);\n    const inserted = await (0,_storage_writeRulesEvaluation__WEBPACK_IMPORTED_MODULE_4__.writeRulesEvaluation)(intake.id, evaluation);\n    console.info(`[wf3] intake_id=${intake.id} ruleset=${ruleset_version} version=${inserted.version}`);\n    return {\n        evaluation,\n        ruleset_version,\n        written: true,\n        extraction_id: inserted.id,\n        version: inserted.version\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL3J1bldvcmtmbG93M1J1bGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUErRDtBQUNGO0FBQ0Y7QUFDRDtBQUNZO0FBZ0J0RSxTQUFTSyxjQUFjQyxLQUFjO0lBQ25DLE9BQU9DLFFBQVFELFVBQVUsT0FBT0EsVUFBVSxZQUFZLENBQUNFLE1BQU1DLE9BQU8sQ0FBQ0g7QUFDdkU7QUFFQSxlQUFlSSxXQUFXQyxRQUFnQjtJQUN4QyxNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTWIsb0VBQWFBLENBQ3hDYyxJQUFJLENBQUMsV0FDTEMsTUFBTSxDQUFDLGtEQUNQQyxFQUFFLENBQUMsTUFBTUwsVUFDVE0sV0FBVztJQUVkLElBQUlKLE9BQU87UUFDVCxNQUFNLElBQUlLLE1BQU07SUFDbEI7SUFDQSxJQUFJLENBQUNOLE1BQU07UUFDVCxNQUFNLElBQUlNLE1BQU07SUFDbEI7SUFFQSxPQUFPTjtBQUNUO0FBRUEsZUFBZU8sdUJBQXVCUixRQUFnQixFQUFFUyxjQUFzQjtJQUM1RSxNQUFNLEVBQUVSLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTWIsb0VBQWFBLENBQ3hDYyxJQUFJLENBQUMsc0JBQ0xDLE1BQU0sQ0FBQywyREFDUEMsRUFBRSxDQUFDLGFBQWFMLFVBQ2hCSyxFQUFFLENBQUMsa0RBQWtESSxnQkFDckRDLEtBQUssQ0FBQyxXQUFXO1FBQUVDLFdBQVc7SUFBTSxHQUNwQ0MsS0FBSyxDQUFDLEdBQ05OLFdBQVc7SUFFZCxJQUFJSixPQUFPO1FBQ1QsTUFBTSxJQUFJSyxNQUFNO0lBQ2xCO0lBRUEsSUFBSSxDQUFDTixNQUFNLE9BQU87SUFDbEIsTUFBTVksWUFBWVosS0FBS2EsY0FBYztJQUNyQyxJQUFJLENBQUNELFdBQVdFLGNBQWMsT0FBTztJQUVyQyxPQUFPO1FBQUUsR0FBR2QsSUFBSTtRQUFFYyxjQUFjRixVQUFVRSxZQUFZO0lBQUM7QUFDekQ7QUFFTyxlQUFlQyxrQkFDcEJDLEtBQXdCO0lBRXhCLE1BQU1DLFNBQVMsTUFBTW5CLFdBQVdrQixNQUFNRSxTQUFTO0lBQy9DLElBQUlGLE1BQU1HLE9BQU8sSUFBSUgsTUFBTUcsT0FBTyxLQUFLRixPQUFPRSxPQUFPLEVBQUU7UUFDckQsTUFBTSxJQUFJYixNQUFNO0lBQ2xCO0lBRUEsSUFBSSxDQUFDVyxPQUFPRyxZQUFZLElBQUlILE9BQU9JLE1BQU0sS0FBSyxhQUFhO1FBQ3pELE1BQU0sSUFBSWYsTUFBTTtJQUNsQjtJQUVBLE1BQU0sRUFBRWdCLE9BQU8sRUFBRUMsZUFBZSxFQUFFLEdBQUdqQyx3RUFBY0E7SUFFbkQsTUFBTWtDLFdBQVcsTUFBTWpCLHVCQUF1QlUsT0FBT1EsRUFBRSxFQUFFRjtJQUN6RCxJQUFJQyxVQUFVO1FBQ1osT0FBTztZQUNMRSxZQUFZRixTQUFTVixZQUFZO1lBQ2pDUztZQUNBSSxTQUFTO1lBQ1RDLGVBQWVKLFNBQVNDLEVBQUU7WUFDMUJJLFNBQVNMLFNBQVNLLE9BQU87UUFDM0I7SUFDRjtJQUVBLE1BQU1DLFVBQVVyQyxjQUFjd0IsT0FBT2MsV0FBVyxJQUFJZCxPQUFPYyxXQUFXLEdBQUcsQ0FBQztJQUMxRSxNQUFNQyxXQUFXM0MsMEVBQWNBO0lBQy9CLE1BQU1xQyxhQUFhbkMsdUVBQWFBLENBQUN1QyxTQUFTUixTQUFTVTtJQUVuRCxNQUFNQyxXQUFXLE1BQU16QyxtRkFBb0JBLENBQUN5QixPQUFPUSxFQUFFLEVBQUVDO0lBRXZEUSxRQUFRQyxJQUFJLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRWxCLE9BQU9RLEVBQUUsQ0FBQyxTQUFTLEVBQUVGLGdCQUFnQixTQUFTLEVBQUVVLFNBQVNKLE9BQU8sRUFBRTtJQUVsRyxPQUFPO1FBQ0xIO1FBQ0FIO1FBQ0FJLFNBQVM7UUFDVEMsZUFBZUssU0FBU1IsRUFBRTtRQUMxQkksU0FBU0ksU0FBU0osT0FBTztJQUMzQjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL3NyYy93b3JrZmxvdzMvcnVuV29ya2Zsb3czUnVsZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJy4uLy4uL2xpYi9zZXJ2ZXIvc3VwYWJhc2VBZG1pbic7XG5pbXBvcnQgeyBsb2FkR2FDb3VudGllcyB9IGZyb20gJy4vY291bnRpZXMvZ2FDb3VudGllc0xvYWRlcic7XG5pbXBvcnQgeyBnZXRSdWxlQ2F0YWxvZyB9IGZyb20gJy4vY2F0YWxvZy9sb2FkUnVsZUNhdGFsb2cnO1xuaW1wb3J0IHsgZXZhbHVhdGVSdWxlcyB9IGZyb20gJy4vZXZhbHVhdG9yL2V2YWx1YXRlUnVsZXMnO1xuaW1wb3J0IHsgd3JpdGVSdWxlc0V2YWx1YXRpb24gfSBmcm9tICcuL3N0b3JhZ2Uvd3JpdGVSdWxlc0V2YWx1YXRpb24nO1xuaW1wb3J0IHR5cGUgeyBSdWxlc0VuZ2luZVJlc3VsdCB9IGZyb20gJy4vZXZhbHVhdG9yL3R5cGVzJztcblxuZXhwb3J0IHR5cGUgUnVuV29ya2Zsb3czSW5wdXQgPSB7XG4gIGludGFrZV9pZDogc3RyaW5nO1xuICBmaXJtX2lkPzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgUnVuV29ya2Zsb3czUmVzdWx0ID0ge1xuICBldmFsdWF0aW9uOiBSdWxlc0VuZ2luZVJlc3VsdDtcbiAgcnVsZXNldF92ZXJzaW9uOiBzdHJpbmc7XG4gIHdyaXR0ZW46IGJvb2xlYW47XG4gIGV4dHJhY3Rpb25faWQ/OiBzdHJpbmc7XG4gIHZlcnNpb24/OiBudW1iZXI7XG59O1xuXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbHVlOiB1bmtub3duKTogdmFsdWUgaXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4ge1xuICByZXR1cm4gQm9vbGVhbih2YWx1ZSkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGxvYWRJbnRha2UoaW50YWtlSWQ6IHN0cmluZykge1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oJ2ludGFrZXMnKVxuICAgIC5zZWxlY3QoJ2lkLCBmaXJtX2lkLCBzdGF0dXMsIHN1Ym1pdHRlZF9hdCwgcmF3X3BheWxvYWQnKVxuICAgIC5lcSgnaWQnLCBpbnRha2VJZClcbiAgICAubWF5YmVTaW5nbGUoKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2FkIGludGFrZScpO1xuICB9XG4gIGlmICghZGF0YSkge1xuICAgIHRocm93IG5ldyBFcnJvcignSW50YWtlIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGZpbmRFeGlzdGluZ0V2YWx1YXRpb24oaW50YWtlSWQ6IHN0cmluZywgcnVsZXNldFZlcnNpb246IHN0cmluZykge1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oJ2ludGFrZV9leHRyYWN0aW9ucycpXG4gICAgLnNlbGVjdCgnaWQsIHZlcnNpb24sIGV4dHJhY3RlZF9kYXRhLCBzY2hlbWFfdmVyc2lvbiwgY3JlYXRlZF9hdCcpXG4gICAgLmVxKCdpbnRha2VfaWQnLCBpbnRha2VJZClcbiAgICAuZXEoJ2V4dHJhY3RlZF9kYXRhLT5ydWxlc19lbmdpbmUtPj5ydWxlc2V0X3ZlcnNpb24nLCBydWxlc2V0VmVyc2lvbilcbiAgICAub3JkZXIoJ3ZlcnNpb24nLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcbiAgICAubGltaXQoMSlcbiAgICAubWF5YmVTaW5nbGUoKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBxdWVyeSBleGlzdGluZyBydWxlcyBldmFsdWF0aW9uJyk7XG4gIH1cblxuICBpZiAoIWRhdGEpIHJldHVybiBudWxsO1xuICBjb25zdCBleHRyYWN0ZWQgPSBkYXRhLmV4dHJhY3RlZF9kYXRhIGFzIHsgcnVsZXNfZW5naW5lPzogUnVsZXNFbmdpbmVSZXN1bHQgfSB8IG51bGw7XG4gIGlmICghZXh0cmFjdGVkPy5ydWxlc19lbmdpbmUpIHJldHVybiBudWxsO1xuXG4gIHJldHVybiB7IC4uLmRhdGEsIHJ1bGVzX2VuZ2luZTogZXh0cmFjdGVkLnJ1bGVzX2VuZ2luZSB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuV29ya2Zsb3czUnVsZXMoXG4gIGlucHV0OiBSdW5Xb3JrZmxvdzNJbnB1dCxcbik6IFByb21pc2U8UnVuV29ya2Zsb3czUmVzdWx0PiB7XG4gIGNvbnN0IGludGFrZSA9IGF3YWl0IGxvYWRJbnRha2UoaW5wdXQuaW50YWtlX2lkKTtcbiAgaWYgKGlucHV0LmZpcm1faWQgJiYgaW5wdXQuZmlybV9pZCAhPT0gaW50YWtlLmZpcm1faWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGFrZSBmaXJtIG1pc21hdGNoJyk7XG4gIH1cblxuICBpZiAoIWludGFrZS5zdWJtaXR0ZWRfYXQgJiYgaW50YWtlLnN0YXR1cyAhPT0gJ3N1Ym1pdHRlZCcpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGFrZSBpcyBub3Qgc3VibWl0dGVkJyk7XG4gIH1cblxuICBjb25zdCB7IGNhdGFsb2csIHJ1bGVzZXRfdmVyc2lvbiB9ID0gZ2V0UnVsZUNhdGFsb2coKTtcblxuICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGZpbmRFeGlzdGluZ0V2YWx1YXRpb24oaW50YWtlLmlkLCBydWxlc2V0X3ZlcnNpb24pO1xuICBpZiAoZXhpc3RpbmcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXZhbHVhdGlvbjogZXhpc3RpbmcucnVsZXNfZW5naW5lLFxuICAgICAgcnVsZXNldF92ZXJzaW9uLFxuICAgICAgd3JpdHRlbjogZmFsc2UsXG4gICAgICBleHRyYWN0aW9uX2lkOiBleGlzdGluZy5pZCxcbiAgICAgIHZlcnNpb246IGV4aXN0aW5nLnZlcnNpb24sXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHBheWxvYWQgPSBpc1BsYWluT2JqZWN0KGludGFrZS5yYXdfcGF5bG9hZCkgPyBpbnRha2UucmF3X3BheWxvYWQgOiB7fTtcbiAgY29uc3QgY291bnRpZXMgPSBsb2FkR2FDb3VudGllcygpO1xuICBjb25zdCBldmFsdWF0aW9uID0gZXZhbHVhdGVSdWxlcyhwYXlsb2FkLCBjYXRhbG9nLCBjb3VudGllcyk7XG5cbiAgY29uc3QgaW5zZXJ0ZWQgPSBhd2FpdCB3cml0ZVJ1bGVzRXZhbHVhdGlvbihpbnRha2UuaWQsIGV2YWx1YXRpb24pO1xuXG4gIGNvbnNvbGUuaW5mbyhgW3dmM10gaW50YWtlX2lkPSR7aW50YWtlLmlkfSBydWxlc2V0PSR7cnVsZXNldF92ZXJzaW9ufSB2ZXJzaW9uPSR7aW5zZXJ0ZWQudmVyc2lvbn1gKTtcblxuICByZXR1cm4ge1xuICAgIGV2YWx1YXRpb24sXG4gICAgcnVsZXNldF92ZXJzaW9uLFxuICAgIHdyaXR0ZW46IHRydWUsXG4gICAgZXh0cmFjdGlvbl9pZDogaW5zZXJ0ZWQuaWQsXG4gICAgdmVyc2lvbjogaW5zZXJ0ZWQudmVyc2lvbixcbiAgfTtcbn1cbiJdLCJuYW1lcyI6WyJzdXBhYmFzZUFkbWluIiwibG9hZEdhQ291bnRpZXMiLCJnZXRSdWxlQ2F0YWxvZyIsImV2YWx1YXRlUnVsZXMiLCJ3cml0ZVJ1bGVzRXZhbHVhdGlvbiIsImlzUGxhaW5PYmplY3QiLCJ2YWx1ZSIsIkJvb2xlYW4iLCJBcnJheSIsImlzQXJyYXkiLCJsb2FkSW50YWtlIiwiaW50YWtlSWQiLCJkYXRhIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJtYXliZVNpbmdsZSIsIkVycm9yIiwiZmluZEV4aXN0aW5nRXZhbHVhdGlvbiIsInJ1bGVzZXRWZXJzaW9uIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsImV4dHJhY3RlZCIsImV4dHJhY3RlZF9kYXRhIiwicnVsZXNfZW5naW5lIiwicnVuV29ya2Zsb3czUnVsZXMiLCJpbnB1dCIsImludGFrZSIsImludGFrZV9pZCIsImZpcm1faWQiLCJzdWJtaXR0ZWRfYXQiLCJzdGF0dXMiLCJjYXRhbG9nIiwicnVsZXNldF92ZXJzaW9uIiwiZXhpc3RpbmciLCJpZCIsImV2YWx1YXRpb24iLCJ3cml0dGVuIiwiZXh0cmFjdGlvbl9pZCIsInZlcnNpb24iLCJwYXlsb2FkIiwicmF3X3BheWxvYWQiLCJjb3VudGllcyIsImluc2VydGVkIiwiY29uc29sZSIsImluZm8iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/runWorkflow3Rules.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflow3/storage/writeRulesEvaluation.ts":
/*!***********************************************************!*\
  !*** ../../src/workflow3/storage/writeRulesEvaluation.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getNextExtractionVersion: () => (/* binding */ getNextExtractionVersion),\n/* harmony export */   writeRulesEvaluation: () => (/* binding */ writeRulesEvaluation)\n/* harmony export */ });\n/* harmony import */ var _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/server/supabaseAdmin */ \"(api-node)/../../lib/server/supabaseAdmin.ts\");\n\nconst DEFAULT_SCHEMA_VERSION = 'ga_divorce_custody_v1';\nasync function getIntakeMeta(intakeId) {\n    const { data, error } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intakes').select('id, firm_id, submitted_at, status').eq('id', intakeId).maybeSingle();\n    if (error) {\n        throw new Error('Unable to load intake metadata');\n    }\n    if (!data) {\n        throw new Error('Intake not found');\n    }\n    if (!data.submitted_at) {\n        throw new Error('Intake is not submitted');\n    }\n    return data;\n}\nasync function getNextExtractionVersion(intakeId) {\n    const { data, error } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intake_extractions').select('version').eq('intake_id', intakeId).order('version', {\n        ascending: false\n    }).limit(1);\n    if (error) {\n        throw new Error('Unable to determine extraction version');\n    }\n    const current = data && data.length > 0 ? data[0]?.version : null;\n    if (typeof current === 'number') {\n        return current + 1;\n    }\n    return 1;\n}\nasync function writeRulesEvaluation(intakeId, rulesOutput, options = {}) {\n    const intake = await getIntakeMeta(intakeId);\n    const version = await getNextExtractionVersion(intakeId);\n    const schemaVersion = options.schemaVersion ?? DEFAULT_SCHEMA_VERSION;\n    const payload = {\n        intake_id: intakeId,\n        firm_id: intake.firm_id,\n        version,\n        schema_version: schemaVersion,\n        extracted_data: {\n            rules_engine: rulesOutput\n        }\n    };\n    const { data, error } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intake_extractions').insert(payload).select('id, intake_id, version, schema_version, created_at').single();\n    if (error || !data) {\n        throw new Error('Unable to write rules evaluation');\n    }\n    return data;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3czL3N0b3JhZ2Uvd3JpdGVSdWxlc0V2YWx1YXRpb24udHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQWtFO0FBSWxFLE1BQU1DLHlCQUF5QjtBQUUvQixlQUFlQyxjQUFjQyxRQUFnQjtJQUMzQyxNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUwsb0VBQWFBLENBQ3hDTSxJQUFJLENBQUMsV0FDTEMsTUFBTSxDQUFDLHFDQUNQQyxFQUFFLENBQUMsTUFBTUwsVUFDVE0sV0FBVztJQUVkLElBQUlKLE9BQU87UUFDVCxNQUFNLElBQUlLLE1BQU07SUFDbEI7SUFDQSxJQUFJLENBQUNOLE1BQU07UUFDVCxNQUFNLElBQUlNLE1BQU07SUFDbEI7SUFDQSxJQUFJLENBQUNOLEtBQUtPLFlBQVksRUFBRTtRQUN0QixNQUFNLElBQUlELE1BQU07SUFDbEI7SUFFQSxPQUFPTjtBQUNUO0FBRU8sZUFBZVEseUJBQXlCVCxRQUFnQjtJQUM3RCxNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUwsb0VBQWFBLENBQ3hDTSxJQUFJLENBQUMsc0JBQ0xDLE1BQU0sQ0FBQyxXQUNQQyxFQUFFLENBQUMsYUFBYUwsVUFDaEJVLEtBQUssQ0FBQyxXQUFXO1FBQUVDLFdBQVc7SUFBTSxHQUNwQ0MsS0FBSyxDQUFDO0lBRVQsSUFBSVYsT0FBTztRQUNULE1BQU0sSUFBSUssTUFBTTtJQUNsQjtJQUVBLE1BQU1NLFVBQVVaLFFBQVFBLEtBQUthLE1BQU0sR0FBRyxJQUFJYixJQUFJLENBQUMsRUFBRSxFQUFFYyxVQUFVO0lBQzdELElBQUksT0FBT0YsWUFBWSxVQUFVO1FBQy9CLE9BQU9BLFVBQVU7SUFDbkI7SUFDQSxPQUFPO0FBQ1Q7QUFFTyxlQUFlRyxxQkFDcEJoQixRQUFnQixFQUNoQmlCLFdBQThCLEVBQzlCQyxVQUF1QyxDQUFDLENBQUM7SUFFekMsTUFBTUMsU0FBUyxNQUFNcEIsY0FBY0M7SUFDbkMsTUFBTWUsVUFBVSxNQUFNTix5QkFBeUJUO0lBQy9DLE1BQU1vQixnQkFBZ0JGLFFBQVFFLGFBQWEsSUFBSXRCO0lBRS9DLE1BQU11QixVQUFrQztRQUN0Q0MsV0FBV3RCO1FBQ1h1QixTQUFTSixPQUFPSSxPQUFPO1FBQ3ZCUjtRQUNBUyxnQkFBZ0JKO1FBQ2hCSyxnQkFBZ0I7WUFDZEMsY0FBY1Q7UUFDaEI7SUFDRjtJQUVBLE1BQU0sRUFBRWhCLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUwsb0VBQWFBLENBQ3hDTSxJQUFJLENBQUMsc0JBQ0x3QixNQUFNLENBQUNOLFNBQ1BqQixNQUFNLENBQUMsc0RBQ1B3QixNQUFNO0lBRVQsSUFBSTFCLFNBQVMsQ0FBQ0QsTUFBTTtRQUNsQixNQUFNLElBQUlNLE1BQU07SUFDbEI7SUFFQSxPQUFPTjtBQUNUIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL3NyYy93b3JrZmxvdzMvc3RvcmFnZS93cml0ZVJ1bGVzRXZhbHVhdGlvbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZUFkbWluIH0gZnJvbSAnLi4vLi4vLi4vbGliL3NlcnZlci9zdXBhYmFzZUFkbWluJztcbmltcG9ydCB0eXBlIHsgUnVsZXNFbmdpbmVSZXN1bHQgfSBmcm9tICcuLi9ldmFsdWF0b3IvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBJbnRha2VFeHRyYWN0aW9uSW5zZXJ0LCBXcml0ZVJ1bGVzRXZhbHVhdGlvbk9wdGlvbnMsIFdyaXRlUnVsZXNFdmFsdWF0aW9uUmVzdWx0IH0gZnJvbSAnLi90eXBlcyc7XG5cbmNvbnN0IERFRkFVTFRfU0NIRU1BX1ZFUlNJT04gPSAnZ2FfZGl2b3JjZV9jdXN0b2R5X3YxJztcblxuYXN5bmMgZnVuY3Rpb24gZ2V0SW50YWtlTWV0YShpbnRha2VJZDogc3RyaW5nKSB7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnaW50YWtlcycpXG4gICAgLnNlbGVjdCgnaWQsIGZpcm1faWQsIHN1Ym1pdHRlZF9hdCwgc3RhdHVzJylcbiAgICAuZXEoJ2lkJywgaW50YWtlSWQpXG4gICAgLm1heWJlU2luZ2xlKCk7XG5cbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gbG9hZCBpbnRha2UgbWV0YWRhdGEnKTtcbiAgfVxuICBpZiAoIWRhdGEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGFrZSBub3QgZm91bmQnKTtcbiAgfVxuICBpZiAoIWRhdGEuc3VibWl0dGVkX2F0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnRha2UgaXMgbm90IHN1Ym1pdHRlZCcpO1xuICB9XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXROZXh0RXh0cmFjdGlvblZlcnNpb24oaW50YWtlSWQ6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnaW50YWtlX2V4dHJhY3Rpb25zJylcbiAgICAuc2VsZWN0KCd2ZXJzaW9uJylcbiAgICAuZXEoJ2ludGFrZV9pZCcsIGludGFrZUlkKVxuICAgIC5vcmRlcigndmVyc2lvbicsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgIC5saW1pdCgxKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBkZXRlcm1pbmUgZXh0cmFjdGlvbiB2ZXJzaW9uJyk7XG4gIH1cblxuICBjb25zdCBjdXJyZW50ID0gZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDAgPyBkYXRhWzBdPy52ZXJzaW9uIDogbnVsbDtcbiAgaWYgKHR5cGVvZiBjdXJyZW50ID09PSAnbnVtYmVyJykge1xuICAgIHJldHVybiBjdXJyZW50ICsgMTtcbiAgfVxuICByZXR1cm4gMTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdyaXRlUnVsZXNFdmFsdWF0aW9uKFxuICBpbnRha2VJZDogc3RyaW5nLFxuICBydWxlc091dHB1dDogUnVsZXNFbmdpbmVSZXN1bHQsXG4gIG9wdGlvbnM6IFdyaXRlUnVsZXNFdmFsdWF0aW9uT3B0aW9ucyA9IHt9LFxuKTogUHJvbWlzZTxXcml0ZVJ1bGVzRXZhbHVhdGlvblJlc3VsdD4ge1xuICBjb25zdCBpbnRha2UgPSBhd2FpdCBnZXRJbnRha2VNZXRhKGludGFrZUlkKTtcbiAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGdldE5leHRFeHRyYWN0aW9uVmVyc2lvbihpbnRha2VJZCk7XG4gIGNvbnN0IHNjaGVtYVZlcnNpb24gPSBvcHRpb25zLnNjaGVtYVZlcnNpb24gPz8gREVGQVVMVF9TQ0hFTUFfVkVSU0lPTjtcblxuICBjb25zdCBwYXlsb2FkOiBJbnRha2VFeHRyYWN0aW9uSW5zZXJ0ID0ge1xuICAgIGludGFrZV9pZDogaW50YWtlSWQsXG4gICAgZmlybV9pZDogaW50YWtlLmZpcm1faWQsXG4gICAgdmVyc2lvbixcbiAgICBzY2hlbWFfdmVyc2lvbjogc2NoZW1hVmVyc2lvbixcbiAgICBleHRyYWN0ZWRfZGF0YToge1xuICAgICAgcnVsZXNfZW5naW5lOiBydWxlc091dHB1dCxcbiAgICB9LFxuICB9O1xuXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnaW50YWtlX2V4dHJhY3Rpb25zJylcbiAgICAuaW5zZXJ0KHBheWxvYWQpXG4gICAgLnNlbGVjdCgnaWQsIGludGFrZV9pZCwgdmVyc2lvbiwgc2NoZW1hX3ZlcnNpb24sIGNyZWF0ZWRfYXQnKVxuICAgIC5zaW5nbGUoKTtcblxuICBpZiAoZXJyb3IgfHwgIWRhdGEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byB3cml0ZSBydWxlcyBldmFsdWF0aW9uJyk7XG4gIH1cblxuICByZXR1cm4gZGF0YTtcbn1cbiJdLCJuYW1lcyI6WyJzdXBhYmFzZUFkbWluIiwiREVGQVVMVF9TQ0hFTUFfVkVSU0lPTiIsImdldEludGFrZU1ldGEiLCJpbnRha2VJZCIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsIm1heWJlU2luZ2xlIiwiRXJyb3IiLCJzdWJtaXR0ZWRfYXQiLCJnZXROZXh0RXh0cmFjdGlvblZlcnNpb24iLCJvcmRlciIsImFzY2VuZGluZyIsImxpbWl0IiwiY3VycmVudCIsImxlbmd0aCIsInZlcnNpb24iLCJ3cml0ZVJ1bGVzRXZhbHVhdGlvbiIsInJ1bGVzT3V0cHV0Iiwib3B0aW9ucyIsImludGFrZSIsInNjaGVtYVZlcnNpb24iLCJwYXlsb2FkIiwiaW50YWtlX2lkIiwiZmlybV9pZCIsInNjaGVtYV92ZXJzaW9uIiwiZXh0cmFjdGVkX2RhdGEiLCJydWxlc19lbmdpbmUiLCJpbnNlcnQiLCJzaW5nbGUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflow3/storage/writeRulesEvaluation.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflows/wf4/counties.ts":
/*!*******************************************!*\
  !*** ../../src/workflows/wf4/counties.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isCanonicalCounty: () => (/* binding */ isCanonicalCounty),\n/* harmony export */   loadWf4Counties: () => (/* binding */ loadWf4Counties),\n/* harmony export */   matchCountyMention: () => (/* binding */ matchCountyMention)\n/* harmony export */ });\n/* harmony import */ var _workflow3_counties_gaCountiesLoader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../workflow3/counties/gaCountiesLoader */ \"(api-node)/../../src/workflow3/counties/gaCountiesLoader.ts\");\n\nfunction normalizeCountyInput(value) {\n    return value.toLowerCase().replace(/\\bcounty\\b/g, '').replace(/[^a-z0-9\\s-]/g, '').replace(/\\s+/g, ' ').trim();\n}\nfunction loadWf4Counties() {\n    const { rows } = (0,_workflow3_counties_gaCountiesLoader__WEBPACK_IMPORTED_MODULE_0__.loadGaCounties)();\n    const canonicalList = [];\n    const byName = new Map();\n    const bySlug = new Map();\n    rows.forEach((row)=>{\n        const canonical = row.slug ?? row.name;\n        canonicalList.push(canonical);\n        const nameKey = normalizeCountyInput(row.name);\n        if (nameKey) {\n            byName.set(nameKey, canonical);\n        }\n        if (row.slug) {\n            const slugKey = normalizeCountyInput(row.slug);\n            if (slugKey) {\n                bySlug.set(slugKey, canonical);\n            }\n        }\n    });\n    return {\n        canonicalList,\n        byName,\n        bySlug\n    };\n}\nfunction matchCountyMention(rawValue, lookup) {\n    if (!rawValue || typeof rawValue !== 'string') {\n        return {\n            suggested_county: null,\n            match_type: 'NONE'\n        };\n    }\n    const normalized = normalizeCountyInput(rawValue);\n    if (!normalized) {\n        return {\n            suggested_county: null,\n            match_type: 'NONE'\n        };\n    }\n    const exactName = lookup.byName.get(normalized);\n    if (exactName) {\n        return {\n            suggested_county: exactName,\n            match_type: 'EXACT'\n        };\n    }\n    const exactSlug = lookup.bySlug.get(normalized);\n    if (exactSlug) {\n        return {\n            suggested_county: exactSlug,\n            match_type: 'EXACT'\n        };\n    }\n    const candidates = new Set();\n    for (const [key, value] of lookup.byName.entries()){\n        if (key.startsWith(normalized)) {\n            candidates.add(value);\n        }\n    }\n    for (const [key, value] of lookup.bySlug.entries()){\n        if (key.startsWith(normalized)) {\n            candidates.add(value);\n        }\n    }\n    if (candidates.size === 1) {\n        return {\n            suggested_county: Array.from(candidates)[0],\n            match_type: 'FUZZY'\n        };\n    }\n    return {\n        suggested_county: null,\n        match_type: 'NONE'\n    };\n}\nfunction isCanonicalCounty(value, lookup) {\n    return lookup.canonicalList.includes(value);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3dzL3dmNC9jb3VudGllcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJFO0FBUTNFLFNBQVNDLHFCQUFxQkMsS0FBYTtJQUN6QyxPQUFPQSxNQUNKQyxXQUFXLEdBQ1hDLE9BQU8sQ0FBQyxlQUFlLElBQ3ZCQSxPQUFPLENBQUMsaUJBQWlCLElBQ3pCQSxPQUFPLENBQUMsUUFBUSxLQUNoQkMsSUFBSTtBQUNUO0FBRU8sU0FBU0M7SUFDZCxNQUFNLEVBQUVDLElBQUksRUFBRSxHQUFHUCxvRkFBY0E7SUFDL0IsTUFBTVEsZ0JBQTBCLEVBQUU7SUFDbEMsTUFBTUMsU0FBUyxJQUFJQztJQUNuQixNQUFNQyxTQUFTLElBQUlEO0lBRW5CSCxLQUFLSyxPQUFPLENBQUMsQ0FBQ0M7UUFDWixNQUFNQyxZQUFZRCxJQUFJRSxJQUFJLElBQUlGLElBQUlHLElBQUk7UUFDdENSLGNBQWNTLElBQUksQ0FBQ0g7UUFFbkIsTUFBTUksVUFBVWpCLHFCQUFxQlksSUFBSUcsSUFBSTtRQUM3QyxJQUFJRSxTQUFTO1lBQ1hULE9BQU9VLEdBQUcsQ0FBQ0QsU0FBU0o7UUFDdEI7UUFFQSxJQUFJRCxJQUFJRSxJQUFJLEVBQUU7WUFDWixNQUFNSyxVQUFVbkIscUJBQXFCWSxJQUFJRSxJQUFJO1lBQzdDLElBQUlLLFNBQVM7Z0JBQ1hULE9BQU9RLEdBQUcsQ0FBQ0MsU0FBU047WUFDdEI7UUFDRjtJQUNGO0lBRUEsT0FBTztRQUFFTjtRQUFlQztRQUFRRTtJQUFPO0FBQ3pDO0FBRU8sU0FBU1UsbUJBQ2RDLFFBQW1DLEVBQ25DQyxNQUFvQjtJQUVwQixJQUFJLENBQUNELFlBQVksT0FBT0EsYUFBYSxVQUFVO1FBQzdDLE9BQU87WUFBRUUsa0JBQWtCO1lBQU1DLFlBQVk7UUFBTztJQUN0RDtJQUVBLE1BQU1DLGFBQWF6QixxQkFBcUJxQjtJQUN4QyxJQUFJLENBQUNJLFlBQVk7UUFDZixPQUFPO1lBQUVGLGtCQUFrQjtZQUFNQyxZQUFZO1FBQU87SUFDdEQ7SUFFQSxNQUFNRSxZQUFZSixPQUFPZCxNQUFNLENBQUNtQixHQUFHLENBQUNGO0lBQ3BDLElBQUlDLFdBQVc7UUFDYixPQUFPO1lBQUVILGtCQUFrQkc7WUFBV0YsWUFBWTtRQUFRO0lBQzVEO0lBRUEsTUFBTUksWUFBWU4sT0FBT1osTUFBTSxDQUFDaUIsR0FBRyxDQUFDRjtJQUNwQyxJQUFJRyxXQUFXO1FBQ2IsT0FBTztZQUFFTCxrQkFBa0JLO1lBQVdKLFlBQVk7UUFBUTtJQUM1RDtJQUVBLE1BQU1LLGFBQWEsSUFBSUM7SUFDdkIsS0FBSyxNQUFNLENBQUNDLEtBQUs5QixNQUFNLElBQUlxQixPQUFPZCxNQUFNLENBQUN3QixPQUFPLEdBQUk7UUFDbEQsSUFBSUQsSUFBSUUsVUFBVSxDQUFDUixhQUFhO1lBQzlCSSxXQUFXSyxHQUFHLENBQUNqQztRQUNqQjtJQUNGO0lBQ0EsS0FBSyxNQUFNLENBQUM4QixLQUFLOUIsTUFBTSxJQUFJcUIsT0FBT1osTUFBTSxDQUFDc0IsT0FBTyxHQUFJO1FBQ2xELElBQUlELElBQUlFLFVBQVUsQ0FBQ1IsYUFBYTtZQUM5QkksV0FBV0ssR0FBRyxDQUFDakM7UUFDakI7SUFDRjtJQUVBLElBQUk0QixXQUFXTSxJQUFJLEtBQUssR0FBRztRQUN6QixPQUFPO1lBQUVaLGtCQUFrQmEsTUFBTUMsSUFBSSxDQUFDUixXQUFXLENBQUMsRUFBRTtZQUFFTCxZQUFZO1FBQVE7SUFDNUU7SUFFQSxPQUFPO1FBQUVELGtCQUFrQjtRQUFNQyxZQUFZO0lBQU87QUFDdEQ7QUFFTyxTQUFTYyxrQkFBa0JyQyxLQUFhLEVBQUVxQixNQUFvQjtJQUNuRSxPQUFPQSxPQUFPZixhQUFhLENBQUNnQyxRQUFRLENBQUN0QztBQUN2QyIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9zcmMvd29ya2Zsb3dzL3dmNC9jb3VudGllcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBsb2FkR2FDb3VudGllcyB9IGZyb20gJy4uLy4uL3dvcmtmbG93My9jb3VudGllcy9nYUNvdW50aWVzTG9hZGVyJztcblxudHlwZSBDb3VudHlMb29rdXAgPSB7XG4gIGNhbm9uaWNhbExpc3Q6IHN0cmluZ1tdO1xuICBieU5hbWU6IE1hcDxzdHJpbmcsIHN0cmluZz47XG4gIGJ5U2x1ZzogTWFwPHN0cmluZywgc3RyaW5nPjtcbn07XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZUNvdW50eUlucHV0KHZhbHVlOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHZhbHVlXG4gICAgLnRvTG93ZXJDYXNlKClcbiAgICAucmVwbGFjZSgvXFxiY291bnR5XFxiL2csICcnKVxuICAgIC5yZXBsYWNlKC9bXmEtejAtOVxccy1dL2csICcnKVxuICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJylcbiAgICAudHJpbSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9hZFdmNENvdW50aWVzKCk6IENvdW50eUxvb2t1cCB7XG4gIGNvbnN0IHsgcm93cyB9ID0gbG9hZEdhQ291bnRpZXMoKTtcbiAgY29uc3QgY2Fub25pY2FsTGlzdDogc3RyaW5nW10gPSBbXTtcbiAgY29uc3QgYnlOYW1lID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcbiAgY29uc3QgYnlTbHVnID0gbmV3IE1hcDxzdHJpbmcsIHN0cmluZz4oKTtcblxuICByb3dzLmZvckVhY2goKHJvdykgPT4ge1xuICAgIGNvbnN0IGNhbm9uaWNhbCA9IHJvdy5zbHVnID8/IHJvdy5uYW1lO1xuICAgIGNhbm9uaWNhbExpc3QucHVzaChjYW5vbmljYWwpO1xuXG4gICAgY29uc3QgbmFtZUtleSA9IG5vcm1hbGl6ZUNvdW50eUlucHV0KHJvdy5uYW1lKTtcbiAgICBpZiAobmFtZUtleSkge1xuICAgICAgYnlOYW1lLnNldChuYW1lS2V5LCBjYW5vbmljYWwpO1xuICAgIH1cblxuICAgIGlmIChyb3cuc2x1Zykge1xuICAgICAgY29uc3Qgc2x1Z0tleSA9IG5vcm1hbGl6ZUNvdW50eUlucHV0KHJvdy5zbHVnKTtcbiAgICAgIGlmIChzbHVnS2V5KSB7XG4gICAgICAgIGJ5U2x1Zy5zZXQoc2x1Z0tleSwgY2Fub25pY2FsKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7IGNhbm9uaWNhbExpc3QsIGJ5TmFtZSwgYnlTbHVnIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXRjaENvdW50eU1lbnRpb24oXG4gIHJhd1ZhbHVlOiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkLFxuICBsb29rdXA6IENvdW50eUxvb2t1cCxcbik6IHsgc3VnZ2VzdGVkX2NvdW50eTogc3RyaW5nIHwgbnVsbDsgbWF0Y2hfdHlwZTogJ0VYQUNUJyB8ICdGVVpaWScgfCAnTk9ORScgfSB7XG4gIGlmICghcmF3VmFsdWUgfHwgdHlwZW9mIHJhd1ZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB7IHN1Z2dlc3RlZF9jb3VudHk6IG51bGwsIG1hdGNoX3R5cGU6ICdOT05FJyB9O1xuICB9XG5cbiAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZUNvdW50eUlucHV0KHJhd1ZhbHVlKTtcbiAgaWYgKCFub3JtYWxpemVkKSB7XG4gICAgcmV0dXJuIHsgc3VnZ2VzdGVkX2NvdW50eTogbnVsbCwgbWF0Y2hfdHlwZTogJ05PTkUnIH07XG4gIH1cblxuICBjb25zdCBleGFjdE5hbWUgPSBsb29rdXAuYnlOYW1lLmdldChub3JtYWxpemVkKTtcbiAgaWYgKGV4YWN0TmFtZSkge1xuICAgIHJldHVybiB7IHN1Z2dlc3RlZF9jb3VudHk6IGV4YWN0TmFtZSwgbWF0Y2hfdHlwZTogJ0VYQUNUJyB9O1xuICB9XG5cbiAgY29uc3QgZXhhY3RTbHVnID0gbG9va3VwLmJ5U2x1Zy5nZXQobm9ybWFsaXplZCk7XG4gIGlmIChleGFjdFNsdWcpIHtcbiAgICByZXR1cm4geyBzdWdnZXN0ZWRfY291bnR5OiBleGFjdFNsdWcsIG1hdGNoX3R5cGU6ICdFWEFDVCcgfTtcbiAgfVxuXG4gIGNvbnN0IGNhbmRpZGF0ZXMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgbG9va3VwLmJ5TmFtZS5lbnRyaWVzKCkpIHtcbiAgICBpZiAoa2V5LnN0YXJ0c1dpdGgobm9ybWFsaXplZCkpIHtcbiAgICAgIGNhbmRpZGF0ZXMuYWRkKHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgbG9va3VwLmJ5U2x1Zy5lbnRyaWVzKCkpIHtcbiAgICBpZiAoa2V5LnN0YXJ0c1dpdGgobm9ybWFsaXplZCkpIHtcbiAgICAgIGNhbmRpZGF0ZXMuYWRkKHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBpZiAoY2FuZGlkYXRlcy5zaXplID09PSAxKSB7XG4gICAgcmV0dXJuIHsgc3VnZ2VzdGVkX2NvdW50eTogQXJyYXkuZnJvbShjYW5kaWRhdGVzKVswXSwgbWF0Y2hfdHlwZTogJ0ZVWlpZJyB9O1xuICB9XG5cbiAgcmV0dXJuIHsgc3VnZ2VzdGVkX2NvdW50eTogbnVsbCwgbWF0Y2hfdHlwZTogJ05PTkUnIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Nhbm9uaWNhbENvdW50eSh2YWx1ZTogc3RyaW5nLCBsb29rdXA6IENvdW50eUxvb2t1cCkge1xuICByZXR1cm4gbG9va3VwLmNhbm9uaWNhbExpc3QuaW5jbHVkZXModmFsdWUpO1xufVxuIl0sIm5hbWVzIjpbImxvYWRHYUNvdW50aWVzIiwibm9ybWFsaXplQ291bnR5SW5wdXQiLCJ2YWx1ZSIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsInRyaW0iLCJsb2FkV2Y0Q291bnRpZXMiLCJyb3dzIiwiY2Fub25pY2FsTGlzdCIsImJ5TmFtZSIsIk1hcCIsImJ5U2x1ZyIsImZvckVhY2giLCJyb3ciLCJjYW5vbmljYWwiLCJzbHVnIiwibmFtZSIsInB1c2giLCJuYW1lS2V5Iiwic2V0Iiwic2x1Z0tleSIsIm1hdGNoQ291bnR5TWVudGlvbiIsInJhd1ZhbHVlIiwibG9va3VwIiwic3VnZ2VzdGVkX2NvdW50eSIsIm1hdGNoX3R5cGUiLCJub3JtYWxpemVkIiwiZXhhY3ROYW1lIiwiZ2V0IiwiZXhhY3RTbHVnIiwiY2FuZGlkYXRlcyIsIlNldCIsImtleSIsImVudHJpZXMiLCJzdGFydHNXaXRoIiwiYWRkIiwic2l6ZSIsIkFycmF5IiwiZnJvbSIsImlzQ2Fub25pY2FsQ291bnR5IiwiaW5jbHVkZXMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflows/wf4/counties.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflows/wf4/evidence.ts":
/*!*******************************************!*\
  !*** ../../src/workflows/wf4/evidence.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   boundEvidenceSnippet: () => (/* binding */ boundEvidenceSnippet),\n/* harmony export */   documentPointer: () => (/* binding */ documentPointer),\n/* harmony export */   fieldPointer: () => (/* binding */ fieldPointer),\n/* harmony export */   messagePointer: () => (/* binding */ messagePointer),\n/* harmony export */   validateEvidencePointers: () => (/* binding */ validateEvidencePointers),\n/* harmony export */   wf3Pointer: () => (/* binding */ wf3Pointer)\n/* harmony export */ });\nconst MAX_SNIPPET_LENGTH = 200;\nfunction boundSnippet(snippet) {\n    if (!snippet) return undefined;\n    if (snippet.length <= MAX_SNIPPET_LENGTH) return snippet;\n    return snippet.slice(0, MAX_SNIPPET_LENGTH);\n}\nfunction fieldPointer(sourceId, pathOrSpan, snippet) {\n    return {\n        source_type: 'field',\n        source_id: sourceId,\n        path_or_span: pathOrSpan,\n        snippet: boundSnippet(snippet)\n    };\n}\nfunction messagePointer(sourceId, pathOrSpan, snippet) {\n    return {\n        source_type: 'message',\n        source_id: sourceId,\n        path_or_span: pathOrSpan,\n        snippet: boundSnippet(snippet)\n    };\n}\nfunction documentPointer(sourceId, pathOrSpan, snippet) {\n    return {\n        source_type: 'document',\n        source_id: sourceId,\n        path_or_span: pathOrSpan,\n        snippet: boundSnippet(snippet)\n    };\n}\nfunction wf3Pointer(sourceId, pathOrSpan, snippet) {\n    return {\n        source_type: 'wf3',\n        source_id: sourceId,\n        path_or_span: pathOrSpan,\n        snippet: boundSnippet(snippet)\n    };\n}\nfunction validateEvidencePointers(evidence) {\n    if (!Array.isArray(evidence)) {\n        return {\n            ok: false,\n            error: 'evidence must be an array'\n        };\n    }\n    for (const pointer of evidence){\n        if (!pointer || typeof pointer !== 'object') {\n            return {\n                ok: false,\n                error: 'evidence pointer must be object'\n            };\n        }\n        if (pointer.source_type !== 'field' && pointer.source_type !== 'message' && pointer.source_type !== 'document' && pointer.source_type !== 'wf3') {\n            return {\n                ok: false,\n                error: 'evidence source_type invalid'\n            };\n        }\n        if (typeof pointer.source_id !== 'string' || pointer.source_id.length === 0) {\n            return {\n                ok: false,\n                error: 'evidence source_id missing'\n            };\n        }\n        if (typeof pointer.path_or_span !== 'string' || pointer.path_or_span.length === 0) {\n            return {\n                ok: false,\n                error: 'evidence path_or_span missing'\n            };\n        }\n        if (pointer.snippet !== undefined && typeof pointer.snippet !== 'string') {\n            return {\n                ok: false,\n                error: 'evidence snippet must be string'\n            };\n        }\n        if (pointer.snippet && pointer.snippet.length > MAX_SNIPPET_LENGTH) {\n            return {\n                ok: false,\n                error: 'evidence snippet too long'\n            };\n        }\n    }\n    return {\n        ok: true\n    };\n}\nfunction boundEvidenceSnippet(evidence) {\n    return evidence.map((pointer)=>({\n            ...pointer,\n            snippet: boundSnippet(pointer.snippet)\n        }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3dzL3dmNC9ldmlkZW5jZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFFQSxNQUFNQSxxQkFBcUI7QUFFM0IsU0FBU0MsYUFBYUMsT0FBZ0I7SUFDcEMsSUFBSSxDQUFDQSxTQUFTLE9BQU9DO0lBQ3JCLElBQUlELFFBQVFFLE1BQU0sSUFBSUosb0JBQW9CLE9BQU9FO0lBQ2pELE9BQU9BLFFBQVFHLEtBQUssQ0FBQyxHQUFHTDtBQUMxQjtBQUVPLFNBQVNNLGFBQ2RDLFFBQWdCLEVBQ2hCQyxVQUFrQixFQUNsQk4sT0FBZ0I7SUFFaEIsT0FBTztRQUNMTyxhQUFhO1FBQ2JDLFdBQVdIO1FBQ1hJLGNBQWNIO1FBQ2ROLFNBQVNELGFBQWFDO0lBQ3hCO0FBQ0Y7QUFFTyxTQUFTVSxlQUNkTCxRQUFnQixFQUNoQkMsVUFBa0IsRUFDbEJOLE9BQWdCO0lBRWhCLE9BQU87UUFDTE8sYUFBYTtRQUNiQyxXQUFXSDtRQUNYSSxjQUFjSDtRQUNkTixTQUFTRCxhQUFhQztJQUN4QjtBQUNGO0FBRU8sU0FBU1csZ0JBQ2ROLFFBQWdCLEVBQ2hCQyxVQUFrQixFQUNsQk4sT0FBZ0I7SUFFaEIsT0FBTztRQUNMTyxhQUFhO1FBQ2JDLFdBQVdIO1FBQ1hJLGNBQWNIO1FBQ2ROLFNBQVNELGFBQWFDO0lBQ3hCO0FBQ0Y7QUFFTyxTQUFTWSxXQUNkUCxRQUFnQixFQUNoQkMsVUFBa0IsRUFDbEJOLE9BQWdCO0lBRWhCLE9BQU87UUFDTE8sYUFBYTtRQUNiQyxXQUFXSDtRQUNYSSxjQUFjSDtRQUNkTixTQUFTRCxhQUFhQztJQUN4QjtBQUNGO0FBRU8sU0FBU2EseUJBQ2RDLFFBQTJCO0lBRTNCLElBQUksQ0FBQ0MsTUFBTUMsT0FBTyxDQUFDRixXQUFXO1FBQzVCLE9BQU87WUFBRUcsSUFBSTtZQUFPQyxPQUFPO1FBQTRCO0lBQ3pEO0lBRUEsS0FBSyxNQUFNQyxXQUFXTCxTQUFVO1FBQzlCLElBQUksQ0FBQ0ssV0FBVyxPQUFPQSxZQUFZLFVBQVU7WUFDM0MsT0FBTztnQkFBRUYsSUFBSTtnQkFBT0MsT0FBTztZQUFrQztRQUMvRDtRQUNBLElBQ0VDLFFBQVFaLFdBQVcsS0FBSyxXQUN4QlksUUFBUVosV0FBVyxLQUFLLGFBQ3hCWSxRQUFRWixXQUFXLEtBQUssY0FDeEJZLFFBQVFaLFdBQVcsS0FBSyxPQUN4QjtZQUNBLE9BQU87Z0JBQUVVLElBQUk7Z0JBQU9DLE9BQU87WUFBK0I7UUFDNUQ7UUFDQSxJQUFJLE9BQU9DLFFBQVFYLFNBQVMsS0FBSyxZQUFZVyxRQUFRWCxTQUFTLENBQUNOLE1BQU0sS0FBSyxHQUFHO1lBQzNFLE9BQU87Z0JBQUVlLElBQUk7Z0JBQU9DLE9BQU87WUFBNkI7UUFDMUQ7UUFDQSxJQUFJLE9BQU9DLFFBQVFWLFlBQVksS0FBSyxZQUFZVSxRQUFRVixZQUFZLENBQUNQLE1BQU0sS0FBSyxHQUFHO1lBQ2pGLE9BQU87Z0JBQUVlLElBQUk7Z0JBQU9DLE9BQU87WUFBZ0M7UUFDN0Q7UUFDQSxJQUFJQyxRQUFRbkIsT0FBTyxLQUFLQyxhQUFhLE9BQU9rQixRQUFRbkIsT0FBTyxLQUFLLFVBQVU7WUFDeEUsT0FBTztnQkFBRWlCLElBQUk7Z0JBQU9DLE9BQU87WUFBa0M7UUFDL0Q7UUFDQSxJQUFJQyxRQUFRbkIsT0FBTyxJQUFJbUIsUUFBUW5CLE9BQU8sQ0FBQ0UsTUFBTSxHQUFHSixvQkFBb0I7WUFDbEUsT0FBTztnQkFBRW1CLElBQUk7Z0JBQU9DLE9BQU87WUFBNEI7UUFDekQ7SUFDRjtJQUVBLE9BQU87UUFBRUQsSUFBSTtJQUFLO0FBQ3BCO0FBRU8sU0FBU0cscUJBQXFCTixRQUEyQjtJQUM5RCxPQUFPQSxTQUFTTyxHQUFHLENBQUMsQ0FBQ0YsVUFBYTtZQUNoQyxHQUFHQSxPQUFPO1lBQ1ZuQixTQUFTRCxhQUFhb0IsUUFBUW5CLE9BQU87UUFDdkM7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9zcmMvd29ya2Zsb3dzL3dmNC9ldmlkZW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEV2aWRlbmNlUG9pbnRlciB9IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBNQVhfU05JUFBFVF9MRU5HVEggPSAyMDA7XG5cbmZ1bmN0aW9uIGJvdW5kU25pcHBldChzbmlwcGV0Pzogc3RyaW5nKSB7XG4gIGlmICghc25pcHBldCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgaWYgKHNuaXBwZXQubGVuZ3RoIDw9IE1BWF9TTklQUEVUX0xFTkdUSCkgcmV0dXJuIHNuaXBwZXQ7XG4gIHJldHVybiBzbmlwcGV0LnNsaWNlKDAsIE1BWF9TTklQUEVUX0xFTkdUSCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWVsZFBvaW50ZXIoXG4gIHNvdXJjZUlkOiBzdHJpbmcsXG4gIHBhdGhPclNwYW46IHN0cmluZyxcbiAgc25pcHBldD86IHN0cmluZyxcbik6IEV2aWRlbmNlUG9pbnRlciB7XG4gIHJldHVybiB7XG4gICAgc291cmNlX3R5cGU6ICdmaWVsZCcsXG4gICAgc291cmNlX2lkOiBzb3VyY2VJZCxcbiAgICBwYXRoX29yX3NwYW46IHBhdGhPclNwYW4sXG4gICAgc25pcHBldDogYm91bmRTbmlwcGV0KHNuaXBwZXQpLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVzc2FnZVBvaW50ZXIoXG4gIHNvdXJjZUlkOiBzdHJpbmcsXG4gIHBhdGhPclNwYW46IHN0cmluZyxcbiAgc25pcHBldD86IHN0cmluZyxcbik6IEV2aWRlbmNlUG9pbnRlciB7XG4gIHJldHVybiB7XG4gICAgc291cmNlX3R5cGU6ICdtZXNzYWdlJyxcbiAgICBzb3VyY2VfaWQ6IHNvdXJjZUlkLFxuICAgIHBhdGhfb3Jfc3BhbjogcGF0aE9yU3BhbixcbiAgICBzbmlwcGV0OiBib3VuZFNuaXBwZXQoc25pcHBldCksXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkb2N1bWVudFBvaW50ZXIoXG4gIHNvdXJjZUlkOiBzdHJpbmcsXG4gIHBhdGhPclNwYW46IHN0cmluZyxcbiAgc25pcHBldD86IHN0cmluZyxcbik6IEV2aWRlbmNlUG9pbnRlciB7XG4gIHJldHVybiB7XG4gICAgc291cmNlX3R5cGU6ICdkb2N1bWVudCcsXG4gICAgc291cmNlX2lkOiBzb3VyY2VJZCxcbiAgICBwYXRoX29yX3NwYW46IHBhdGhPclNwYW4sXG4gICAgc25pcHBldDogYm91bmRTbmlwcGV0KHNuaXBwZXQpLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd2YzUG9pbnRlcihcbiAgc291cmNlSWQ6IHN0cmluZyxcbiAgcGF0aE9yU3Bhbjogc3RyaW5nLFxuICBzbmlwcGV0Pzogc3RyaW5nLFxuKTogRXZpZGVuY2VQb2ludGVyIHtcbiAgcmV0dXJuIHtcbiAgICBzb3VyY2VfdHlwZTogJ3dmMycsXG4gICAgc291cmNlX2lkOiBzb3VyY2VJZCxcbiAgICBwYXRoX29yX3NwYW46IHBhdGhPclNwYW4sXG4gICAgc25pcHBldDogYm91bmRTbmlwcGV0KHNuaXBwZXQpLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVFdmlkZW5jZVBvaW50ZXJzKFxuICBldmlkZW5jZTogRXZpZGVuY2VQb2ludGVyW10sXG4pOiB7IG9rOiB0cnVlIH0gfCB7IG9rOiBmYWxzZTsgZXJyb3I6IHN0cmluZyB9IHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KGV2aWRlbmNlKSkge1xuICAgIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdldmlkZW5jZSBtdXN0IGJlIGFuIGFycmF5JyB9O1xuICB9XG5cbiAgZm9yIChjb25zdCBwb2ludGVyIG9mIGV2aWRlbmNlKSB7XG4gICAgaWYgKCFwb2ludGVyIHx8IHR5cGVvZiBwb2ludGVyICE9PSAnb2JqZWN0Jykge1xuICAgICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2V2aWRlbmNlIHBvaW50ZXIgbXVzdCBiZSBvYmplY3QnIH07XG4gICAgfVxuICAgIGlmIChcbiAgICAgIHBvaW50ZXIuc291cmNlX3R5cGUgIT09ICdmaWVsZCcgJiZcbiAgICAgIHBvaW50ZXIuc291cmNlX3R5cGUgIT09ICdtZXNzYWdlJyAmJlxuICAgICAgcG9pbnRlci5zb3VyY2VfdHlwZSAhPT0gJ2RvY3VtZW50JyAmJlxuICAgICAgcG9pbnRlci5zb3VyY2VfdHlwZSAhPT0gJ3dmMydcbiAgICApIHtcbiAgICAgIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdldmlkZW5jZSBzb3VyY2VfdHlwZSBpbnZhbGlkJyB9O1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHBvaW50ZXIuc291cmNlX2lkICE9PSAnc3RyaW5nJyB8fCBwb2ludGVyLnNvdXJjZV9pZC5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdldmlkZW5jZSBzb3VyY2VfaWQgbWlzc2luZycgfTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwb2ludGVyLnBhdGhfb3Jfc3BhbiAhPT0gJ3N0cmluZycgfHwgcG9pbnRlci5wYXRoX29yX3NwYW4ubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZXZpZGVuY2UgcGF0aF9vcl9zcGFuIG1pc3NpbmcnIH07XG4gICAgfVxuICAgIGlmIChwb2ludGVyLnNuaXBwZXQgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgcG9pbnRlci5zbmlwcGV0ICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2V2aWRlbmNlIHNuaXBwZXQgbXVzdCBiZSBzdHJpbmcnIH07XG4gICAgfVxuICAgIGlmIChwb2ludGVyLnNuaXBwZXQgJiYgcG9pbnRlci5zbmlwcGV0Lmxlbmd0aCA+IE1BWF9TTklQUEVUX0xFTkdUSCkge1xuICAgICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2V2aWRlbmNlIHNuaXBwZXQgdG9vIGxvbmcnIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgb2s6IHRydWUgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJvdW5kRXZpZGVuY2VTbmlwcGV0KGV2aWRlbmNlOiBFdmlkZW5jZVBvaW50ZXJbXSk6IEV2aWRlbmNlUG9pbnRlcltdIHtcbiAgcmV0dXJuIGV2aWRlbmNlLm1hcCgocG9pbnRlcikgPT4gKHtcbiAgICAuLi5wb2ludGVyLFxuICAgIHNuaXBwZXQ6IGJvdW5kU25pcHBldChwb2ludGVyLnNuaXBwZXQpLFxuICB9KSk7XG59XG4iXSwibmFtZXMiOlsiTUFYX1NOSVBQRVRfTEVOR1RIIiwiYm91bmRTbmlwcGV0Iiwic25pcHBldCIsInVuZGVmaW5lZCIsImxlbmd0aCIsInNsaWNlIiwiZmllbGRQb2ludGVyIiwic291cmNlSWQiLCJwYXRoT3JTcGFuIiwic291cmNlX3R5cGUiLCJzb3VyY2VfaWQiLCJwYXRoX29yX3NwYW4iLCJtZXNzYWdlUG9pbnRlciIsImRvY3VtZW50UG9pbnRlciIsIndmM1BvaW50ZXIiLCJ2YWxpZGF0ZUV2aWRlbmNlUG9pbnRlcnMiLCJldmlkZW5jZSIsIkFycmF5IiwiaXNBcnJheSIsIm9rIiwiZXJyb3IiLCJwb2ludGVyIiwiYm91bmRFdmlkZW5jZVNuaXBwZXQiLCJtYXAiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflows/wf4/evidence.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflows/wf4/prompts.ts":
/*!******************************************!*\
  !*** ../../src/workflows/wf4/prompts.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WF4_PROMPT_BUNDLE_VERSION: () => (/* binding */ WF4_PROMPT_BUNDLE_VERSION),\n/* harmony export */   WF4_PROMPT_IDS: () => (/* binding */ WF4_PROMPT_IDS),\n/* harmony export */   WF4_PROMPT_TEMPLATES: () => (/* binding */ WF4_PROMPT_TEMPLATES),\n/* harmony export */   WF4_TASK_PROMPT_MAP: () => (/* binding */ WF4_TASK_PROMPT_MAP)\n/* harmony export */ });\nconst WF4_PROMPT_BUNDLE_VERSION = 'v0.1';\nconst WF4_PROMPT_IDS = {\n    system: 'wf4.system.v1',\n    extract: 'wf4.task.extract.schema_fields.v1',\n    dv: 'wf4.task.flags.dv_indicators.v1',\n    jurisdiction: 'wf4.task.flags.jurisdiction_complexity.v1',\n    custody: 'wf4.task.flags.custody_conflict.v1',\n    consistency: 'wf4.task.consistency.cross_field.v1',\n    countyMentions: 'wf4.task.normalize.county_mentions.v1',\n    reviewAttention: 'wf4.task.review_attention.summary.v1'\n};\nconst WF4_TASK_PROMPT_MAP = {\n    'wf4.extract.schema_fields.v1': WF4_PROMPT_IDS.extract,\n    'wf4.flags.dv_indicators.v1': WF4_PROMPT_IDS.dv,\n    'wf4.flags.jurisdiction_complexity.v1': WF4_PROMPT_IDS.jurisdiction,\n    'wf4.flags.custody_conflict.v1': WF4_PROMPT_IDS.custody,\n    'wf4.consistency.cross_field.v1': WF4_PROMPT_IDS.consistency,\n    'wf4.normalize.county_mentions.v1': WF4_PROMPT_IDS.countyMentions,\n    'wf4.review_attention.summary.v1': WF4_PROMPT_IDS.reviewAttention\n};\nconst WF4_PROMPT_TEMPLATES = {\n    [WF4_PROMPT_IDS.extract]: {\n        id: WF4_PROMPT_IDS.extract,\n        system: 'Use wf4.system.v1',\n        user: 'Extract schema-bound fields from intake inputs using the schema allowlist. Return JSON only.'\n    },\n    [WF4_PROMPT_IDS.dv]: {\n        id: WF4_PROMPT_IDS.dv,\n        system: 'Use wf4.system.v1',\n        user: 'Detect DV indicators with evidence. Return JSON only.'\n    },\n    [WF4_PROMPT_IDS.jurisdiction]: {\n        id: WF4_PROMPT_IDS.jurisdiction,\n        system: 'Use wf4.system.v1',\n        user: 'Detect jurisdiction complexity signals with evidence. Return JSON only.'\n    },\n    [WF4_PROMPT_IDS.custody]: {\n        id: WF4_PROMPT_IDS.custody,\n        system: 'Use wf4.system.v1',\n        user: 'Detect custody conflict signals with evidence. Return JSON only.'\n    },\n    [WF4_PROMPT_IDS.consistency]: {\n        id: WF4_PROMPT_IDS.consistency,\n        system: 'Use wf4.system.v1',\n        user: 'Detect cross-field inconsistencies with evidence. Return JSON only.'\n    },\n    [WF4_PROMPT_IDS.countyMentions]: {\n        id: WF4_PROMPT_IDS.countyMentions,\n        system: 'Use wf4.system.v1',\n        user: 'Extract county mentions and suggest normalization. Return JSON only.'\n    },\n    [WF4_PROMPT_IDS.reviewAttention]: {\n        id: WF4_PROMPT_IDS.reviewAttention,\n        system: 'Use wf4.system.v1',\n        user: 'Summarize review attention priorities based on WF4 outputs. Return JSON only.'\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3dzL3dmNC9wcm9tcHRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTyxNQUFNQSw0QkFBNEIsT0FBTztBQUV6QyxNQUFNQyxpQkFBaUI7SUFDNUJDLFFBQVE7SUFDUkMsU0FBUztJQUNUQyxJQUFJO0lBQ0pDLGNBQWM7SUFDZEMsU0FBUztJQUNUQyxhQUFhO0lBQ2JDLGdCQUFnQjtJQUNoQkMsaUJBQWlCO0FBQ25CLEVBQVc7QUFFSixNQUFNQyxzQkFBOEM7SUFDekQsZ0NBQWdDVCxlQUFlRSxPQUFPO0lBQ3RELDhCQUE4QkYsZUFBZUcsRUFBRTtJQUMvQyx3Q0FBd0NILGVBQWVJLFlBQVk7SUFDbkUsaUNBQWlDSixlQUFlSyxPQUFPO0lBQ3ZELGtDQUFrQ0wsZUFBZU0sV0FBVztJQUM1RCxvQ0FBb0NOLGVBQWVPLGNBQWM7SUFDakUsbUNBQW1DUCxlQUFlUSxlQUFlO0FBQ25FLEVBQUU7QUFRSyxNQUFNRSx1QkFBdUQ7SUFDbEUsQ0FBQ1YsZUFBZUUsT0FBTyxDQUFDLEVBQUU7UUFDeEJTLElBQUlYLGVBQWVFLE9BQU87UUFDMUJELFFBQVE7UUFDUlcsTUFBTTtJQUNSO0lBQ0EsQ0FBQ1osZUFBZUcsRUFBRSxDQUFDLEVBQUU7UUFDbkJRLElBQUlYLGVBQWVHLEVBQUU7UUFDckJGLFFBQVE7UUFDUlcsTUFBTTtJQUNSO0lBQ0EsQ0FBQ1osZUFBZUksWUFBWSxDQUFDLEVBQUU7UUFDN0JPLElBQUlYLGVBQWVJLFlBQVk7UUFDL0JILFFBQVE7UUFDUlcsTUFBTTtJQUNSO0lBQ0EsQ0FBQ1osZUFBZUssT0FBTyxDQUFDLEVBQUU7UUFDeEJNLElBQUlYLGVBQWVLLE9BQU87UUFDMUJKLFFBQVE7UUFDUlcsTUFBTTtJQUNSO0lBQ0EsQ0FBQ1osZUFBZU0sV0FBVyxDQUFDLEVBQUU7UUFDNUJLLElBQUlYLGVBQWVNLFdBQVc7UUFDOUJMLFFBQVE7UUFDUlcsTUFBTTtJQUNSO0lBQ0EsQ0FBQ1osZUFBZU8sY0FBYyxDQUFDLEVBQUU7UUFDL0JJLElBQUlYLGVBQWVPLGNBQWM7UUFDakNOLFFBQVE7UUFDUlcsTUFBTTtJQUNSO0lBQ0EsQ0FBQ1osZUFBZVEsZUFBZSxDQUFDLEVBQUU7UUFDaENHLElBQUlYLGVBQWVRLGVBQWU7UUFDbENQLFFBQVE7UUFDUlcsTUFBTTtJQUNSO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9zcmMvd29ya2Zsb3dzL3dmNC9wcm9tcHRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBXRjRfUFJPTVBUX0JVTkRMRV9WRVJTSU9OID0gJ3YwLjEnO1xuXG5leHBvcnQgY29uc3QgV0Y0X1BST01QVF9JRFMgPSB7XG4gIHN5c3RlbTogJ3dmNC5zeXN0ZW0udjEnLFxuICBleHRyYWN0OiAnd2Y0LnRhc2suZXh0cmFjdC5zY2hlbWFfZmllbGRzLnYxJyxcbiAgZHY6ICd3ZjQudGFzay5mbGFncy5kdl9pbmRpY2F0b3JzLnYxJyxcbiAganVyaXNkaWN0aW9uOiAnd2Y0LnRhc2suZmxhZ3MuanVyaXNkaWN0aW9uX2NvbXBsZXhpdHkudjEnLFxuICBjdXN0b2R5OiAnd2Y0LnRhc2suZmxhZ3MuY3VzdG9keV9jb25mbGljdC52MScsXG4gIGNvbnNpc3RlbmN5OiAnd2Y0LnRhc2suY29uc2lzdGVuY3kuY3Jvc3NfZmllbGQudjEnLFxuICBjb3VudHlNZW50aW9uczogJ3dmNC50YXNrLm5vcm1hbGl6ZS5jb3VudHlfbWVudGlvbnMudjEnLFxuICByZXZpZXdBdHRlbnRpb246ICd3ZjQudGFzay5yZXZpZXdfYXR0ZW50aW9uLnN1bW1hcnkudjEnLFxufSBhcyBjb25zdDtcblxuZXhwb3J0IGNvbnN0IFdGNF9UQVNLX1BST01QVF9NQVA6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICd3ZjQuZXh0cmFjdC5zY2hlbWFfZmllbGRzLnYxJzogV0Y0X1BST01QVF9JRFMuZXh0cmFjdCxcbiAgJ3dmNC5mbGFncy5kdl9pbmRpY2F0b3JzLnYxJzogV0Y0X1BST01QVF9JRFMuZHYsXG4gICd3ZjQuZmxhZ3MuanVyaXNkaWN0aW9uX2NvbXBsZXhpdHkudjEnOiBXRjRfUFJPTVBUX0lEUy5qdXJpc2RpY3Rpb24sXG4gICd3ZjQuZmxhZ3MuY3VzdG9keV9jb25mbGljdC52MSc6IFdGNF9QUk9NUFRfSURTLmN1c3RvZHksXG4gICd3ZjQuY29uc2lzdGVuY3kuY3Jvc3NfZmllbGQudjEnOiBXRjRfUFJPTVBUX0lEUy5jb25zaXN0ZW5jeSxcbiAgJ3dmNC5ub3JtYWxpemUuY291bnR5X21lbnRpb25zLnYxJzogV0Y0X1BST01QVF9JRFMuY291bnR5TWVudGlvbnMsXG4gICd3ZjQucmV2aWV3X2F0dGVudGlvbi5zdW1tYXJ5LnYxJzogV0Y0X1BST01QVF9JRFMucmV2aWV3QXR0ZW50aW9uLFxufTtcblxuZXhwb3J0IHR5cGUgUHJvbXB0VGVtcGxhdGUgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIHN5c3RlbTogc3RyaW5nO1xuICB1c2VyOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgY29uc3QgV0Y0X1BST01QVF9URU1QTEFURVM6IFJlY29yZDxzdHJpbmcsIFByb21wdFRlbXBsYXRlPiA9IHtcbiAgW1dGNF9QUk9NUFRfSURTLmV4dHJhY3RdOiB7XG4gICAgaWQ6IFdGNF9QUk9NUFRfSURTLmV4dHJhY3QsXG4gICAgc3lzdGVtOiAnVXNlIHdmNC5zeXN0ZW0udjEnLFxuICAgIHVzZXI6ICdFeHRyYWN0IHNjaGVtYS1ib3VuZCBmaWVsZHMgZnJvbSBpbnRha2UgaW5wdXRzIHVzaW5nIHRoZSBzY2hlbWEgYWxsb3dsaXN0LiBSZXR1cm4gSlNPTiBvbmx5LicsXG4gIH0sXG4gIFtXRjRfUFJPTVBUX0lEUy5kdl06IHtcbiAgICBpZDogV0Y0X1BST01QVF9JRFMuZHYsXG4gICAgc3lzdGVtOiAnVXNlIHdmNC5zeXN0ZW0udjEnLFxuICAgIHVzZXI6ICdEZXRlY3QgRFYgaW5kaWNhdG9ycyB3aXRoIGV2aWRlbmNlLiBSZXR1cm4gSlNPTiBvbmx5LicsXG4gIH0sXG4gIFtXRjRfUFJPTVBUX0lEUy5qdXJpc2RpY3Rpb25dOiB7XG4gICAgaWQ6IFdGNF9QUk9NUFRfSURTLmp1cmlzZGljdGlvbixcbiAgICBzeXN0ZW06ICdVc2Ugd2Y0LnN5c3RlbS52MScsXG4gICAgdXNlcjogJ0RldGVjdCBqdXJpc2RpY3Rpb24gY29tcGxleGl0eSBzaWduYWxzIHdpdGggZXZpZGVuY2UuIFJldHVybiBKU09OIG9ubHkuJyxcbiAgfSxcbiAgW1dGNF9QUk9NUFRfSURTLmN1c3RvZHldOiB7XG4gICAgaWQ6IFdGNF9QUk9NUFRfSURTLmN1c3RvZHksXG4gICAgc3lzdGVtOiAnVXNlIHdmNC5zeXN0ZW0udjEnLFxuICAgIHVzZXI6ICdEZXRlY3QgY3VzdG9keSBjb25mbGljdCBzaWduYWxzIHdpdGggZXZpZGVuY2UuIFJldHVybiBKU09OIG9ubHkuJyxcbiAgfSxcbiAgW1dGNF9QUk9NUFRfSURTLmNvbnNpc3RlbmN5XToge1xuICAgIGlkOiBXRjRfUFJPTVBUX0lEUy5jb25zaXN0ZW5jeSxcbiAgICBzeXN0ZW06ICdVc2Ugd2Y0LnN5c3RlbS52MScsXG4gICAgdXNlcjogJ0RldGVjdCBjcm9zcy1maWVsZCBpbmNvbnNpc3RlbmNpZXMgd2l0aCBldmlkZW5jZS4gUmV0dXJuIEpTT04gb25seS4nLFxuICB9LFxuICBbV0Y0X1BST01QVF9JRFMuY291bnR5TWVudGlvbnNdOiB7XG4gICAgaWQ6IFdGNF9QUk9NUFRfSURTLmNvdW50eU1lbnRpb25zLFxuICAgIHN5c3RlbTogJ1VzZSB3ZjQuc3lzdGVtLnYxJyxcbiAgICB1c2VyOiAnRXh0cmFjdCBjb3VudHkgbWVudGlvbnMgYW5kIHN1Z2dlc3Qgbm9ybWFsaXphdGlvbi4gUmV0dXJuIEpTT04gb25seS4nLFxuICB9LFxuICBbV0Y0X1BST01QVF9JRFMucmV2aWV3QXR0ZW50aW9uXToge1xuICAgIGlkOiBXRjRfUFJPTVBUX0lEUy5yZXZpZXdBdHRlbnRpb24sXG4gICAgc3lzdGVtOiAnVXNlIHdmNC5zeXN0ZW0udjEnLFxuICAgIHVzZXI6ICdTdW1tYXJpemUgcmV2aWV3IGF0dGVudGlvbiBwcmlvcml0aWVzIGJhc2VkIG9uIFdGNCBvdXRwdXRzLiBSZXR1cm4gSlNPTiBvbmx5LicsXG4gIH0sXG59O1xuIl0sIm5hbWVzIjpbIldGNF9QUk9NUFRfQlVORExFX1ZFUlNJT04iLCJXRjRfUFJPTVBUX0lEUyIsInN5c3RlbSIsImV4dHJhY3QiLCJkdiIsImp1cmlzZGljdGlvbiIsImN1c3RvZHkiLCJjb25zaXN0ZW5jeSIsImNvdW50eU1lbnRpb25zIiwicmV2aWV3QXR0ZW50aW9uIiwiV0Y0X1RBU0tfUFJPTVBUX01BUCIsIldGNF9QUk9NUFRfVEVNUExBVEVTIiwiaWQiLCJ1c2VyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflows/wf4/prompts.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflows/wf4/runWf4.ts":
/*!*****************************************!*\
  !*** ../../src/workflows/wf4/runWf4.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   runWf4: () => (/* binding */ runWf4)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_intake_schema_gaDivorceCustodyV1__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/intake/schema/gaDivorceCustodyV1 */ \"(api-node)/../../lib/intake/schema/gaDivorceCustodyV1.ts\");\n/* harmony import */ var _counties__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./counties */ \"(api-node)/../../src/workflows/wf4/counties.ts\");\n/* harmony import */ var _taskCatalog__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./taskCatalog */ \"(api-node)/../../src/workflows/wf4/taskCatalog.ts\");\n/* harmony import */ var _evidence__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./evidence */ \"(api-node)/../../src/workflows/wf4/evidence.ts\");\n/* harmony import */ var _prompts__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./prompts */ \"(api-node)/../../src/workflows/wf4/prompts.ts\");\n\n\n\n\n\n\nfunction isRecord(value) {\n    return Boolean(value) && typeof value === 'object' && !Array.isArray(value);\n}\nfunction toIso(now) {\n    return now ? now() : new Date().toISOString();\n}\nfunction buildSchemaAllowlist() {\n    return _lib_intake_schema_gaDivorceCustodyV1__WEBPACK_IMPORTED_MODULE_1__.GA_DIVORCE_CUSTODY_V1.sections.flatMap((section)=>section.fields.filter((field)=>!field.isSystem).map((field)=>field.key));\n}\nasync function loadIntakeSnapshot(intakeId) {\n    const { supabaseAdmin } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/server/supabaseAdmin */ \"(api-node)/../../lib/server/supabaseAdmin.ts\"));\n    const { data: intake, error: intakeError } = await supabaseAdmin.from('intakes').select('id, firm_id, submitted_at, raw_payload, created_at').eq('id', intakeId).maybeSingle();\n    if (intakeError) {\n        throw new Error('Unable to load intake snapshot');\n    }\n    if (!intake) {\n        throw new Error('Intake not found');\n    }\n    if (!intake.submitted_at) {\n        throw new Error('Intake not submitted');\n    }\n    const { data: messages, error: messageError } = await supabaseAdmin.from('intake_messages').select('id, source, content, created_at').eq('intake_id', intakeId).order('seq', {\n        ascending: true\n    });\n    if (messageError) {\n        throw new Error('Unable to load intake messages');\n    }\n    const { data: documents, error: documentsError } = await supabaseAdmin.from('intake_documents').select('id, storage_object_path, document_type, created_at').eq('intake_id', intakeId).order('created_at', {\n        ascending: true\n    });\n    if (documentsError) {\n        throw new Error('Unable to load intake documents');\n    }\n    const structuredFields = isRecord(intake.raw_payload) ? intake.raw_payload : {};\n    return {\n        intake_id: intake.id,\n        submission_id: intake.id,\n        structured_fields: structuredFields,\n        free_text_fields: {},\n        messages: (messages ?? []).map((message)=>({\n                message_id: message.id,\n                role: message.source,\n                content: message.content,\n                created_at: message.created_at\n            })),\n        documents: (documents ?? []).map((doc)=>({\n                document_id: doc.id,\n                filename: doc.storage_object_path ?? null,\n                mimetype: doc.document_type ?? null,\n                text_extract: null,\n                created_at: doc.created_at\n            })),\n        created_at: intake.created_at,\n        firm_id: intake.firm_id\n    };\n}\nasync function loadWf3Snapshot(wf3RunId) {\n    const { supabaseAdmin } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/server/supabaseAdmin */ \"(api-node)/../../lib/server/supabaseAdmin.ts\"));\n    const { data, error } = await supabaseAdmin.from('intake_extractions').select('id, extracted_data, created_at').eq('id', wf3RunId).maybeSingle();\n    if (error) {\n        throw new Error('Unable to load WF3 snapshot');\n    }\n    if (!data) {\n        throw new Error('WF3 snapshot not found');\n    }\n    const extracted = data.extracted_data;\n    const rulesEngine = extracted?.rules_engine ?? null;\n    if (!rulesEngine) {\n        throw new Error('WF3 snapshot missing rules_engine');\n    }\n    return {\n        wf3_run_id: data.id,\n        validation_summary: {\n            rule_results: (rulesEngine.rule_evaluations ?? []).map((entry)=>({\n                    rule_id: String(entry.rule_id ?? ''),\n                    passed: Boolean(entry.passed),\n                    field_paths: Array.isArray(entry.field_paths) ? entry.field_paths : [],\n                    message: entry.message ?? undefined\n                })),\n            required_fields_missing: Array.isArray(rulesEngine.required_fields_missing) ? rulesEngine.required_fields_missing : []\n        },\n        canonical_fields: {},\n        created_at: data.created_at\n    };\n}\nasync function storeRun(args) {\n    const { supabaseAdmin } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ../../../lib/server/supabaseAdmin */ \"(api-node)/../../lib/server/supabaseAdmin.ts\"));\n    const { runLog, runOutput } = args;\n    const { data, error } = await supabaseAdmin.from('ai_runs').insert({\n        id: runLog.wf4_run_id,\n        firm_id: runLog.input_refs.firm_id,\n        intake_id: runLog.intake_id,\n        run_kind: 'wf4',\n        model_name: runLog.model_name ?? null,\n        prompt_hash: runLog.prompt_bundle_version,\n        inputs: {\n            wf3_run_id: runLog.wf3_run_id ?? null,\n            prompt_bundle_version: runLog.prompt_bundle_version,\n            per_task: runLog.per_task,\n            input_refs: runLog.input_refs,\n            started_at: runLog.started_at,\n            completed_at: runLog.completed_at,\n            status: runLog.status\n        },\n        outputs: {\n            run_log: runLog,\n            run_output: runOutput\n        },\n        status: runLog.status.toLowerCase()\n    }).select('id').single();\n    if (error || !data) {\n        throw new Error('Unable to store WF4 run');\n    }\n    return {\n        wf4_run_id: data.id\n    };\n}\nfunction parseJsonOutput(raw) {\n    if (isRecord(raw)) {\n        return {\n            ok: true,\n            value: raw\n        };\n    }\n    if (typeof raw === 'string') {\n        try {\n            const parsed = JSON.parse(raw);\n            if (!isRecord(parsed)) {\n                return {\n                    ok: false,\n                    error: 'Parsed output is not an object'\n                };\n            }\n            return {\n                ok: true,\n                value: parsed\n            };\n        } catch (error) {\n            return {\n                ok: false,\n                error: 'Invalid JSON output'\n            };\n        }\n    }\n    return {\n        ok: false,\n        error: 'Output is not JSON'\n    };\n}\nfunction validateExtractionOutput(output) {\n    const extractions = output.extractions;\n    if (!Array.isArray(extractions)) {\n        return {\n            ok: false,\n            error: 'extractions must be an array'\n        };\n    }\n    for (const item of extractions){\n        if (!isRecord(item)) return {\n            ok: false,\n            error: 'extraction item must be object'\n        };\n        if (typeof item.field_key !== 'string') return {\n            ok: false,\n            error: 'field_key missing'\n        };\n        if (typeof item.value_type !== 'string') return {\n            ok: false,\n            error: 'value_type missing'\n        };\n        if (typeof item.confidence_score !== 'number') return {\n            ok: false,\n            error: 'confidence_score missing'\n        };\n        if (typeof item.confidence_level !== 'string') return {\n            ok: false,\n            error: 'confidence_level missing'\n        };\n        if (!Array.isArray(item.evidence)) return {\n            ok: false,\n            error: 'evidence missing'\n        };\n        const evidenceCheck = (0,_evidence__WEBPACK_IMPORTED_MODULE_4__.validateEvidencePointers)(item.evidence);\n        if (!evidenceCheck.ok) return {\n            ok: false,\n            error: evidenceCheck.error\n        };\n    }\n    return {\n        ok: true,\n        value: {\n            extractions: extractions\n        }\n    };\n}\nfunction validateFlagsOutput(output) {\n    const flags = output.flags;\n    if (!Array.isArray(flags)) {\n        return {\n            ok: false,\n            error: 'flags must be an array'\n        };\n    }\n    for (const item of flags){\n        if (!isRecord(item)) return {\n            ok: false,\n            error: 'flag item must be object'\n        };\n        if (typeof item.flag_key !== 'string') return {\n            ok: false,\n            error: 'flag_key missing'\n        };\n        if (typeof item.flag_present !== 'boolean') return {\n            ok: false,\n            error: 'flag_present missing'\n        };\n        if (typeof item.confidence_score !== 'number') return {\n            ok: false,\n            error: 'confidence_score missing'\n        };\n        if (typeof item.confidence_level !== 'string') return {\n            ok: false,\n            error: 'confidence_level missing'\n        };\n        if (!Array.isArray(item.evidence)) return {\n            ok: false,\n            error: 'evidence missing'\n        };\n        const evidenceCheck = (0,_evidence__WEBPACK_IMPORTED_MODULE_4__.validateEvidencePointers)(item.evidence);\n        if (!evidenceCheck.ok) return {\n            ok: false,\n            error: evidenceCheck.error\n        };\n        if (typeof item.why_it_matters_for_review !== 'string') {\n            return {\n                ok: false,\n                error: 'why_it_matters_for_review missing'\n            };\n        }\n    }\n    return {\n        ok: true,\n        value: {\n            flags: flags\n        }\n    };\n}\nfunction validateInconsistenciesOutput(output) {\n    const inconsistencies = output.inconsistencies;\n    if (!Array.isArray(inconsistencies)) {\n        return {\n            ok: false,\n            error: 'inconsistencies must be an array'\n        };\n    }\n    for (const item of inconsistencies){\n        if (!isRecord(item)) return {\n            ok: false,\n            error: 'inconsistency item must be object'\n        };\n        if (typeof item.inconsistency_key !== 'string') return {\n            ok: false,\n            error: 'inconsistency_key missing'\n        };\n        if (!Array.isArray(item.fields_involved)) return {\n            ok: false,\n            error: 'fields_involved missing'\n        };\n        if (typeof item.summary !== 'string') return {\n            ok: false,\n            error: 'summary missing'\n        };\n        if (typeof item.severity !== 'string') return {\n            ok: false,\n            error: 'severity missing'\n        };\n        if (typeof item.confidence_score !== 'number') return {\n            ok: false,\n            error: 'confidence_score missing'\n        };\n        if (!Array.isArray(item.evidence)) return {\n            ok: false,\n            error: 'evidence missing'\n        };\n        const evidenceCheck = (0,_evidence__WEBPACK_IMPORTED_MODULE_4__.validateEvidencePointers)(item.evidence);\n        if (!evidenceCheck.ok) return {\n            ok: false,\n            error: evidenceCheck.error\n        };\n    }\n    return {\n        ok: true,\n        value: {\n            inconsistencies: inconsistencies\n        }\n    };\n}\nfunction validateCountyMentionsOutput(output, canonicalList) {\n    const countyMentions = output.county_mentions;\n    const deference = output.deference;\n    if (!Array.isArray(countyMentions)) {\n        return {\n            ok: false,\n            error: 'county_mentions must be an array'\n        };\n    }\n    if (!isRecord(deference) || typeof deference.wf3_canonical_county_present !== 'boolean') {\n        return {\n            ok: false,\n            error: 'deference missing'\n        };\n    }\n    for (const item of countyMentions){\n        if (!isRecord(item)) return {\n            ok: false,\n            error: 'county mention must be object'\n        };\n        if (typeof item.raw_mention !== 'string') return {\n            ok: false,\n            error: 'raw_mention missing'\n        };\n        if (typeof item.match_type !== 'string') return {\n            ok: false,\n            error: 'match_type missing'\n        };\n        if (typeof item.confidence_score !== 'number') return {\n            ok: false,\n            error: 'confidence_score missing'\n        };\n        if (!Array.isArray(item.evidence)) return {\n            ok: false,\n            error: 'evidence missing'\n        };\n        if (item.suggested_county !== null && item.suggested_county !== undefined && typeof item.suggested_county !== 'string') {\n            return {\n                ok: false,\n                error: 'suggested_county must be string or null'\n            };\n        }\n        if (typeof item.suggested_county === 'string' && Array.isArray(canonicalList) && canonicalList.length > 0 && !canonicalList.includes(item.suggested_county)) {\n            return {\n                ok: false,\n                error: 'suggested_county not in canonical list'\n            };\n        }\n        const evidenceCheck = (0,_evidence__WEBPACK_IMPORTED_MODULE_4__.validateEvidencePointers)(item.evidence);\n        if (!evidenceCheck.ok) return {\n            ok: false,\n            error: evidenceCheck.error\n        };\n    }\n    return {\n        ok: true,\n        value: {\n            county_mentions: countyMentions,\n            deference: {\n                wf3_canonical_county_present: Boolean(deference.wf3_canonical_county_present),\n                wf3_canonical_county_value: typeof deference.wf3_canonical_county_value === 'string' ? deference.wf3_canonical_county_value : undefined\n            }\n        }\n    };\n}\nfunction validateReviewAttentionOutput(output) {\n    const reviewAttention = output.review_attention;\n    if (!isRecord(reviewAttention)) {\n        return {\n            ok: false,\n            error: 'review_attention missing'\n        };\n    }\n    const high = reviewAttention.high_priority_items;\n    const medium = reviewAttention.medium_priority_items;\n    const low = reviewAttention.low_priority_items;\n    if (!Array.isArray(high) || !Array.isArray(medium) || !Array.isArray(low)) {\n        return {\n            ok: false,\n            error: 'priority lists missing'\n        };\n    }\n    return {\n        ok: true,\n        value: {\n            review_attention: {\n                high_priority_items: high,\n                medium_priority_items: medium,\n                low_priority_items: low\n            }\n        }\n    };\n}\nasync function runTask(provider, promptId, input) {\n    const template = _prompts__WEBPACK_IMPORTED_MODULE_5__.WF4_PROMPT_TEMPLATES[promptId];\n    const systemPrompt = template?.system ?? 'Use wf4.system.v1';\n    const userPrompt = template?.user ?? 'Return JSON only.';\n    const raw = await provider.generateJson({\n        promptId,\n        systemPrompt,\n        userPrompt,\n        input\n    });\n    return parseJsonOutput(raw);\n}\nfunction buildTaskInput(taskId, context) {\n    const base = {\n        intake_snapshot: context.intakeSnapshot,\n        wf3_snapshot: context.wf3Snapshot\n    };\n    switch(taskId){\n        case 'wf4.extract.schema_fields.v1':\n            return {\n                ...base,\n                schema_allowlist: context.schemaAllowlist\n            };\n        case 'wf4.normalize.county_mentions.v1':\n            return {\n                ...base,\n                reference: {\n                    ga_counties: context.countyReference\n                }\n            };\n        case 'wf4.review_attention.summary.v1':\n            return {\n                wf4_outputs: context.previousOutputs\n            };\n        default:\n            return base;\n    }\n}\nasync function runWf4(input, deps = {}) {\n    const now = deps.now ?? (()=>new Date().toISOString());\n    const startedAt = toIso(now);\n    const intakeSnapshot = await (deps.loadIntakeSnapshot ?? loadIntakeSnapshot)(input.intakeId);\n    const wf3Snapshot = await (deps.loadWf3Snapshot ?? loadWf3Snapshot)(input.wf3RunId);\n    const promptBundleVersion = _prompts__WEBPACK_IMPORTED_MODULE_5__.WF4_PROMPT_BUNDLE_VERSION;\n    const runId = crypto__WEBPACK_IMPORTED_MODULE_0___default().randomUUID();\n    const schemaAllowlist = buildSchemaAllowlist();\n    const countyLookup = (0,_counties__WEBPACK_IMPORTED_MODULE_2__.loadWf4Counties)();\n    const counties = countyLookup.canonicalList;\n    const taskCatalog = (0,_taskCatalog__WEBPACK_IMPORTED_MODULE_3__.loadWf4TaskCatalog)();\n    const provider = deps.llmProvider;\n    const taskOutputs = {};\n    const runOutput = {\n        task_outputs: taskOutputs\n    };\n    const taskStatuses = {};\n    if (!provider) {\n        const completedAt = toIso(now);\n        const runLog = {\n            wf4_run_id: runId,\n            intake_id: intakeSnapshot.intake_id,\n            wf3_run_id: wf3Snapshot.wf3_run_id,\n            started_at: startedAt,\n            completed_at: completedAt,\n            status: 'FAIL',\n            prompt_bundle_version: promptBundleVersion,\n            per_task: {},\n            input_refs: {\n                intake_id: intakeSnapshot.intake_id,\n                wf3_run_id: wf3Snapshot.wf3_run_id,\n                firm_id: intakeSnapshot.firm_id ?? null\n            }\n        };\n        await (deps.storeRun ?? storeRun)({\n            runLog,\n            runOutput\n        });\n        return {\n            runLog,\n            runOutput\n        };\n    }\n    const context = {\n        intakeSnapshot,\n        wf3Snapshot,\n        schemaAllowlist,\n        countyReference: counties,\n        previousOutputs: runOutput\n    };\n    let failedCount = 0;\n    for (const task of taskCatalog.tasks){\n        const taskId = task.task_id;\n        const promptId = _prompts__WEBPACK_IMPORTED_MODULE_5__.WF4_TASK_PROMPT_MAP[taskId] ?? taskId;\n        const taskInput = buildTaskInput(taskId, context);\n        let output = null;\n        let error;\n        try {\n            const rawResult = await runTask(provider, promptId, taskInput);\n            if (!rawResult.ok) {\n                throw new Error(rawResult.error);\n            }\n            output = rawResult.value;\n            let validation = {\n                ok: true,\n                value: output\n            };\n            if (taskId === 'wf4.extract.schema_fields.v1') {\n                validation = validateExtractionOutput(output);\n            } else if (taskId === 'wf4.flags.dv_indicators.v1' || taskId === 'wf4.flags.jurisdiction_complexity.v1' || taskId === 'wf4.flags.custody_conflict.v1') {\n                validation = validateFlagsOutput(output);\n            } else if (taskId === 'wf4.consistency.cross_field.v1') {\n                validation = validateInconsistenciesOutput(output);\n            } else if (taskId === 'wf4.normalize.county_mentions.v1') {\n                validation = validateCountyMentionsOutput(output, counties);\n            } else if (taskId === 'wf4.review_attention.summary.v1') {\n                validation = validateReviewAttentionOutput(output);\n            }\n            if (!validation.ok) {\n                throw new Error(validation.error);\n            }\n            taskOutputs[taskId] = {\n                task_id: taskId,\n                prompt_id: promptId,\n                status: 'SUCCESS',\n                output: validation.value\n            };\n            if (taskId === 'wf4.extract.schema_fields.v1') {\n                runOutput.extractions = validation.value;\n            }\n            if (taskId === 'wf4.flags.dv_indicators.v1') {\n                runOutput.flags = {\n                    ...runOutput.flags ?? {},\n                    dv_indicators: validation.value\n                };\n            }\n            if (taskId === 'wf4.flags.jurisdiction_complexity.v1') {\n                runOutput.flags = {\n                    ...runOutput.flags ?? {},\n                    jurisdiction_complexity: validation.value\n                };\n            }\n            if (taskId === 'wf4.flags.custody_conflict.v1') {\n                runOutput.flags = {\n                    ...runOutput.flags ?? {},\n                    custody_conflict: validation.value\n                };\n            }\n            if (taskId === 'wf4.consistency.cross_field.v1') {\n                runOutput.inconsistencies = validation.value;\n            }\n            if (taskId === 'wf4.normalize.county_mentions.v1') {\n                runOutput.county_mentions = validation.value;\n            }\n            if (taskId === 'wf4.review_attention.summary.v1') {\n                runOutput.review_attention = validation.value;\n            }\n        } catch (taskError) {\n            failedCount += 1;\n            error = taskError instanceof Error ? taskError.message : 'Task failed';\n            taskOutputs[taskId] = {\n                task_id: taskId,\n                prompt_id: promptId,\n                status: 'FAILED',\n                output: null,\n                error\n            };\n        }\n        taskStatuses[taskId] = {\n            prompt_id: promptId,\n            status: taskOutputs[taskId].status,\n            error: taskOutputs[taskId].error\n        };\n    }\n    const completedAt = toIso(now);\n    const status = failedCount === taskCatalog.tasks.length ? 'FAIL' : failedCount > 0 ? 'PARTIAL' : 'SUCCESS';\n    const runLog = {\n        wf4_run_id: runId,\n        intake_id: intakeSnapshot.intake_id,\n        wf3_run_id: wf3Snapshot.wf3_run_id,\n        started_at: startedAt,\n        completed_at: completedAt,\n        status,\n        model_provider: provider.provider,\n        model_name: provider.model,\n        prompt_bundle_version: promptBundleVersion,\n        per_task: taskStatuses,\n        input_refs: {\n            intake_id: intakeSnapshot.intake_id,\n            wf3_run_id: wf3Snapshot.wf3_run_id,\n            firm_id: intakeSnapshot.firm_id ?? null\n        }\n    };\n    await (deps.storeRun ?? storeRun)({\n        runLog,\n        runOutput\n    });\n    return {\n        runLog,\n        runOutput\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3dzL3dmNC9ydW5XZjQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBNEI7QUFDMEQ7QUFDekM7QUFDTTtBQUNHO0FBTW5DO0FBMkJuQixTQUFTUSxTQUFTQyxLQUFjO0lBQzlCLE9BQU9DLFFBQVFELFVBQVUsT0FBT0EsVUFBVSxZQUFZLENBQUNFLE1BQU1DLE9BQU8sQ0FBQ0g7QUFDdkU7QUFFQSxTQUFTSSxNQUFNQyxHQUFrQjtJQUMvQixPQUFPQSxNQUFNQSxRQUFRLElBQUlDLE9BQU9DLFdBQVc7QUFDN0M7QUFFQSxTQUFTQztJQUNQLE9BQU9oQix3RkFBcUJBLENBQUNpQixRQUFRLENBQUNDLE9BQU8sQ0FBQyxDQUFDQyxVQUM3Q0EsUUFBUUMsTUFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQ0MsUUFBVSxDQUFDQSxNQUFNQyxRQUFRLEVBQUVDLEdBQUcsQ0FBQyxDQUFDRixRQUFVQSxNQUFNRyxHQUFHO0FBRTlFO0FBRUEsZUFBZUMsbUJBQW1CQyxRQUFnQjtJQUNoRCxNQUFNLEVBQUVDLGFBQWEsRUFBRSxHQUFHLE1BQU0sNktBQTJDO0lBQzNFLE1BQU0sRUFBRUMsTUFBTUMsTUFBTSxFQUFFQyxPQUFPQyxXQUFXLEVBQUUsR0FBRyxNQUFNSixjQUNoREssSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxzREFDUEMsRUFBRSxDQUFDLE1BQU1SLFVBQ1RTLFdBQVc7SUFFZCxJQUFJSixhQUFhO1FBQ2YsTUFBTSxJQUFJSyxNQUFNO0lBQ2xCO0lBQ0EsSUFBSSxDQUFDUCxRQUFRO1FBQ1gsTUFBTSxJQUFJTyxNQUFNO0lBQ2xCO0lBQ0EsSUFBSSxDQUFDUCxPQUFPUSxZQUFZLEVBQUU7UUFDeEIsTUFBTSxJQUFJRCxNQUFNO0lBQ2xCO0lBRUEsTUFBTSxFQUFFUixNQUFNVSxRQUFRLEVBQUVSLE9BQU9TLFlBQVksRUFBRSxHQUFHLE1BQU1aLGNBQ25ESyxJQUFJLENBQUMsbUJBQ0xDLE1BQU0sQ0FBQyxt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O1lBQ3JCbUMsV0FBVzVDO1lBQ1h4RCxRQUFReUYsV0FBVyxDQUFDeEIsT0FBTyxDQUFDakUsTUFBTTtZQUNsQ3BFLE9BQU82SixXQUFXLENBQUN4QixPQUFPLENBQUNySSxLQUFLO1FBQ2xDO0lBQ0Y7SUFFQSxNQUFNZ0ssY0FBY25MLE1BQU1DO0lBQzFCLE1BQU1zRixTQUNKNkYsZ0JBQWdCTixZQUFZUSxLQUFLLENBQUNyRCxNQUFNLEdBQ3BDLFNBQ0FtRCxjQUFjLElBQ1osWUFDQTtJQUVSLE1BQU0xRyxTQUFpQjtRQUNyQkcsWUFBWTZGO1FBQ1p2SSxXQUFXeUgsZUFBZXpILFNBQVM7UUFDbkN5QixZQUFZa0csWUFBWWxHLFVBQVU7UUFDbEN5QixZQUFZbUY7UUFDWmxGLGNBQWM2RjtRQUNkNUY7UUFDQXlHLGdCQUFnQmxELFNBQVNBLFFBQVE7UUFDakM5RCxZQUFZOEQsU0FBU21ELEtBQUs7UUFDMUIvRyx1QkFBdUJ1RjtRQUN2QnJGLFVBQVU4RjtRQUNWcEcsWUFBWTtZQUNWM0MsV0FBV3lILGVBQWV6SCxTQUFTO1lBQ25DeUIsWUFBWWtHLFlBQVlsRyxVQUFVO1lBQ2xDUCxTQUFTdUcsZUFBZXZHLE9BQU8sSUFBSTtRQUNyQztJQUNGO0lBRUEsTUFBTSxDQUFDa0gsS0FBSy9GLFFBQVEsSUFBSUEsUUFBTyxFQUFHO1FBQUVFO1FBQVFDO0lBQVU7SUFFdEQsT0FBTztRQUFFRDtRQUFRQztJQUFVO0FBQzdCIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL3NyYy93b3JrZmxvd3Mvd2Y0L3J1bldmNC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgeyBHQV9ESVZPUkNFX0NVU1RPRFlfVjEgfSBmcm9tICcuLi8uLi8uLi9saWIvaW50YWtlL3NjaGVtYS9nYURpdm9yY2VDdXN0b2R5VjEnO1xuaW1wb3J0IHsgbG9hZFdmNENvdW50aWVzIH0gZnJvbSAnLi9jb3VudGllcyc7XG5pbXBvcnQgeyBsb2FkV2Y0VGFza0NhdGFsb2cgfSBmcm9tICcuL3Rhc2tDYXRhbG9nJztcbmltcG9ydCB7IHZhbGlkYXRlRXZpZGVuY2VQb2ludGVycyB9IGZyb20gJy4vZXZpZGVuY2UnO1xuaW1wb3J0IHtcbiAgV0Y0X1BST01QVF9CVU5ETEVfVkVSU0lPTixcbiAgV0Y0X1BST01QVF9JRFMsXG4gIFdGNF9QUk9NUFRfVEVNUExBVEVTLFxuICBXRjRfVEFTS19QUk9NUFRfTUFQLFxufSBmcm9tICcuL3Byb21wdHMnO1xuaW1wb3J0IHR5cGUge1xuICBDb3VudHlNZW50aW9uLFxuICBFeHRyYWN0aW9uSXRlbSxcbiAgRmxhZ0l0ZW0sXG4gIEluY29uc2lzdGVuY3lJdGVtLFxuICBJbnRha2VTbmFwc2hvdCxcbiAgTGxtUHJvdmlkZXIsXG4gIFJldmlld0F0dGVudGlvbixcbiAgUnVuTG9nLFxuICBSdW5PdXRwdXQsXG4gIFJ1bldmNERlcGVuZGVuY2llcyxcbiAgUnVuV2Y0SW5wdXQsXG4gIFRhc2tSZXN1bHQsXG4gIFdmM1NuYXBzaG90LFxufSBmcm9tICcuL3R5cGVzJztcblxudHlwZSBUYXNrVmFsaWRhdGlvblJlc3VsdDxUPiA9IHsgb2s6IHRydWU7IHZhbHVlOiBUIH0gfCB7IG9rOiBmYWxzZTsgZXJyb3I6IHN0cmluZyB9O1xuXG50eXBlIFRhc2tDb250ZXh0ID0ge1xuICBpbnRha2VTbmFwc2hvdDogSW50YWtlU25hcHNob3Q7XG4gIHdmM1NuYXBzaG90OiBXZjNTbmFwc2hvdDtcbiAgc2NoZW1hQWxsb3dsaXN0OiBzdHJpbmdbXTtcbiAgY291bnR5UmVmZXJlbmNlOiBzdHJpbmdbXTtcbiAgcHJldmlvdXNPdXRwdXRzOiBSdW5PdXRwdXQ7XG59O1xuXG5mdW5jdGlvbiBpc1JlY29yZCh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgcmV0dXJuIEJvb2xlYW4odmFsdWUpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuXG5mdW5jdGlvbiB0b0lzbyhub3c/OiAoKSA9PiBzdHJpbmcpIHtcbiAgcmV0dXJuIG5vdyA/IG5vdygpIDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xufVxuXG5mdW5jdGlvbiBidWlsZFNjaGVtYUFsbG93bGlzdCgpIHtcbiAgcmV0dXJuIEdBX0RJVk9SQ0VfQ1VTVE9EWV9WMS5zZWN0aW9ucy5mbGF0TWFwKChzZWN0aW9uKSA9PlxuICAgIHNlY3Rpb24uZmllbGRzLmZpbHRlcigoZmllbGQpID0+ICFmaWVsZC5pc1N5c3RlbSkubWFwKChmaWVsZCkgPT4gZmllbGQua2V5KSxcbiAgKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gbG9hZEludGFrZVNuYXBzaG90KGludGFrZUlkOiBzdHJpbmcpOiBQcm9taXNlPEludGFrZVNuYXBzaG90PiB7XG4gIGNvbnN0IHsgc3VwYWJhc2VBZG1pbiB9ID0gYXdhaXQgaW1wb3J0KCcuLi8uLi8uLi9saWIvc2VydmVyL3N1cGFiYXNlQWRtaW4nKTtcbiAgY29uc3QgeyBkYXRhOiBpbnRha2UsIGVycm9yOiBpbnRha2VFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdpbnRha2VzJylcbiAgICAuc2VsZWN0KCdpZCwgZmlybV9pZCwgc3VibWl0dGVkX2F0LCByYXdfcGF5bG9hZCwgY3JlYXRlZF9hdCcpXG4gICAgLmVxKCdpZCcsIGludGFrZUlkKVxuICAgIC5tYXliZVNpbmdsZSgpO1xuXG4gIGlmIChpbnRha2VFcnJvcikge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGxvYWQgaW50YWtlIHNuYXBzaG90Jyk7XG4gIH1cbiAgaWYgKCFpbnRha2UpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGFrZSBub3QgZm91bmQnKTtcbiAgfVxuICBpZiAoIWludGFrZS5zdWJtaXR0ZWRfYXQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGFrZSBub3Qgc3VibWl0dGVkJyk7XG4gIH1cblxuICBjb25zdCB7IGRhdGE6IG1lc3NhZ2VzLCBlcnJvcjogbWVzc2FnZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgLmZyb20oJ2ludGFrZV9tZXNzYWdlcycpXG4gICAgLnNlbGVjdCgnaWQsIHNvdXJjZSwgY29udGVudCwgY3JlYXRlZF9hdCcpXG4gICAgLmVxKCdpbnRha2VfaWQnLCBpbnRha2VJZClcbiAgICAub3JkZXIoJ3NlcScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pO1xuXG4gIGlmIChtZXNzYWdlRXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2FkIGludGFrZSBtZXNzYWdlcycpO1xuICB9XG5cbiAgY29uc3QgeyBkYXRhOiBkb2N1bWVudHMsIGVycm9yOiBkb2N1bWVudHNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdpbnRha2VfZG9jdW1lbnRzJylcbiAgICAuc2VsZWN0KCdpZCwgc3RvcmFnZV9vYmplY3RfcGF0aCwgZG9jdW1lbnRfdHlwZSwgY3JlYXRlZF9hdCcpXG4gICAgLmVxKCdpbnRha2VfaWQnLCBpbnRha2VJZClcbiAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICBpZiAoZG9jdW1lbnRzRXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2FkIGludGFrZSBkb2N1bWVudHMnKTtcbiAgfVxuXG4gIGNvbnN0IHN0cnVjdHVyZWRGaWVsZHMgPSBpc1JlY29yZChpbnRha2UucmF3X3BheWxvYWQpID8gaW50YWtlLnJhd19wYXlsb2FkIDoge307XG5cbiAgcmV0dXJuIHtcbiAgICBpbnRha2VfaWQ6IGludGFrZS5pZCxcbiAgICBzdWJtaXNzaW9uX2lkOiBpbnRha2UuaWQsXG4gICAgc3RydWN0dXJlZF9maWVsZHM6IHN0cnVjdHVyZWRGaWVsZHMsXG4gICAgZnJlZV90ZXh0X2ZpZWxkczoge30sXG4gICAgbWVzc2FnZXM6IChtZXNzYWdlcyA/PyBbXSkubWFwKChtZXNzYWdlKSA9PiAoe1xuICAgICAgbWVzc2FnZV9pZDogbWVzc2FnZS5pZCxcbiAgICAgIHJvbGU6IG1lc3NhZ2Uuc291cmNlLFxuICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LFxuICAgICAgY3JlYXRlZF9hdDogbWVzc2FnZS5jcmVhdGVkX2F0LFxuICAgIH0pKSxcbiAgICBkb2N1bWVudHM6IChkb2N1bWVudHMgPz8gW10pLm1hcCgoZG9jKSA9PiAoe1xuICAgICAgZG9jdW1lbnRfaWQ6IGRvYy5pZCxcbiAgICAgIGZpbGVuYW1lOiBkb2Muc3RvcmFnZV9vYmplY3RfcGF0aCA/PyBudWxsLFxuICAgICAgbWltZXR5cGU6IGRvYy5kb2N1bWVudF90eXBlID8/IG51bGwsXG4gICAgICB0ZXh0X2V4dHJhY3Q6IG51bGwsXG4gICAgICBjcmVhdGVkX2F0OiBkb2MuY3JlYXRlZF9hdCxcbiAgICB9KSksXG4gICAgY3JlYXRlZF9hdDogaW50YWtlLmNyZWF0ZWRfYXQsXG4gICAgZmlybV9pZDogaW50YWtlLmZpcm1faWQsXG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGxvYWRXZjNTbmFwc2hvdCh3ZjNSdW5JZDogc3RyaW5nKTogUHJvbWlzZTxXZjNTbmFwc2hvdD4ge1xuICBjb25zdCB7IHN1cGFiYXNlQWRtaW4gfSA9IGF3YWl0IGltcG9ydCgnLi4vLi4vLi4vbGliL3NlcnZlci9zdXBhYmFzZUFkbWluJyk7XG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cbiAgICAuZnJvbSgnaW50YWtlX2V4dHJhY3Rpb25zJylcbiAgICAuc2VsZWN0KCdpZCwgZXh0cmFjdGVkX2RhdGEsIGNyZWF0ZWRfYXQnKVxuICAgIC5lcSgnaWQnLCB3ZjNSdW5JZClcbiAgICAubWF5YmVTaW5nbGUoKTtcblxuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2FkIFdGMyBzbmFwc2hvdCcpO1xuICB9XG4gIGlmICghZGF0YSkge1xuICAgIHRocm93IG5ldyBFcnJvcignV0YzIHNuYXBzaG90IG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgY29uc3QgZXh0cmFjdGVkID0gZGF0YS5leHRyYWN0ZWRfZGF0YSBhcyB7IHJ1bGVzX2VuZ2luZT86IGFueSB9IHwgbnVsbDtcbiAgY29uc3QgcnVsZXNFbmdpbmUgPSBleHRyYWN0ZWQ/LnJ1bGVzX2VuZ2luZSA/PyBudWxsO1xuICBpZiAoIXJ1bGVzRW5naW5lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdXRjMgc25hcHNob3QgbWlzc2luZyBydWxlc19lbmdpbmUnKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2YzX3J1bl9pZDogZGF0YS5pZCxcbiAgICB2YWxpZGF0aW9uX3N1bW1hcnk6IHtcbiAgICAgIHJ1bGVfcmVzdWx0czogKHJ1bGVzRW5naW5lLnJ1bGVfZXZhbHVhdGlvbnMgPz8gW10pLm1hcCgoZW50cnk6IGFueSkgPT4gKHtcbiAgICAgICAgcnVsZV9pZDogU3RyaW5nKGVudHJ5LnJ1bGVfaWQgPz8gJycpLFxuICAgICAgICBwYXNzZWQ6IEJvb2xlYW4oZW50cnkucGFzc2VkKSxcbiAgICAgICAgZmllbGRfcGF0aHM6IEFycmF5LmlzQXJyYXkoZW50cnkuZmllbGRfcGF0aHMpID8gZW50cnkuZmllbGRfcGF0aHMgOiBbXSxcbiAgICAgICAgbWVzc2FnZTogZW50cnkubWVzc2FnZSA/PyB1bmRlZmluZWQsXG4gICAgICB9KSksXG4gICAgICByZXF1aXJlZF9maWVsZHNfbWlzc2luZzogQXJyYXkuaXNBcnJheShydWxlc0VuZ2luZS5yZXF1aXJlZF9maWVsZHNfbWlzc2luZylcbiAgICAgICAgPyBydWxlc0VuZ2luZS5yZXF1aXJlZF9maWVsZHNfbWlzc2luZ1xuICAgICAgICA6IFtdLFxuICAgIH0sXG4gICAgY2Fub25pY2FsX2ZpZWxkczoge30sXG4gICAgY3JlYXRlZF9hdDogZGF0YS5jcmVhdGVkX2F0LFxuICB9O1xufVxuXG5hc3luYyBmdW5jdGlvbiBzdG9yZVJ1bihhcmdzOiB7IHJ1bkxvZzogUnVuTG9nOyBydW5PdXRwdXQ6IFJ1bk91dHB1dCB9KSB7XG4gIGNvbnN0IHsgc3VwYWJhc2VBZG1pbiB9ID0gYXdhaXQgaW1wb3J0KCcuLi8uLi8uLi9saWIvc2VydmVyL3N1cGFiYXNlQWRtaW4nKTtcbiAgY29uc3QgeyBydW5Mb2csIHJ1bk91dHB1dCB9ID0gYXJncztcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdhaV9ydW5zJylcbiAgICAuaW5zZXJ0KHtcbiAgICAgIGlkOiBydW5Mb2cud2Y0X3J1bl9pZCxcbiAgICAgIGZpcm1faWQ6IHJ1bkxvZy5pbnB1dF9yZWZzLmZpcm1faWQsXG4gICAgICBpbnRha2VfaWQ6IHJ1bkxvZy5pbnRha2VfaWQsXG4gICAgICBydW5fa2luZDogJ3dmNCcsXG4gICAgICBtb2RlbF9uYW1lOiBydW5Mb2cubW9kZWxfbmFtZSA/PyBudWxsLFxuICAgICAgcHJvbXB0X2hhc2g6IHJ1bkxvZy5wcm9tcHRfYnVuZGxlX3ZlcnNpb24sXG4gICAgICBpbnB1dHM6IHtcbiAgICAgICAgd2YzX3J1bl9pZDogcnVuTG9nLndmM19ydW5faWQgPz8gbnVsbCxcbiAgICAgICAgcHJvbXB0X2J1bmRsZV92ZXJzaW9uOiBydW5Mb2cucHJvbXB0X2J1bmRsZV92ZXJzaW9uLFxuICAgICAgICBwZXJfdGFzazogcnVuTG9nLnBlcl90YXNrLFxuICAgICAgICBpbnB1dF9yZWZzOiBydW5Mb2cuaW5wdXRfcmVmcyxcbiAgICAgICAgc3RhcnRlZF9hdDogcnVuTG9nLnN0YXJ0ZWRfYXQsXG4gICAgICAgIGNvbXBsZXRlZF9hdDogcnVuTG9nLmNvbXBsZXRlZF9hdCxcbiAgICAgICAgc3RhdHVzOiBydW5Mb2cuc3RhdHVzLFxuICAgICAgfSxcbiAgICAgIG91dHB1dHM6IHtcbiAgICAgICAgcnVuX2xvZzogcnVuTG9nLFxuICAgICAgICBydW5fb3V0cHV0OiBydW5PdXRwdXQsXG4gICAgICB9LFxuICAgICAgc3RhdHVzOiBydW5Mb2cuc3RhdHVzLnRvTG93ZXJDYXNlKCksXG4gICAgfSlcbiAgICAuc2VsZWN0KCdpZCcpXG4gICAgLnNpbmdsZSgpO1xuXG4gIGlmIChlcnJvciB8fCAhZGF0YSkge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIHN0b3JlIFdGNCBydW4nKTtcbiAgfVxuXG4gIHJldHVybiB7IHdmNF9ydW5faWQ6IGRhdGEuaWQgfTtcbn1cblxuZnVuY3Rpb24gcGFyc2VKc29uT3V0cHV0KHJhdzogdW5rbm93bik6IFRhc2tWYWxpZGF0aW9uUmVzdWx0PFJlY29yZDxzdHJpbmcsIHVua25vd24+PiB7XG4gIGlmIChpc1JlY29yZChyYXcpKSB7XG4gICAgcmV0dXJuIHsgb2s6IHRydWUsIHZhbHVlOiByYXcgfTtcbiAgfVxuICBpZiAodHlwZW9mIHJhdyA9PT0gJ3N0cmluZycpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShyYXcpIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgICAgaWYgKCFpc1JlY29yZChwYXJzZWQpKSB7XG4gICAgICAgIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdQYXJzZWQgb3V0cHV0IGlzIG5vdCBhbiBvYmplY3QnIH07XG4gICAgICB9XG4gICAgICByZXR1cm4geyBvazogdHJ1ZSwgdmFsdWU6IHBhcnNlZCB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBKU09OIG91dHB1dCcgfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ091dHB1dCBpcyBub3QgSlNPTicgfTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVFeHRyYWN0aW9uT3V0cHV0KG91dHB1dDogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBUYXNrVmFsaWRhdGlvblJlc3VsdDx7IGV4dHJhY3Rpb25zOiBFeHRyYWN0aW9uSXRlbVtdIH0+IHtcbiAgY29uc3QgZXh0cmFjdGlvbnMgPSBvdXRwdXQuZXh0cmFjdGlvbnM7XG4gIGlmICghQXJyYXkuaXNBcnJheShleHRyYWN0aW9ucykpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZXh0cmFjdGlvbnMgbXVzdCBiZSBhbiBhcnJheScgfTtcbiAgfVxuICBmb3IgKGNvbnN0IGl0ZW0gb2YgZXh0cmFjdGlvbnMpIHtcbiAgICBpZiAoIWlzUmVjb3JkKGl0ZW0pKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZXh0cmFjdGlvbiBpdGVtIG11c3QgYmUgb2JqZWN0JyB9O1xuICAgIGlmICh0eXBlb2YgaXRlbS5maWVsZF9rZXkgIT09ICdzdHJpbmcnKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZmllbGRfa2V5IG1pc3NpbmcnIH07XG4gICAgaWYgKHR5cGVvZiBpdGVtLnZhbHVlX3R5cGUgIT09ICdzdHJpbmcnKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAndmFsdWVfdHlwZSBtaXNzaW5nJyB9O1xuICAgIGlmICh0eXBlb2YgaXRlbS5jb25maWRlbmNlX3Njb3JlICE9PSAnbnVtYmVyJykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2NvbmZpZGVuY2Vfc2NvcmUgbWlzc2luZycgfTtcbiAgICBpZiAodHlwZW9mIGl0ZW0uY29uZmlkZW5jZV9sZXZlbCAhPT0gJ3N0cmluZycpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdjb25maWRlbmNlX2xldmVsIG1pc3NpbmcnIH07XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW0uZXZpZGVuY2UpKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZXZpZGVuY2UgbWlzc2luZycgfTtcbiAgICBjb25zdCBldmlkZW5jZUNoZWNrID0gdmFsaWRhdGVFdmlkZW5jZVBvaW50ZXJzKGl0ZW0uZXZpZGVuY2UgYXMgRXh0cmFjdGlvbkl0ZW1bJ2V2aWRlbmNlJ10pO1xuICAgIGlmICghZXZpZGVuY2VDaGVjay5vaykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogZXZpZGVuY2VDaGVjay5lcnJvciB9O1xuICB9XG4gIHJldHVybiB7IG9rOiB0cnVlLCB2YWx1ZTogeyBleHRyYWN0aW9uczogZXh0cmFjdGlvbnMgYXMgRXh0cmFjdGlvbkl0ZW1bXSB9IH07XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlRmxhZ3NPdXRwdXQob3V0cHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IFRhc2tWYWxpZGF0aW9uUmVzdWx0PHsgZmxhZ3M6IEZsYWdJdGVtW10gfT4ge1xuICBjb25zdCBmbGFncyA9IG91dHB1dC5mbGFncztcbiAgaWYgKCFBcnJheS5pc0FycmF5KGZsYWdzKSkge1xuICAgIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdmbGFncyBtdXN0IGJlIGFuIGFycmF5JyB9O1xuICB9XG4gIGZvciAoY29uc3QgaXRlbSBvZiBmbGFncykge1xuICAgIGlmICghaXNSZWNvcmQoaXRlbSkpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdmbGFnIGl0ZW0gbXVzdCBiZSBvYmplY3QnIH07XG4gICAgaWYgKHR5cGVvZiBpdGVtLmZsYWdfa2V5ICE9PSAnc3RyaW5nJykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2ZsYWdfa2V5IG1pc3NpbmcnIH07XG4gICAgaWYgKHR5cGVvZiBpdGVtLmZsYWdfcHJlc2VudCAhPT0gJ2Jvb2xlYW4nKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZmxhZ19wcmVzZW50IG1pc3NpbmcnIH07XG4gICAgaWYgKHR5cGVvZiBpdGVtLmNvbmZpZGVuY2Vfc2NvcmUgIT09ICdudW1iZXInKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnY29uZmlkZW5jZV9zY29yZSBtaXNzaW5nJyB9O1xuICAgIGlmICh0eXBlb2YgaXRlbS5jb25maWRlbmNlX2xldmVsICE9PSAnc3RyaW5nJykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2NvbmZpZGVuY2VfbGV2ZWwgbWlzc2luZycgfTtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoaXRlbS5ldmlkZW5jZSkpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdldmlkZW5jZSBtaXNzaW5nJyB9O1xuICAgIGNvbnN0IGV2aWRlbmNlQ2hlY2sgPSB2YWxpZGF0ZUV2aWRlbmNlUG9pbnRlcnMoaXRlbS5ldmlkZW5jZSBhcyBGbGFnSXRlbVsnZXZpZGVuY2UnXSk7XG4gICAgaWYgKCFldmlkZW5jZUNoZWNrLm9rKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiBldmlkZW5jZUNoZWNrLmVycm9yIH07XG4gICAgaWYgKHR5cGVvZiBpdGVtLndoeV9pdF9tYXR0ZXJzX2Zvcl9yZXZpZXcgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnd2h5X2l0X21hdHRlcnNfZm9yX3JldmlldyBtaXNzaW5nJyB9O1xuICAgIH1cbiAgfVxuICByZXR1cm4geyBvazogdHJ1ZSwgdmFsdWU6IHsgZmxhZ3M6IGZsYWdzIGFzIEZsYWdJdGVtW10gfSB9O1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZUluY29uc2lzdGVuY2llc091dHB1dChcbiAgb3V0cHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbik6IFRhc2tWYWxpZGF0aW9uUmVzdWx0PHsgaW5jb25zaXN0ZW5jaWVzOiBJbmNvbnNpc3RlbmN5SXRlbVtdIH0+IHtcbiAgY29uc3QgaW5jb25zaXN0ZW5jaWVzID0gb3V0cHV0LmluY29uc2lzdGVuY2llcztcbiAgaWYgKCFBcnJheS5pc0FycmF5KGluY29uc2lzdGVuY2llcykpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnaW5jb25zaXN0ZW5jaWVzIG11c3QgYmUgYW4gYXJyYXknIH07XG4gIH1cbiAgZm9yIChjb25zdCBpdGVtIG9mIGluY29uc2lzdGVuY2llcykge1xuICAgIGlmICghaXNSZWNvcmQoaXRlbSkpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdpbmNvbnNpc3RlbmN5IGl0ZW0gbXVzdCBiZSBvYmplY3QnIH07XG4gICAgaWYgKHR5cGVvZiBpdGVtLmluY29uc2lzdGVuY3lfa2V5ICE9PSAnc3RyaW5nJykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2luY29uc2lzdGVuY3lfa2V5IG1pc3NpbmcnIH07XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW0uZmllbGRzX2ludm9sdmVkKSkgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2ZpZWxkc19pbnZvbHZlZCBtaXNzaW5nJyB9O1xuICAgIGlmICh0eXBlb2YgaXRlbS5zdW1tYXJ5ICE9PSAnc3RyaW5nJykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ3N1bW1hcnkgbWlzc2luZycgfTtcbiAgICBpZiAodHlwZW9mIGl0ZW0uc2V2ZXJpdHkgIT09ICdzdHJpbmcnKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnc2V2ZXJpdHkgbWlzc2luZycgfTtcbiAgICBpZiAodHlwZW9mIGl0ZW0uY29uZmlkZW5jZV9zY29yZSAhPT0gJ251bWJlcicpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdjb25maWRlbmNlX3Njb3JlIG1pc3NpbmcnIH07XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW0uZXZpZGVuY2UpKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZXZpZGVuY2UgbWlzc2luZycgfTtcbiAgICBjb25zdCBldmlkZW5jZUNoZWNrID0gdmFsaWRhdGVFdmlkZW5jZVBvaW50ZXJzKGl0ZW0uZXZpZGVuY2UgYXMgSW5jb25zaXN0ZW5jeUl0ZW1bJ2V2aWRlbmNlJ10pO1xuICAgIGlmICghZXZpZGVuY2VDaGVjay5vaykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogZXZpZGVuY2VDaGVjay5lcnJvciB9O1xuICB9XG4gIHJldHVybiB7IG9rOiB0cnVlLCB2YWx1ZTogeyBpbmNvbnNpc3RlbmNpZXM6IGluY29uc2lzdGVuY2llcyBhcyBJbmNvbnNpc3RlbmN5SXRlbVtdIH0gfTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVDb3VudHlNZW50aW9uc091dHB1dChcbiAgb3V0cHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgY2Fub25pY2FsTGlzdD86IHN0cmluZ1tdLFxuKTogVGFza1ZhbGlkYXRpb25SZXN1bHQ8e1xuICBjb3VudHlfbWVudGlvbnM6IENvdW50eU1lbnRpb25bXTtcbiAgZGVmZXJlbmNlOiB7IHdmM19jYW5vbmljYWxfY291bnR5X3ByZXNlbnQ6IGJvb2xlYW47IHdmM19jYW5vbmljYWxfY291bnR5X3ZhbHVlPzogc3RyaW5nIH07XG59PiB7XG4gIGNvbnN0IGNvdW50eU1lbnRpb25zID0gb3V0cHV0LmNvdW50eV9tZW50aW9ucztcbiAgY29uc3QgZGVmZXJlbmNlID0gb3V0cHV0LmRlZmVyZW5jZTtcbiAgaWYgKCFBcnJheS5pc0FycmF5KGNvdW50eU1lbnRpb25zKSkge1xuICAgIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdjb3VudHlfbWVudGlvbnMgbXVzdCBiZSBhbiBhcnJheScgfTtcbiAgfVxuICBpZiAoIWlzUmVjb3JkKGRlZmVyZW5jZSkgfHwgdHlwZW9mIGRlZmVyZW5jZS53ZjNfY2Fub25pY2FsX2NvdW50eV9wcmVzZW50ICE9PSAnYm9vbGVhbicpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZGVmZXJlbmNlIG1pc3NpbmcnIH07XG4gIH1cbiAgZm9yIChjb25zdCBpdGVtIG9mIGNvdW50eU1lbnRpb25zKSB7XG4gICAgaWYgKCFpc1JlY29yZChpdGVtKSkgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ2NvdW50eSBtZW50aW9uIG11c3QgYmUgb2JqZWN0JyB9O1xuICAgIGlmICh0eXBlb2YgaXRlbS5yYXdfbWVudGlvbiAhPT0gJ3N0cmluZycpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdyYXdfbWVudGlvbiBtaXNzaW5nJyB9O1xuICAgIGlmICh0eXBlb2YgaXRlbS5tYXRjaF90eXBlICE9PSAnc3RyaW5nJykgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ21hdGNoX3R5cGUgbWlzc2luZycgfTtcbiAgICBpZiAodHlwZW9mIGl0ZW0uY29uZmlkZW5jZV9zY29yZSAhPT0gJ251bWJlcicpIHJldHVybiB7IG9rOiBmYWxzZSwgZXJyb3I6ICdjb25maWRlbmNlX3Njb3JlIG1pc3NpbmcnIH07XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW0uZXZpZGVuY2UpKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAnZXZpZGVuY2UgbWlzc2luZycgfTtcbiAgICBpZiAoXG4gICAgICBpdGVtLnN1Z2dlc3RlZF9jb3VudHkgIT09IG51bGwgJiZcbiAgICAgIGl0ZW0uc3VnZ2VzdGVkX2NvdW50eSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICB0eXBlb2YgaXRlbS5zdWdnZXN0ZWRfY291bnR5ICE9PSAnc3RyaW5nJ1xuICAgICkge1xuICAgICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ3N1Z2dlc3RlZF9jb3VudHkgbXVzdCBiZSBzdHJpbmcgb3IgbnVsbCcgfTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgdHlwZW9mIGl0ZW0uc3VnZ2VzdGVkX2NvdW50eSA9PT0gJ3N0cmluZycgJiZcbiAgICAgIEFycmF5LmlzQXJyYXkoY2Fub25pY2FsTGlzdCkgJiZcbiAgICAgIGNhbm9uaWNhbExpc3QubGVuZ3RoID4gMCAmJlxuICAgICAgIWNhbm9uaWNhbExpc3QuaW5jbHVkZXMoaXRlbS5zdWdnZXN0ZWRfY291bnR5KVxuICAgICkge1xuICAgICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ3N1Z2dlc3RlZF9jb3VudHkgbm90IGluIGNhbm9uaWNhbCBsaXN0JyB9O1xuICAgIH1cbiAgICBjb25zdCBldmlkZW5jZUNoZWNrID0gdmFsaWRhdGVFdmlkZW5jZVBvaW50ZXJzKGl0ZW0uZXZpZGVuY2UgYXMgQ291bnR5TWVudGlvblsnZXZpZGVuY2UnXSk7XG4gICAgaWYgKCFldmlkZW5jZUNoZWNrLm9rKSByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiBldmlkZW5jZUNoZWNrLmVycm9yIH07XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBvazogdHJ1ZSxcbiAgICB2YWx1ZToge1xuICAgICAgY291bnR5X21lbnRpb25zOiBjb3VudHlNZW50aW9ucyBhcyBDb3VudHlNZW50aW9uW10sXG4gICAgICBkZWZlcmVuY2U6IHtcbiAgICAgICAgd2YzX2Nhbm9uaWNhbF9jb3VudHlfcHJlc2VudDogQm9vbGVhbihkZWZlcmVuY2Uud2YzX2Nhbm9uaWNhbF9jb3VudHlfcHJlc2VudCksXG4gICAgICAgIHdmM19jYW5vbmljYWxfY291bnR5X3ZhbHVlOlxuICAgICAgICAgIHR5cGVvZiBkZWZlcmVuY2Uud2YzX2Nhbm9uaWNhbF9jb3VudHlfdmFsdWUgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICA/IGRlZmVyZW5jZS53ZjNfY2Fub25pY2FsX2NvdW50eV92YWx1ZVxuICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICB9LFxuICAgIH0sXG4gIH07XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlUmV2aWV3QXR0ZW50aW9uT3V0cHV0KFxuICBvdXRwdXQ6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuKTogVGFza1ZhbGlkYXRpb25SZXN1bHQ8eyByZXZpZXdfYXR0ZW50aW9uOiBSZXZpZXdBdHRlbnRpb24gfT4ge1xuICBjb25zdCByZXZpZXdBdHRlbnRpb24gPSBvdXRwdXQucmV2aWV3X2F0dGVudGlvbjtcbiAgaWYgKCFpc1JlY29yZChyZXZpZXdBdHRlbnRpb24pKSB7XG4gICAgcmV0dXJuIHsgb2s6IGZhbHNlLCBlcnJvcjogJ3Jldmlld19hdHRlbnRpb24gbWlzc2luZycgfTtcbiAgfVxuICBjb25zdCBoaWdoID0gcmV2aWV3QXR0ZW50aW9uLmhpZ2hfcHJpb3JpdHlfaXRlbXM7XG4gIGNvbnN0IG1lZGl1bSA9IHJldmlld0F0dGVudGlvbi5tZWRpdW1fcHJpb3JpdHlfaXRlbXM7XG4gIGNvbnN0IGxvdyA9IHJldmlld0F0dGVudGlvbi5sb3dfcHJpb3JpdHlfaXRlbXM7XG4gIGlmICghQXJyYXkuaXNBcnJheShoaWdoKSB8fCAhQXJyYXkuaXNBcnJheShtZWRpdW0pIHx8ICFBcnJheS5pc0FycmF5KGxvdykpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIGVycm9yOiAncHJpb3JpdHkgbGlzdHMgbWlzc2luZycgfTtcbiAgfVxuICByZXR1cm4ge1xuICAgIG9rOiB0cnVlLFxuICAgIHZhbHVlOiB7XG4gICAgICByZXZpZXdfYXR0ZW50aW9uOiB7XG4gICAgICAgIGhpZ2hfcHJpb3JpdHlfaXRlbXM6IGhpZ2ggYXMgUmV2aWV3QXR0ZW50aW9uWydoaWdoX3ByaW9yaXR5X2l0ZW1zJ10sXG4gICAgICAgIG1lZGl1bV9wcmlvcml0eV9pdGVtczogbWVkaXVtIGFzIFJldmlld0F0dGVudGlvblsnbWVkaXVtX3ByaW9yaXR5X2l0ZW1zJ10sXG4gICAgICAgIGxvd19wcmlvcml0eV9pdGVtczogbG93IGFzIFJldmlld0F0dGVudGlvblsnbG93X3ByaW9yaXR5X2l0ZW1zJ10sXG4gICAgICB9LFxuICAgIH0sXG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJ1blRhc2soXG4gIHByb3ZpZGVyOiBMbG1Qcm92aWRlcixcbiAgcHJvbXB0SWQ6IHN0cmluZyxcbiAgaW5wdXQ6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuKTogUHJvbWlzZTxUYXNrVmFsaWRhdGlvblJlc3VsdDxSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4+IHtcbiAgY29uc3QgdGVtcGxhdGUgPSBXRjRfUFJPTVBUX1RFTVBMQVRFU1twcm9tcHRJZF07XG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IHRlbXBsYXRlPy5zeXN0ZW0gPz8gJ1VzZSB3ZjQuc3lzdGVtLnYxJztcbiAgY29uc3QgdXNlclByb21wdCA9IHRlbXBsYXRlPy51c2VyID8/ICdSZXR1cm4gSlNPTiBvbmx5Lic7XG5cbiAgY29uc3QgcmF3ID0gYXdhaXQgcHJvdmlkZXIuZ2VuZXJhdGVKc29uKHtcbiAgICBwcm9tcHRJZCxcbiAgICBzeXN0ZW1Qcm9tcHQsXG4gICAgdXNlclByb21wdCxcbiAgICBpbnB1dCxcbiAgfSk7XG5cbiAgcmV0dXJuIHBhcnNlSnNvbk91dHB1dChyYXcpO1xufVxuXG5mdW5jdGlvbiBidWlsZFRhc2tJbnB1dCh0YXNrSWQ6IHN0cmluZywgY29udGV4dDogVGFza0NvbnRleHQpIHtcbiAgY29uc3QgYmFzZSA9IHtcbiAgICBpbnRha2Vfc25hcHNob3Q6IGNvbnRleHQuaW50YWtlU25hcHNob3QsXG4gICAgd2YzX3NuYXBzaG90OiBjb250ZXh0LndmM1NuYXBzaG90LFxuICB9O1xuXG4gIHN3aXRjaCAodGFza0lkKSB7XG4gICAgY2FzZSAnd2Y0LmV4dHJhY3Quc2NoZW1hX2ZpZWxkcy52MSc6XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5iYXNlLFxuICAgICAgICBzY2hlbWFfYWxsb3dsaXN0OiBjb250ZXh0LnNjaGVtYUFsbG93bGlzdCxcbiAgICAgIH07XG4gICAgY2FzZSAnd2Y0Lm5vcm1hbGl6ZS5jb3VudHlfbWVudGlvbnMudjEnOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uYmFzZSxcbiAgICAgICAgcmVmZXJlbmNlOiB7XG4gICAgICAgICAgZ2FfY291bnRpZXM6IGNvbnRleHQuY291bnR5UmVmZXJlbmNlLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICBjYXNlICd3ZjQucmV2aWV3X2F0dGVudGlvbi5zdW1tYXJ5LnYxJzpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdmNF9vdXRwdXRzOiBjb250ZXh0LnByZXZpb3VzT3V0cHV0cyxcbiAgICAgIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBiYXNlO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5XZjQoXG4gIGlucHV0OiBSdW5XZjRJbnB1dCxcbiAgZGVwczogUnVuV2Y0RGVwZW5kZW5jaWVzID0ge30sXG4pOiBQcm9taXNlPHsgcnVuTG9nOiBSdW5Mb2c7IHJ1bk91dHB1dDogUnVuT3V0cHV0IH0+IHtcbiAgY29uc3Qgbm93ID0gZGVwcy5ub3cgPz8gKCgpID0+IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSk7XG4gIGNvbnN0IHN0YXJ0ZWRBdCA9IHRvSXNvKG5vdyk7XG5cbiAgY29uc3QgaW50YWtlU25hcHNob3QgPSBhd2FpdCAoZGVwcy5sb2FkSW50YWtlU25hcHNob3QgPz8gbG9hZEludGFrZVNuYXBzaG90KShpbnB1dC5pbnRha2VJZCk7XG4gIGNvbnN0IHdmM1NuYXBzaG90ID0gYXdhaXQgKGRlcHMubG9hZFdmM1NuYXBzaG90ID8/IGxvYWRXZjNTbmFwc2hvdCkoaW5wdXQud2YzUnVuSWQpO1xuXG4gIGNvbnN0IHByb21wdEJ1bmRsZVZlcnNpb24gPSBXRjRfUFJPTVBUX0JVTkRMRV9WRVJTSU9OO1xuICBjb25zdCBydW5JZCA9IGNyeXB0by5yYW5kb21VVUlEKCk7XG5cbiAgY29uc3Qgc2NoZW1hQWxsb3dsaXN0ID0gYnVpbGRTY2hlbWFBbGxvd2xpc3QoKTtcbiAgY29uc3QgY291bnR5TG9va3VwID0gbG9hZFdmNENvdW50aWVzKCk7XG4gIGNvbnN0IGNvdW50aWVzID0gY291bnR5TG9va3VwLmNhbm9uaWNhbExpc3Q7XG5cbiAgY29uc3QgdGFza0NhdGFsb2cgPSBsb2FkV2Y0VGFza0NhdGFsb2coKTtcbiAgY29uc3QgcHJvdmlkZXIgPSBkZXBzLmxsbVByb3ZpZGVyO1xuXG4gIGNvbnN0IHRhc2tPdXRwdXRzOiBSZWNvcmQ8c3RyaW5nLCBUYXNrUmVzdWx0PHVua25vd24+PiA9IHt9O1xuICBjb25zdCBydW5PdXRwdXQ6IFJ1bk91dHB1dCA9IHsgdGFza19vdXRwdXRzOiB0YXNrT3V0cHV0cyB9O1xuICBjb25zdCB0YXNrU3RhdHVzZXM6IFJ1bkxvZ1sncGVyX3Rhc2snXSA9IHt9O1xuXG4gIGlmICghcHJvdmlkZXIpIHtcbiAgICBjb25zdCBjb21wbGV0ZWRBdCA9IHRvSXNvKG5vdyk7XG4gICAgY29uc3QgcnVuTG9nOiBSdW5Mb2cgPSB7XG4gICAgICB3ZjRfcnVuX2lkOiBydW5JZCxcbiAgICAgIGludGFrZV9pZDogaW50YWtlU25hcHNob3QuaW50YWtlX2lkLFxuICAgICAgd2YzX3J1bl9pZDogd2YzU25hcHNob3Qud2YzX3J1bl9pZCxcbiAgICAgIHN0YXJ0ZWRfYXQ6IHN0YXJ0ZWRBdCxcbiAgICAgIGNvbXBsZXRlZF9hdDogY29tcGxldGVkQXQsXG4gICAgICBzdGF0dXM6ICdGQUlMJyxcbiAgICAgIHByb21wdF9idW5kbGVfdmVyc2lvbjogcHJvbXB0QnVuZGxlVmVyc2lvbixcbiAgICAgIHBlcl90YXNrOiB7fSxcbiAgICAgIGlucHV0X3JlZnM6IHtcbiAgICAgICAgaW50YWtlX2lkOiBpbnRha2VTbmFwc2hvdC5pbnRha2VfaWQsXG4gICAgICAgIHdmM19ydW5faWQ6IHdmM1NuYXBzaG90LndmM19ydW5faWQsXG4gICAgICAgIGZpcm1faWQ6IGludGFrZVNuYXBzaG90LmZpcm1faWQgPz8gbnVsbCxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGF3YWl0IChkZXBzLnN0b3JlUnVuID8/IHN0b3JlUnVuKSh7IHJ1bkxvZywgcnVuT3V0cHV0IH0pO1xuICAgIHJldHVybiB7IHJ1bkxvZywgcnVuT3V0cHV0IH07XG4gIH1cblxuICBjb25zdCBjb250ZXh0OiBUYXNrQ29udGV4dCA9IHtcbiAgICBpbnRha2VTbmFwc2hvdCxcbiAgICB3ZjNTbmFwc2hvdCxcbiAgICBzY2hlbWFBbGxvd2xpc3QsXG4gICAgY291bnR5UmVmZXJlbmNlOiBjb3VudGllcyxcbiAgICBwcmV2aW91c091dHB1dHM6IHJ1bk91dHB1dCxcbiAgfTtcblxuICBsZXQgZmFpbGVkQ291bnQgPSAwO1xuXG4gIGZvciAoY29uc3QgdGFzayBvZiB0YXNrQ2F0YWxvZy50YXNrcykge1xuICAgIGNvbnN0IHRhc2tJZCA9IHRhc2sudGFza19pZDtcbiAgICBjb25zdCBwcm9tcHRJZCA9IFdGNF9UQVNLX1BST01QVF9NQVBbdGFza0lkXSA/PyB0YXNrSWQ7XG4gICAgY29uc3QgdGFza0lucHV0ID0gYnVpbGRUYXNrSW5wdXQodGFza0lkLCBjb250ZXh0KTtcbiAgICBsZXQgb3V0cHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8IG51bGwgPSBudWxsO1xuICAgIGxldCBlcnJvcjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJhd1Jlc3VsdCA9IGF3YWl0IHJ1blRhc2socHJvdmlkZXIsIHByb21wdElkLCB0YXNrSW5wdXQpO1xuICAgICAgaWYgKCFyYXdSZXN1bHQub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJhd1Jlc3VsdC5lcnJvcik7XG4gICAgICB9XG4gICAgICBvdXRwdXQgPSByYXdSZXN1bHQudmFsdWU7XG5cbiAgICAgIGxldCB2YWxpZGF0aW9uOiBUYXNrVmFsaWRhdGlvblJlc3VsdDx1bmtub3duPiA9IHsgb2s6IHRydWUsIHZhbHVlOiBvdXRwdXQgfTtcbiAgICAgIGlmICh0YXNrSWQgPT09ICd3ZjQuZXh0cmFjdC5zY2hlbWFfZmllbGRzLnYxJykge1xuICAgICAgICB2YWxpZGF0aW9uID0gdmFsaWRhdGVFeHRyYWN0aW9uT3V0cHV0KG91dHB1dCk7XG4gICAgICB9IGVsc2UgaWYgKFxuICAgICAgICB0YXNrSWQgPT09ICd3ZjQuZmxhZ3MuZHZfaW5kaWNhdG9ycy52MScgfHxcbiAgICAgICAgdGFza0lkID09PSAnd2Y0LmZsYWdzLmp1cmlzZGljdGlvbl9jb21wbGV4aXR5LnYxJyB8fFxuICAgICAgICB0YXNrSWQgPT09ICd3ZjQuZmxhZ3MuY3VzdG9keV9jb25mbGljdC52MSdcbiAgICAgICkge1xuICAgICAgICB2YWxpZGF0aW9uID0gdmFsaWRhdGVGbGFnc091dHB1dChvdXRwdXQpO1xuICAgICAgfSBlbHNlIGlmICh0YXNrSWQgPT09ICd3ZjQuY29uc2lzdGVuY3kuY3Jvc3NfZmllbGQudjEnKSB7XG4gICAgICAgIHZhbGlkYXRpb24gPSB2YWxpZGF0ZUluY29uc2lzdGVuY2llc091dHB1dChvdXRwdXQpO1xuICAgICAgfSBlbHNlIGlmICh0YXNrSWQgPT09ICd3ZjQubm9ybWFsaXplLmNvdW50eV9tZW50aW9ucy52MScpIHtcbiAgICAgICAgdmFsaWRhdGlvbiA9IHZhbGlkYXRlQ291bnR5TWVudGlvbnNPdXRwdXQob3V0cHV0LCBjb3VudGllcyk7XG4gICAgICB9IGVsc2UgaWYgKHRhc2tJZCA9PT0gJ3dmNC5yZXZpZXdfYXR0ZW50aW9uLnN1bW1hcnkudjEnKSB7XG4gICAgICAgIHZhbGlkYXRpb24gPSB2YWxpZGF0ZVJldmlld0F0dGVudGlvbk91dHB1dChvdXRwdXQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXZhbGlkYXRpb24ub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHZhbGlkYXRpb24uZXJyb3IpO1xuICAgICAgfVxuXG4gICAgICB0YXNrT3V0cHV0c1t0YXNrSWRdID0ge1xuICAgICAgICB0YXNrX2lkOiB0YXNrSWQsXG4gICAgICAgIHByb21wdF9pZDogcHJvbXB0SWQsXG4gICAgICAgIHN0YXR1czogJ1NVQ0NFU1MnLFxuICAgICAgICBvdXRwdXQ6IHZhbGlkYXRpb24udmFsdWUsXG4gICAgICB9O1xuXG4gICAgICBpZiAodGFza0lkID09PSAnd2Y0LmV4dHJhY3Quc2NoZW1hX2ZpZWxkcy52MScpIHtcbiAgICAgICAgcnVuT3V0cHV0LmV4dHJhY3Rpb25zID0gdmFsaWRhdGlvbi52YWx1ZSBhcyB7IGV4dHJhY3Rpb25zOiBFeHRyYWN0aW9uSXRlbVtdIH07XG4gICAgICB9XG4gICAgICBpZiAodGFza0lkID09PSAnd2Y0LmZsYWdzLmR2X2luZGljYXRvcnMudjEnKSB7XG4gICAgICAgIHJ1bk91dHB1dC5mbGFncyA9IHtcbiAgICAgICAgICAuLi4ocnVuT3V0cHV0LmZsYWdzID8/IHt9KSxcbiAgICAgICAgICBkdl9pbmRpY2F0b3JzOiB2YWxpZGF0aW9uLnZhbHVlIGFzIHsgZmxhZ3M6IEZsYWdJdGVtW10gfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmICh0YXNrSWQgPT09ICd3ZjQuZmxhZ3MuanVyaXNkaWN0aW9uX2NvbXBsZXhpdHkudjEnKSB7XG4gICAgICAgIHJ1bk91dHB1dC5mbGFncyA9IHtcbiAgICAgICAgICAuLi4ocnVuT3V0cHV0LmZsYWdzID8/IHt9KSxcbiAgICAgICAgICBqdXJpc2RpY3Rpb25fY29tcGxleGl0eTogdmFsaWRhdGlvbi52YWx1ZSBhcyB7IGZsYWdzOiBGbGFnSXRlbVtdIH0sXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAodGFza0lkID09PSAnd2Y0LmZsYWdzLmN1c3RvZHlfY29uZmxpY3QudjEnKSB7XG4gICAgICAgIHJ1bk91dHB1dC5mbGFncyA9IHtcbiAgICAgICAgICAuLi4ocnVuT3V0cHV0LmZsYWdzID8/IHt9KSxcbiAgICAgICAgICBjdXN0b2R5X2NvbmZsaWN0OiB2YWxpZGF0aW9uLnZhbHVlIGFzIHsgZmxhZ3M6IEZsYWdJdGVtW10gfSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmICh0YXNrSWQgPT09ICd3ZjQuY29uc2lzdGVuY3kuY3Jvc3NfZmllbGQudjEnKSB7XG4gICAgICAgIHJ1bk91dHB1dC5pbmNvbnNpc3RlbmNpZXMgPSB2YWxpZGF0aW9uLnZhbHVlIGFzIHsgaW5jb25zaXN0ZW5jaWVzOiBJbmNvbnNpc3RlbmN5SXRlbVtdIH07XG4gICAgICB9XG4gICAgICBpZiAodGFza0lkID09PSAnd2Y0Lm5vcm1hbGl6ZS5jb3VudHlfbWVudGlvbnMudjEnKSB7XG4gICAgICAgIHJ1bk91dHB1dC5jb3VudHlfbWVudGlvbnMgPSB2YWxpZGF0aW9uLnZhbHVlIGFzIHtcbiAgICAgICAgICBjb3VudHlfbWVudGlvbnM6IENvdW50eU1lbnRpb25bXTtcbiAgICAgICAgICBkZWZlcmVuY2U6IHsgd2YzX2Nhbm9uaWNhbF9jb3VudHlfcHJlc2VudDogYm9vbGVhbjsgd2YzX2Nhbm9uaWNhbF9jb3VudHlfdmFsdWU/OiBzdHJpbmcgfTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmICh0YXNrSWQgPT09ICd3ZjQucmV2aWV3X2F0dGVudGlvbi5zdW1tYXJ5LnYxJykge1xuICAgICAgICBydW5PdXRwdXQucmV2aWV3X2F0dGVudGlvbiA9IHZhbGlkYXRpb24udmFsdWUgYXMgeyByZXZpZXdfYXR0ZW50aW9uOiBSZXZpZXdBdHRlbnRpb24gfTtcbiAgICAgIH1cbiAgICB9IGNhdGNoICh0YXNrRXJyb3IpIHtcbiAgICAgIGZhaWxlZENvdW50ICs9IDE7XG4gICAgICBlcnJvciA9IHRhc2tFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gdGFza0Vycm9yLm1lc3NhZ2UgOiAnVGFzayBmYWlsZWQnO1xuICAgICAgdGFza091dHB1dHNbdGFza0lkXSA9IHtcbiAgICAgICAgdGFza19pZDogdGFza0lkLFxuICAgICAgICBwcm9tcHRfaWQ6IHByb21wdElkLFxuICAgICAgICBzdGF0dXM6ICdGQUlMRUQnLFxuICAgICAgICBvdXRwdXQ6IG51bGwsXG4gICAgICAgIGVycm9yLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICB0YXNrU3RhdHVzZXNbdGFza0lkXSA9IHtcbiAgICAgIHByb21wdF9pZDogcHJvbXB0SWQsXG4gICAgICBzdGF0dXM6IHRhc2tPdXRwdXRzW3Rhc2tJZF0uc3RhdHVzLFxuICAgICAgZXJyb3I6IHRhc2tPdXRwdXRzW3Rhc2tJZF0uZXJyb3IsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGNvbXBsZXRlZEF0ID0gdG9Jc28obm93KTtcbiAgY29uc3Qgc3RhdHVzID1cbiAgICBmYWlsZWRDb3VudCA9PT0gdGFza0NhdGFsb2cudGFza3MubGVuZ3RoXG4gICAgICA/ICdGQUlMJ1xuICAgICAgOiBmYWlsZWRDb3VudCA+IDBcbiAgICAgICAgPyAnUEFSVElBTCdcbiAgICAgICAgOiAnU1VDQ0VTUyc7XG5cbiAgY29uc3QgcnVuTG9nOiBSdW5Mb2cgPSB7XG4gICAgd2Y0X3J1bl9pZDogcnVuSWQsXG4gICAgaW50YWtlX2lkOiBpbnRha2VTbmFwc2hvdC5pbnRha2VfaWQsXG4gICAgd2YzX3J1bl9pZDogd2YzU25hcHNob3Qud2YzX3J1bl9pZCxcbiAgICBzdGFydGVkX2F0OiBzdGFydGVkQXQsXG4gICAgY29tcGxldGVkX2F0OiBjb21wbGV0ZWRBdCxcbiAgICBzdGF0dXMsXG4gICAgbW9kZWxfcHJvdmlkZXI6IHByb3ZpZGVyLnByb3ZpZGVyLFxuICAgIG1vZGVsX25hbWU6IHByb3ZpZGVyLm1vZGVsLFxuICAgIHByb21wdF9idW5kbGVfdmVyc2lvbjogcHJvbXB0QnVuZGxlVmVyc2lvbixcbiAgICBwZXJfdGFzazogdGFza1N0YXR1c2VzLFxuICAgIGlucHV0X3JlZnM6IHtcbiAgICAgIGludGFrZV9pZDogaW50YWtlU25hcHNob3QuaW50YWtlX2lkLFxuICAgICAgd2YzX3J1bl9pZDogd2YzU25hcHNob3Qud2YzX3J1bl9pZCxcbiAgICAgIGZpcm1faWQ6IGludGFrZVNuYXBzaG90LmZpcm1faWQgPz8gbnVsbCxcbiAgICB9LFxuICB9O1xuXG4gIGF3YWl0IChkZXBzLnN0b3JlUnVuID8/IHN0b3JlUnVuKSh7IHJ1bkxvZywgcnVuT3V0cHV0IH0pO1xuXG4gIHJldHVybiB7IHJ1bkxvZywgcnVuT3V0cHV0IH07XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiR0FfRElWT1JDRV9DVVNUT0RZX1YxIiwibG9hZFdmNENvdW50aWVzIiwibG9hZFdmNFRhc2tDYXRhbG9nIiwidmFsaWRhdGVFdmlkZW5jZVBvaW50ZXJzIiwiV0Y0X1BST01QVF9CVU5ETEVfVkVSU0lPTiIsIldGNF9QUk9NUFRfVEVNUExBVEVTIiwiV0Y0X1RBU0tfUFJPTVBUX01BUCIsImlzUmVjb3JkIiwidmFsdWUiLCJCb29sZWFuIiwiQXJyYXkiLCJpc0FycmF5IiwidG9Jc28iLCJub3ciLCJEYXRlIiwidG9JU09TdHJpbmciLCJidWlsZFNjaGVtYUFsbG93bGlzdCIsInNlY3Rpb25zIiwiZmxhdE1hcCIsInNlY3Rpb24iLCJmaWVsZHMiLCJmaWx0ZXIiLCJmaWVsZCIsImlzU3lzdGVtIiwibWFwIiwia2V5IiwibG9hZEludGFrZVNuYXBzaG90IiwiaW50YWtlSWQiLCJzdXBhYmFzZUFkbWluIiwiZGF0YSIsImludGFrZSIsImVycm9yIiwiaW50YWtlRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJtYXliZVNpbmdsZSIsIkVycm9yIiwic3VibWl0dGVkX2F0IiwibWVzc2FnZXMiLCJtZXNzYWdlRXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsImRvY3VtZW50cyIsImRvY3VtZW50c0Vycm9yIiwic3RydWN0dXJlZEZpZWxkcyIsInJhd19wYXlsb2FkIiwiaW50YWtlX2lkIiwiaWQiLCJzdWJtaXNzaW9uX2lkIiwic3RydWN0dXJlZF9maWVsZHMiLCJmcmVlX3RleHRfZmllbGRzIiwibWVzc2FnZSIsIm1lc3NhZ2VfaWQiLCJyb2xlIiwic291cmNlIiwiY29udGVudCIsImNyZWF0ZWRfYXQiLCJkb2MiLCJkb2N1bWVudF9pZCIsImZpbGVuYW1lIiwic3RvcmFnZV9vYmplY3RfcGF0aCIsIm1pbWV0eXBlIiwiZG9jdW1lbnRfdHlwZSIsInRleHRfZXh0cmFjdCIsImZpcm1faWQiLCJsb2FkV2YzU25hcHNob3QiLCJ3ZjNSdW5JZCIsImV4dHJhY3RlZCIsImV4dHJhY3RlZF9kYXRhIiwicnVsZXNFbmdpbmUiLCJydWxlc19lbmdpbmUiLCJ3ZjNfcnVuX2lkIiwidmFsaWRhdGlvbl9zdW1tYXJ5IiwicnVsZV9yZXN1bHRzIiwicnVsZV9ldmFsdWF0aW9ucyIsImVudHJ5IiwicnVsZV9pZCIsIlN0cmluZyIsInBhc3NlZCIsImZpZWxkX3BhdGhzIiwidW5kZWZpbmVkIiwicmVxdWlyZWRfZmllbGRzX21pc3NpbmciLCJjYW5vbmljYWxfZmllbGRzIiwic3RvcmVSdW4iLCJhcmdzIiwicnVuTG9nIiwicnVuT3V0cHV0IiwiaW5zZXJ0Iiwid2Y0X3J1bl9pZCIsImlucHV0X3JlZnMiLCJydW5fa2luZCIsIm1vZGVsX25hbWUiLCJwcm9tcHRfaGFzaCIsInByb21wdF9idW5kbGVfdmVyc2lvbiIsImlucHV0cyIsInBlcl90YXNrIiwic3RhcnRlZF9hdCIsImNvbXBsZXRlZF9hdCIsInN0YXR1cyIsIm91dHB1dHMiLCJydW5fbG9nIiwicnVuX291dHB1dCIsInRvTG93ZXJDYXNlIiwic2luZ2xlIiwicGFyc2VKc29uT3V0cHV0IiwicmF3Iiwib2siLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiLCJ2YWxpZGF0ZUV4dHJhY3Rpb25PdXRwdXQiLCJvdXRwdXQiLCJleHRyYWN0aW9ucyIsIml0ZW0iLCJmaWVsZF9rZXkiLCJ2YWx1ZV90eXBlIiwiY29uZmlkZW5jZV9zY29yZSIsImNvbmZpZGVuY2VfbGV2ZWwiLCJldmlkZW5jZSIsImV2aWRlbmNlQ2hlY2siLCJ2YWxpZGF0ZUZsYWdzT3V0cHV0IiwiZmxhZ3MiLCJmbGFnX2tleSIsImZsYWdfcHJlc2VudCIsIndoeV9pdF9tYXR0ZXJzX2Zvcl9yZXZpZXciLCJ2YWxpZGF0ZUluY29uc2lzdGVuY2llc091dHB1dCIsImluY29uc2lzdGVuY2llcyIsImluY29uc2lzdGVuY3lfa2V5IiwiZmllbGRzX2ludm9sdmVkIiwic3VtbWFyeSIsInNldmVyaXR5IiwidmFsaWRhdGVDb3VudHlNZW50aW9uc091dHB1dCIsImNhbm9uaWNhbExpc3QiLCJjb3VudHlNZW50aW9ucyIsImNvdW50eV9tZW50aW9ucyIsImRlZmVyZW5jZSIsIndmM19jYW5vbmljYWxfY291bnR5X3ByZXNlbnQiLCJyYXdfbWVudGlvbiIsIm1hdGNoX3R5cGUiLCJzdWdnZXN0ZWRfY291bnR5IiwibGVuZ3RoIiwiaW5jbHVkZXMiLCJ3ZjNfY2Fub25pY2FsX2NvdW50eV92YWx1ZSIsInZhbGlkYXRlUmV2aWV3QXR0ZW50aW9uT3V0cHV0IiwicmV2aWV3QXR0ZW50aW9uIiwicmV2aWV3X2F0dGVudGlvbiIsImhpZ2giLCJoaWdoX3ByaW9yaXR5X2l0ZW1zIiwibWVkaXVtIiwibWVkaXVtX3ByaW9yaXR5X2l0ZW1zIiwibG93IiwibG93X3ByaW9yaXR5X2l0ZW1zIiwicnVuVGFzayIsInByb3ZpZGVyIiwicHJvbXB0SWQiLCJpbnB1dCIsInRlbXBsYXRlIiwic3lzdGVtUHJvbXB0Iiwic3lzdGVtIiwidXNlclByb21wdCIsInVzZXIiLCJnZW5lcmF0ZUpzb24iLCJidWlsZFRhc2tJbnB1dCIsInRhc2tJZCIsImNvbnRleHQiLCJiYXNlIiwiaW50YWtlX3NuYXBzaG90IiwiaW50YWtlU25hcHNob3QiLCJ3ZjNfc25hcHNob3QiLCJ3ZjNTbmFwc2hvdCIsInNjaGVtYV9hbGxvd2xpc3QiLCJzY2hlbWFBbGxvd2xpc3QiLCJyZWZlcmVuY2UiLCJnYV9jb3VudGllcyIsImNvdW50eVJlZmVyZW5jZSIsIndmNF9vdXRwdXRzIiwicHJldmlvdXNPdXRwdXRzIiwicnVuV2Y0IiwiZGVwcyIsInN0YXJ0ZWRBdCIsInByb21wdEJ1bmRsZVZlcnNpb24iLCJydW5JZCIsInJhbmRvbVVVSUQiLCJjb3VudHlMb29rdXAiLCJjb3VudGllcyIsInRhc2tDYXRhbG9nIiwibGxtUHJvdmlkZXIiLCJ0YXNrT3V0cHV0cyIsInRhc2tfb3V0cHV0cyIsInRhc2tTdGF0dXNlcyIsImNvbXBsZXRlZEF0IiwiZmFpbGVkQ291bnQiLCJ0YXNrIiwidGFza3MiLCJ0YXNrX2lkIiwidGFza0lucHV0IiwicmF3UmVzdWx0IiwidmFsaWRhdGlvbiIsInByb21wdF9pZCIsImR2X2luZGljYXRvcnMiLCJqdXJpc2RpY3Rpb25fY29tcGxleGl0eSIsImN1c3RvZHlfY29uZmxpY3QiLCJ0YXNrRXJyb3IiLCJtb2RlbF9wcm92aWRlciIsIm1vZGVsIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflows/wf4/runWf4.ts\n");

/***/ }),

/***/ "(api-node)/../../src/workflows/wf4/taskCatalog.ts":
/*!**********************************************!*\
  !*** ../../src/workflows/wf4/taskCatalog.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WF4_TASK_CATALOG_PATH: () => (/* binding */ WF4_TASK_CATALOG_PATH),\n/* harmony export */   loadWf4TaskCatalog: () => (/* binding */ loadWf4TaskCatalog)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction resolveRepoRoot() {\n    const cwd = process.cwd();\n    if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(cwd, 'docs'))) {\n        return cwd;\n    }\n    const candidate = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(cwd, '..', '..');\n    if (fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(path__WEBPACK_IMPORTED_MODULE_1___default().join(candidate, 'docs'))) {\n        return candidate;\n    }\n    return cwd;\n}\nconst WF4_TASK_CATALOG_PATH = path__WEBPACK_IMPORTED_MODULE_1___default().join(resolveRepoRoot(), 'docs', 'architecture', 'Phase-1', 'Workflow-04', 'workflow-04-ai-task-catalog.json');\nlet cachedCatalog = null;\nlet cachedPath = null;\nfunction loadWf4TaskCatalog(catalogPath = WF4_TASK_CATALOG_PATH) {\n    const resolvedPath = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(catalogPath);\n    if (cachedCatalog && cachedPath === resolvedPath) {\n        return cachedCatalog;\n    }\n    const raw = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(resolvedPath, 'utf8');\n    const parsed = JSON.parse(raw);\n    cachedCatalog = parsed;\n    cachedPath = resolvedPath;\n    return cachedCatalog;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uLi8uLi9zcmMvd29ya2Zsb3dzL3dmNC90YXNrQ2F0YWxvZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBb0I7QUFDSTtBQUd4QixTQUFTRTtJQUNQLE1BQU1DLE1BQU1DLFFBQVFELEdBQUc7SUFDdkIsSUFBSUgsb0RBQWEsQ0FBQ0MsZ0RBQVMsQ0FBQ0UsS0FBSyxVQUFVO1FBQ3pDLE9BQU9BO0lBQ1Q7SUFDQSxNQUFNSSxZQUFZTixtREFBWSxDQUFDRSxLQUFLLE1BQU07SUFDMUMsSUFBSUgsb0RBQWEsQ0FBQ0MsZ0RBQVMsQ0FBQ00sV0FBVyxVQUFVO1FBQy9DLE9BQU9BO0lBQ1Q7SUFDQSxPQUFPSjtBQUNUO0FBRU8sTUFBTU0sd0JBQXdCUixnREFBUyxDQUM1Q0MsbUJBQ0EsUUFDQSxnQkFDQSxXQUNBLGVBQ0Esb0NBQ0E7QUFFRixJQUFJUSxnQkFBdUM7QUFDM0MsSUFBSUMsYUFBNEI7QUFFekIsU0FBU0MsbUJBQW1CQyxjQUFjSixxQkFBcUI7SUFDcEUsTUFBTUssZUFBZWIsbURBQVksQ0FBQ1k7SUFDbEMsSUFBSUgsaUJBQWlCQyxlQUFlRyxjQUFjO1FBQ2hELE9BQU9KO0lBQ1Q7SUFDQSxNQUFNSyxNQUFNZixzREFBZSxDQUFDYyxjQUFjO0lBQzFDLE1BQU1HLFNBQVNDLEtBQUtDLEtBQUssQ0FBQ0o7SUFDMUJMLGdCQUFnQk87SUFDaEJOLGFBQWFHO0lBQ2IsT0FBT0o7QUFDVCIsInNvdXJjZXMiOlsiL1VzZXJzL2RvbWluaWNyYW5naGlhc2NpL3ZlcmlsZXgtbGFuZGluZy9zcmMvd29ya2Zsb3dzL3dmNC90YXNrQ2F0YWxvZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgdHlwZSB7IFdmNFRhc2tDYXRhbG9nIH0gZnJvbSAnLi90eXBlcyc7XG5cbmZ1bmN0aW9uIHJlc29sdmVSZXBvUm9vdCgpOiBzdHJpbmcge1xuICBjb25zdCBjd2QgPSBwcm9jZXNzLmN3ZCgpO1xuICBpZiAoZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oY3dkLCAnZG9jcycpKSkge1xuICAgIHJldHVybiBjd2Q7XG4gIH1cbiAgY29uc3QgY2FuZGlkYXRlID0gcGF0aC5yZXNvbHZlKGN3ZCwgJy4uJywgJy4uJyk7XG4gIGlmIChmcy5leGlzdHNTeW5jKHBhdGguam9pbihjYW5kaWRhdGUsICdkb2NzJykpKSB7XG4gICAgcmV0dXJuIGNhbmRpZGF0ZTtcbiAgfVxuICByZXR1cm4gY3dkO1xufVxuXG5leHBvcnQgY29uc3QgV0Y0X1RBU0tfQ0FUQUxPR19QQVRIID0gcGF0aC5qb2luKFxuICByZXNvbHZlUmVwb1Jvb3QoKSxcbiAgJ2RvY3MnLFxuICAnYXJjaGl0ZWN0dXJlJyxcbiAgJ1BoYXNlLTEnLFxuICAnV29ya2Zsb3ctMDQnLFxuICAnd29ya2Zsb3ctMDQtYWktdGFzay1jYXRhbG9nLmpzb24nLFxuKTtcblxubGV0IGNhY2hlZENhdGFsb2c6IFdmNFRhc2tDYXRhbG9nIHwgbnVsbCA9IG51bGw7XG5sZXQgY2FjaGVkUGF0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkV2Y0VGFza0NhdGFsb2coY2F0YWxvZ1BhdGggPSBXRjRfVEFTS19DQVRBTE9HX1BBVEgpOiBXZjRUYXNrQ2F0YWxvZyB7XG4gIGNvbnN0IHJlc29sdmVkUGF0aCA9IHBhdGgucmVzb2x2ZShjYXRhbG9nUGF0aCk7XG4gIGlmIChjYWNoZWRDYXRhbG9nICYmIGNhY2hlZFBhdGggPT09IHJlc29sdmVkUGF0aCkge1xuICAgIHJldHVybiBjYWNoZWRDYXRhbG9nO1xuICB9XG4gIGNvbnN0IHJhdyA9IGZzLnJlYWRGaWxlU3luYyhyZXNvbHZlZFBhdGgsICd1dGY4Jyk7XG4gIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UocmF3KSBhcyBXZjRUYXNrQ2F0YWxvZztcbiAgY2FjaGVkQ2F0YWxvZyA9IHBhcnNlZDtcbiAgY2FjaGVkUGF0aCA9IHJlc29sdmVkUGF0aDtcbiAgcmV0dXJuIGNhY2hlZENhdGFsb2c7XG59XG4iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwicmVzb2x2ZVJlcG9Sb290IiwiY3dkIiwicHJvY2VzcyIsImV4aXN0c1N5bmMiLCJqb2luIiwiY2FuZGlkYXRlIiwicmVzb2x2ZSIsIldGNF9UQVNLX0NBVEFMT0dfUEFUSCIsImNhY2hlZENhdGFsb2ciLCJjYWNoZWRQYXRoIiwibG9hZFdmNFRhc2tDYXRhbG9nIiwiY2F0YWxvZ1BhdGgiLCJyZXNvbHZlZFBhdGgiLCJyYXciLCJyZWFkRmlsZVN5bmMiLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/../../src/workflows/wf4/taskCatalog.ts\n");

/***/ }),

/***/ "(api-node)/./lib/apiUtils.ts":
/*!*************************!*\
  !*** ./lib/apiUtils.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getRequestId: () => (/* binding */ getRequestId),\n/* harmony export */   logRequestError: () => (/* binding */ logRequestError),\n/* harmony export */   logRequestStart: () => (/* binding */ logRequestStart),\n/* harmony export */   parseJsonBody: () => (/* binding */ parseJsonBody),\n/* harmony export */   requireMethod: () => (/* binding */ requireMethod),\n/* harmony export */   sendError: () => (/* binding */ sendError)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nconst DEFAULT_BODY_LIMIT_BYTES = 1024 * 1024;\nfunction getRequestId(req) {\n    const header = req.headers['x-request-id'] ?? req.headers['x-correlation-id'];\n    if (Array.isArray(header)) {\n        const value = header.find((entry)=>entry.trim());\n        if (value) return value.trim();\n    }\n    if (typeof header === 'string' && header.trim()) {\n        return header.trim();\n    }\n    return crypto__WEBPACK_IMPORTED_MODULE_0___default().randomUUID();\n}\nfunction logRequestStart(req, requestId) {\n    const path = req.url ? req.url.split('?')[0] : '';\n    console.info(`[intake-api] ${req.method ?? 'UNKNOWN'} ${path} requestId=${requestId}`);\n}\nfunction logRequestError(requestId, status, message, detail) {\n    const suffix = detail ? ` detail=\"${detail}\"` : '';\n    console.error(`[intake-api] requestId=${requestId} status=${status} message=\"${message}\"${suffix}`);\n}\nfunction sendError(res, status, message, requestId, detail) {\n    logRequestError(requestId, status, message, detail);\n    return res.status(status).json({\n        ok: false,\n        error: message,\n        requestId\n    });\n}\nfunction requireMethod(req, res, allowed, requestId) {\n    if (!req.method || !allowed.includes(req.method)) {\n        res.setHeader('Allow', allowed);\n        sendError(res, 405, 'Method not allowed', requestId);\n        return false;\n    }\n    return true;\n}\nfunction parseJsonBody(req, requestId, options = {}) {\n    const limitBytes = options.limitBytes ?? DEFAULT_BODY_LIMIT_BYTES;\n    const body = req.body ?? (options.allowEmpty ? {} : undefined);\n    if (body === undefined) {\n        return {\n            ok: false,\n            status: 400,\n            error: 'Request body required'\n        };\n    }\n    if (typeof body === 'string') {\n        if (Buffer.byteLength(body, 'utf8') > limitBytes) {\n            return {\n                ok: false,\n                status: 413,\n                error: 'Request body too large'\n            };\n        }\n        try {\n            return {\n                ok: true,\n                data: JSON.parse(body)\n            };\n        } catch  {\n            return {\n                ok: false,\n                status: 400,\n                error: 'Invalid JSON body'\n            };\n        }\n    }\n    const size = Buffer.byteLength(JSON.stringify(body), 'utf8');\n    if (size > limitBytes) {\n        return {\n            ok: false,\n            status: 413,\n            error: 'Request body too large'\n        };\n    }\n    return {\n        ok: true,\n        data: body\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0lBQ0Y7SUFFQSxNQUFNb0IsT0FBT0wsT0FBT0MsVUFBVSxDQUFDRSxLQUFLRyxTQUFTLENBQUNULE9BQU87SUFDckQsSUFBSVEsT0FBT1QsWUFBWTtRQUNyQixPQUFPO1lBQUVQLElBQUk7WUFBT1IsUUFBUTtZQUFLSSxPQUFPO1FBQXlCO0lBQ25FO0lBRUEsT0FBTztRQUFFSSxJQUFJO1FBQU1hLE1BQU1MO0lBQVU7QUFDckMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9kb21pbmljcmFuZ2hpYXNjaS92ZXJpbGV4LWxhbmRpbmcvYXBwcy9pbnRha2UvbGliL2FwaVV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuXG5jb25zdCBERUZBVUxUX0JPRFlfTElNSVRfQllURVMgPSAxMDI0ICogMTAyNDtcblxudHlwZSBKc29uUGFyc2VPcHRpb25zID0ge1xuICBhbGxvd0VtcHR5PzogYm9vbGVhbjtcbiAgbGltaXRCeXRlcz86IG51bWJlcjtcbn07XG5cbnR5cGUgSnNvblBhcnNlUmVzdWx0PFQ+ID1cbiAgfCB7IG9rOiB0cnVlOyBkYXRhOiBUIH1cbiAgfCB7IG9rOiBmYWxzZTsgc3RhdHVzOiBudW1iZXI7IGVycm9yOiBzdHJpbmcgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlcXVlc3RJZChyZXE6IE5leHRBcGlSZXF1ZXN0KTogc3RyaW5nIHtcbiAgY29uc3QgaGVhZGVyID0gcmVxLmhlYWRlcnNbJ3gtcmVxdWVzdC1pZCddID8/IHJlcS5oZWFkZXJzWyd4LWNvcnJlbGF0aW9uLWlkJ107XG4gIGlmIChBcnJheS5pc0FycmF5KGhlYWRlcikpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGhlYWRlci5maW5kKChlbnRyeSkgPT4gZW50cnkudHJpbSgpKTtcbiAgICBpZiAodmFsdWUpIHJldHVybiB2YWx1ZS50cmltKCk7XG4gIH1cbiAgaWYgKHR5cGVvZiBoZWFkZXIgPT09ICdzdHJpbmcnICYmIGhlYWRlci50cmltKCkpIHtcbiAgICByZXR1cm4gaGVhZGVyLnRyaW0oKTtcbiAgfVxuICByZXR1cm4gY3J5cHRvLnJhbmRvbVVVSUQoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1JlcXVlc3RTdGFydChyZXE6IE5leHRBcGlSZXF1ZXN0LCByZXF1ZXN0SWQ6IHN0cmluZykge1xuICBjb25zdCBwYXRoID0gcmVxLnVybCA/IHJlcS51cmwuc3BsaXQoJz8nKVswXSA6ICcnO1xuICBjb25zb2xlLmluZm8oYFtpbnRha2UtYXBpXSAke3JlcS5tZXRob2QgPz8gJ1VOS05PV04nfSAke3BhdGh9IHJlcXVlc3RJZD0ke3JlcXVlc3RJZH1gKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxvZ1JlcXVlc3RFcnJvcihcbiAgcmVxdWVzdElkOiBzdHJpbmcsXG4gIHN0YXR1czogbnVtYmVyLFxuICBtZXNzYWdlOiBzdHJpbmcsXG4gIGRldGFpbD86IHN0cmluZyxcbikge1xuICBjb25zdCBzdWZmaXggPSBkZXRhaWwgPyBgIGRldGFpbD1cIiR7ZGV0YWlsfVwiYCA6ICcnO1xuICBjb25zb2xlLmVycm9yKGBbaW50YWtlLWFwaV0gcmVxdWVzdElkPSR7cmVxdWVzdElkfSBzdGF0dXM9JHtzdGF0dXN9IG1lc3NhZ2U9XCIke21lc3NhZ2V9XCIke3N1ZmZpeH1gKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRFcnJvcihcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2UsXG4gIHN0YXR1czogbnVtYmVyLFxuICBtZXNzYWdlOiBzdHJpbmcsXG4gIHJlcXVlc3RJZDogc3RyaW5nLFxuICBkZXRhaWw/OiBzdHJpbmcsXG4pIHtcbiAgbG9nUmVxdWVzdEVycm9yKHJlcXVlc3RJZCwgc3RhdHVzLCBtZXNzYWdlLCBkZXRhaWwpO1xuICByZXR1cm4gcmVzLnN0YXR1cyhzdGF0dXMpLmpzb24oeyBvazogZmFsc2UsIGVycm9yOiBtZXNzYWdlLCByZXF1ZXN0SWQgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlTWV0aG9kKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZSxcbiAgYWxsb3dlZDogc3RyaW5nW10sXG4gIHJlcXVlc3RJZDogc3RyaW5nLFxuKSB7XG4gIGlmICghcmVxLm1ldGhvZCB8fCAhYWxsb3dlZC5pbmNsdWRlcyhyZXEubWV0aG9kKSkge1xuICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgYWxsb3dlZCk7XG4gICAgc2VuZEVycm9yKHJlcywgNDA1LCAnTWV0aG9kIG5vdCBhbGxvd2VkJywgcmVxdWVzdElkKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUpzb25Cb2R5PFQ+KFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXF1ZXN0SWQ6IHN0cmluZyxcbiAgb3B0aW9uczogSnNvblBhcnNlT3B0aW9ucyA9IHt9LFxuKTogSnNvblBhcnNlUmVzdWx0PFQ+IHtcbiAgY29uc3QgbGltaXRCeXRlcyA9IG9wdGlvbnMubGltaXRCeXRlcyA/PyBERUZBVUxUX0JPRFlfTElNSVRfQllURVM7XG4gIGNvbnN0IGJvZHkgPSByZXEuYm9keSA/PyAob3B0aW9ucy5hbGxvd0VtcHR5ID8ge30gOiB1bmRlZmluZWQpO1xuXG4gIGlmIChib2R5ID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIHN0YXR1czogNDAwLCBlcnJvcjogJ1JlcXVlc3QgYm9keSByZXF1aXJlZCcgfTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICBpZiAoQnVmZmVyLmJ5dGVMZW5ndGgoYm9keSwgJ3V0ZjgnKSA+IGxpbWl0Qnl0ZXMpIHtcbiAgICAgIHJldHVybiB7IG9rOiBmYWxzZSwgc3RhdHVzOiA0MTMsIGVycm9yOiAnUmVxdWVzdCBib2R5IHRvbyBsYXJnZScgfTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiB7IG9rOiB0cnVlLCBkYXRhOiBKU09OLnBhcnNlKGJvZHkpIGFzIFQgfTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiB7IG9rOiBmYWxzZSwgc3RhdHVzOiA0MDAsIGVycm9yOiAnSW52YWxpZCBKU09OIGJvZHknIH07XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc2l6ZSA9IEJ1ZmZlci5ieXRlTGVuZ3RoKEpTT04uc3RyaW5naWZ5KGJvZHkpLCAndXRmOCcpO1xuICBpZiAoc2l6ZSA+IGxpbWl0Qnl0ZXMpIHtcbiAgICByZXR1cm4geyBvazogZmFsc2UsIHN0YXR1czogNDEzLCBlcnJvcjogJ1JlcXVlc3QgYm9keSB0b28gbGFyZ2UnIH07XG4gIH1cblxuICByZXR1cm4geyBvazogdHJ1ZSwgZGF0YTogYm9keSBhcyBUIH07XG59XG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiREVGQVVMVF9CT0RZX0xJTUlUX0JZVEVTIiwiZ2V0UmVxdWVzdElkIiwicmVxIiwiaGVhZGVyIiwiaGVhZGVycyIsIkFycmF5IiwiaXNBcnJheSIsInZhbHVlIiwiZmluZCIsImVudHJ5IiwidHJpbSIsInJhbmRvbVVVSUQiLCJsb2dSZXF1ZXN0U3RhcnQiLCJyZXF1ZXN0SWQiLCJwYXRoIiwidXJsIiwic3BsaXQiLCJjb25zb2xlIiwiaW5mbyIsIm1ldGhvZCIsImxvZ1JlcXVlc3RFcnJvciIsInN0YXR1cyIsIm1lc3NhZ2UiLCJkZXRhaWwiLCJzdWZmaXgiLCJlcnJvciIsInNlbmRFcnJvciIsInJlcyIsImpzb24iLCJvayIsInJlcXVpcmVNZXRob2QiLCJhbGxvd2VkIiwiaW5jbHVkZXMiLCJzZXRIZWFkZXIiLCJwYXJzZUpzb25Cb2R5Iiwib3B0aW9ucyIsImxpbWl0Qnl0ZXMiLCJib2R5IiwiYWxsb3dFbXB0eSIsInVuZGVmaW5lZCIsIkJ1ZmZlciIsImJ5dGVMZW5ndGgiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwic2l6ZSIsInN0cmluZ2lmeSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./lib/apiUtils.ts\n");

/***/ }),

/***/ "(api-node)/./pages/api/intake/submit.ts":
/*!************************************!*\
  !*** ./pages/api/intake/submit.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../../lib/server/supabaseAdmin */ \"(api-node)/../../lib/server/supabaseAdmin.ts\");\n/* harmony import */ var _lib_server_intakeToken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../lib/server/intakeToken */ \"(api-node)/../../lib/server/intakeToken.ts\");\n/* harmony import */ var _lib_intake_schema_gaDivorceCustodyV1__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../lib/intake/schema/gaDivorceCustodyV1 */ \"(api-node)/../../lib/intake/schema/gaDivorceCustodyV1.ts\");\n/* harmony import */ var _lib_intake_normalizePayload__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../lib/intake/normalizePayload */ \"(api-node)/../../lib/intake/normalizePayload.ts\");\n/* harmony import */ var _src_workflow3_runWorkflow3Rules__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../src/workflow3/runWorkflow3Rules */ \"(api-node)/../../src/workflow3/runWorkflow3Rules.ts\");\n/* harmony import */ var _src_workflows_wf4_runWf4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../src/workflows/wf4/runWf4 */ \"(api-node)/../../src/workflows/wf4/runWf4.ts\");\n/* harmony import */ var _lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/apiUtils */ \"(api-node)/./lib/apiUtils.ts\");\n\n\n\n\n\n\n\nconst allowedFieldKeys = new Set(_lib_intake_schema_gaDivorceCustodyV1__WEBPACK_IMPORTED_MODULE_2__.GA_DIVORCE_CUSTODY_V1.sections.flatMap((section)=>section.fields.filter((field)=>!field.isSystem).map((field)=>field.key)));\nfunction extractToken(req, body) {\n    const authHeader = req.headers.authorization;\n    if (authHeader?.startsWith('Bearer ')) {\n        return authHeader.slice('Bearer '.length).trim();\n    }\n    const headerToken = req.headers['x-intake-token'];\n    if (typeof headerToken === 'string' && headerToken.trim()) {\n        return headerToken.trim();\n    }\n    const queryToken = req.query.token;\n    if (typeof queryToken === 'string' && queryToken.trim()) {\n        return queryToken.trim();\n    }\n    const bodyToken = body?.token;\n    if (typeof bodyToken === 'string' && bodyToken.trim()) {\n        return bodyToken.trim();\n    }\n    return '';\n}\nfunction isPlainObject(value) {\n    return Boolean(value) && typeof value === 'object' && !Array.isArray(value);\n}\nfunction sanitizePatch(input) {\n    const unknownKeys = [];\n    const sanitized = {};\n    for (const [key, value] of Object.entries(input)){\n        if (!allowedFieldKeys.has(key)) {\n            unknownKeys.push(key);\n            continue;\n        }\n        if (value !== undefined) {\n            sanitized[key] = value;\n        }\n    }\n    return {\n        sanitized,\n        unknownKeys\n    };\n}\nfunction toStringOrNull(value) {\n    if (typeof value !== 'string') return null;\n    const trimmed = value.trim();\n    return trimmed.length > 0 ? trimmed : null;\n}\nfunction buildClientDisplayName(payload) {\n    const first = toStringOrNull(payload.client_first_name);\n    const last = toStringOrNull(payload.client_last_name);\n    if (!first && !last) return null;\n    return [\n        first,\n        last\n    ].filter(Boolean).join(' ').trim() || null;\n}\nasync function handler(req, res) {\n    const requestId = (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.getRequestId)(req);\n    (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.logRequestStart)(req, requestId);\n    if (!(0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.requireMethod)(req, res, [\n        'POST'\n    ], requestId)) {\n        return;\n    }\n    const bodyResult = (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.parseJsonBody)(req, requestId);\n    if (!bodyResult.ok) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, bodyResult.status, bodyResult.error, requestId);\n        return;\n    }\n    const token = extractToken(req, bodyResult.data);\n    if (!token) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 401, 'Missing intake token', requestId);\n        return;\n    }\n    const tokenResult = (0,_lib_server_intakeToken__WEBPACK_IMPORTED_MODULE_1__.verifyIntakeToken)(token);\n    if (!tokenResult.ok) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, tokenResult.status, tokenResult.error, requestId);\n        return;\n    }\n    const body = bodyResult.data ?? {};\n    const intakeId = typeof body.intakeId === 'string' ? body.intakeId : '';\n    if (!intakeId) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 400, 'intakeId is required', requestId);\n        return;\n    }\n    if (intakeId !== tokenResult.payload.intake_id) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 403, 'Intake token does not match intake', requestId);\n        return;\n    }\n    const patchInput = body.patch ?? {};\n    if (!isPlainObject(patchInput)) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 400, 'patch must be an object', requestId);\n        return;\n    }\n    const { sanitized, unknownKeys } = sanitizePatch(patchInput);\n    if (unknownKeys.length > 0) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 400, `Unknown intake fields: ${unknownKeys.join(', ')}`, requestId);\n        return;\n    }\n    const { data: intake, error: intakeError } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intakes').select('id, firm_id, status, submitted_at, raw_payload').eq('id', intakeId).eq('firm_id', tokenResult.payload.firm_id).maybeSingle();\n    if (intakeError) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 500, 'Unable to load intake', requestId);\n        return;\n    }\n    if (!intake) {\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 404, 'Intake not found', requestId);\n        return;\n    }\n    if (intake.submitted_at || intake.status === 'submitted') {\n        let wf3Result = null;\n        try {\n            wf3Result = await (0,_src_workflow3_runWorkflow3Rules__WEBPACK_IMPORTED_MODULE_4__.runWorkflow3Rules)({\n                intake_id: intake.id,\n                firm_id: intake.firm_id\n            });\n        } catch (error) {\n            console.error(`[wf3] submit hook failed intake_id=${intake.id}`, error);\n        }\n        if (wf3Result?.extraction_id) {\n            try {\n                await (0,_src_workflows_wf4_runWf4__WEBPACK_IMPORTED_MODULE_5__.runWf4)({\n                    intakeId: intake.id,\n                    wf3RunId: wf3Result.extraction_id\n                });\n            } catch (error) {\n                console.error(`[wf4] submit hook failed intake_id=${intake.id}`, error);\n            }\n        }\n        return res.status(200).json({\n            ok: true,\n            locked: true,\n            submitted_at: intake.submitted_at\n        });\n    }\n    const updateRow = {\n        status: 'submitted',\n        submitted_at: new Date().toISOString()\n    };\n    if (Object.keys(sanitized).length > 0) {\n        const existingPayload = isPlainObject(intake.raw_payload) ? intake.raw_payload : {};\n        const nextPayload = (0,_lib_intake_normalizePayload__WEBPACK_IMPORTED_MODULE_3__.normalizePayloadToDocxV1)({\n            ...existingPayload,\n            ...sanitized\n        });\n        updateRow.raw_payload = nextPayload;\n        if (sanitized.intake_channel !== undefined) {\n            updateRow.intake_channel = toStringOrNull(sanitized.intake_channel);\n        }\n        if (sanitized.matter_type !== undefined) {\n            updateRow.matter_type = toStringOrNull(sanitized.matter_type);\n        }\n        if (sanitized.urgency_level !== undefined) {\n            updateRow.urgency_level = toStringOrNull(sanitized.urgency_level);\n        }\n        if (sanitized.language_preference !== undefined) {\n            updateRow.language_preference = toStringOrNull(sanitized.language_preference);\n        }\n        const displayName = buildClientDisplayName(nextPayload);\n        if (displayName) {\n            updateRow.client_display_name = displayName;\n        }\n    }\n    const { data: updated, error: updateError } = await _lib_server_supabaseAdmin__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from('intakes').update(updateRow).eq('id', intakeId).eq('firm_id', tokenResult.payload.firm_id).is('submitted_at', null).select('id, submitted_at').maybeSingle();\n    if (updateError) {\n        if (updateError.message.includes('INTAKE_IMMUTABLE')) {\n            return res.status(409).json({\n                ok: false,\n                locked: true,\n                requestId\n            });\n        }\n        (0,_lib_apiUtils__WEBPACK_IMPORTED_MODULE_6__.sendError)(res, 500, 'Unable to submit intake', requestId);\n        return;\n    }\n    if (!updated) {\n        return res.status(409).json({\n            ok: false,\n            locked: true,\n            requestId\n        });\n    }\n    let wf3Result = null;\n    try {\n        wf3Result = await (0,_src_workflow3_runWorkflow3Rules__WEBPACK_IMPORTED_MODULE_4__.runWorkflow3Rules)({\n            intake_id: intakeId,\n            firm_id: tokenResult.payload.firm_id\n        });\n    } catch (error) {\n        console.error(`[wf3] submit hook failed intake_id=${intakeId}`, error);\n    }\n    if (wf3Result?.extraction_id) {\n        try {\n            await (0,_src_workflows_wf4_runWf4__WEBPACK_IMPORTED_MODULE_5__.runWf4)({\n                intakeId,\n                wf3RunId: wf3Result.extraction_id\n            });\n        } catch (error) {\n            console.error(`[wf4] submit hook failed intake_id=${intakeId}`, error);\n        }\n    }\n    return res.status(200).json({\n        ok: true,\n        locked: true,\n        submitted_at: updated.submitted_at\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3BhZ2VzL2FwaS9pbnRha2Uvc3VibWl0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQ3dFO0FBQ0U7QUFDa0I7QUFDTjtBQUNIO0FBQ2xCO0FBT3pDO0FBRXhCLE1BQU1XLG1CQUFtQixJQUFJQyxJQUMzQlYsd0ZBQXFCQSxDQUFDVyxRQUFRLENBQUNDLE9BQU8sQ0FBQyxDQUFDQyxVQUN0Q0EsUUFBUUMsTUFBTSxDQUFDQyxNQUFNLENBQUMsQ0FBQ0MsUUFBVSxDQUFDQSxNQUFNQyxRQUFRLEVBQUVDLEdBQUcsQ0FBQyxDQUFDRixRQUFVQSxNQUFNRyxHQUFHO0FBSTlFLFNBQVNDLGFBQWFDLEdBQW1CLEVBQUVDLElBQWdDO0lBQ3pFLE1BQU1DLGFBQWFGLElBQUlHLE9BQU8sQ0FBQ0MsYUFBYTtJQUM1QyxJQUFJRixZQUFZRyxXQUFXLFlBQVk7UUFDckMsT0FBT0gsV0FBV0ksS0FBSyxDQUFDLFVBQVVDLE1BQU0sRUFBRUMsSUFBSTtJQUNoRDtJQUVBLE1BQU1DLGNBQWNULElBQUlHLE9BQU8sQ0FBQyxpQkFBaUI7SUFDakQsSUFBSSxPQUFPTSxnQkFBZ0IsWUFBWUEsWUFBWUQsSUFBSSxJQUFJO1FBQ3pELE9BQU9DLFlBQVlELElBQUk7SUFDekI7SUFFQSxNQUFNRSxhQUFhVixJQUFJVyxLQUFLLENBQUNDLEtBQUs7SUFDbEMsSUFBSSxPQUFPRixlQUFlLFlBQVlBLFdBQVdGLElBQUksSUFBSTtRQUN2RCxPQUFPRSxXQUFXRixJQUFJO0lBQ3hCO0lBRUEsTUFBTUssWUFBWVosTUFBTVc7SUFDeEIsSUFBSSxPQUFPQyxjQUFjLFlBQVlBLFVBQVVMLElBQUksSUFBSTtRQUNyRCxPQUFPSyxVQUFVTCxJQUFJO0lBQ3ZCO0lBRUEsT0FBTztBQUNUO0FBRUEsU0FBU00sY0FBY0MsS0FBYztJQUNuQyxPQUFPQyxRQUFRRCxVQUFVLE9BQU9BLFVBQVUsWUFBWSxDQUFDRSxNQUFNQyxPQUFPLENBQUNIO0FBQ3ZFO0FBRUEsU0FBU0ksY0FB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Q25CNUIsTUFBTSxDQUFDLG9CQUNQRyxXQUFXO0lBRWQsSUFBSXVCLGFBQWE7UUFDZixJQUFJQSxZQUFZRyxPQUFPLENBQUNDLFFBQVEsQ0FBQyxxQkFBcUI7WUFDcEQsT0FBTzdDLElBQUlJLE1BQU0sQ0FBQyxLQUFLcUIsSUFBSSxDQUFDO2dCQUFFdEIsSUFBSTtnQkFBT3VCLFFBQVE7Z0JBQU16QjtZQUFVO1FBQ25FO1FBQ0FwRCx3REFBU0EsQ0FBQ21ELEtBQUssS0FBSywyQkFBMkJDO1FBQy9DO0lBQ0Y7SUFDQSxJQUFJLENBQUN1QyxTQUFTO1FBQ1osT0FBT3hDLElBQUlJLE1BQU0sQ0FBQyxLQUFLcUIsSUFBSSxDQUFDO1lBQUV0QixJQUFJO1lBQU91QixRQUFRO1lBQU16QjtRQUFVO0lBQ25FO0lBRUEsSUFBSW1CLFlBQStDO0lBQ25ELElBQUk7UUFDRkEsWUFBWSxNQUFNN0UsbUZBQWlCQSxDQUFDO1lBQUVrRSxXQUFXRDtZQUFVUyxTQUFTVixZQUFZZCxPQUFPLENBQUN3QixPQUFPO1FBQUM7SUFDbEcsRUFBRSxPQUFPWixPQUFPO1FBQ2RpQixRQUFRakIsS0FBSyxDQUFDLENBQUMsbUNBQW1DLEVBQUVHLFVBQVUsRUFBRUg7SUFDbEU7SUFDQSxJQUFJZSxXQUFXRyxlQUFlO1FBQzVCLElBQUk7WUFDRixNQUFNL0UsaUVBQU1BLENBQUM7Z0JBQUVnRTtnQkFBVWdCLFVBQVVKLFVBQVVHLGFBQWE7WUFBQztRQUM3RCxFQUFFLE9BQU9sQixPQUFPO1lBQ2RpQixRQUFRakIsS0FBSyxDQUFDLENBQUMsbUNBQW1DLEVBQUVHLFVBQVUsRUFBRUg7UUFDbEU7SUFDRjtJQUVBLE9BQU9MLElBQUlJLE1BQU0sQ0FBQyxLQUFLcUIsSUFBSSxDQUFDO1FBQUV0QixJQUFJO1FBQU11QixRQUFRO1FBQU1QLGNBQWNxQixRQUFRckIsWUFBWTtJQUFDO0FBQzNGIiwic291cmNlcyI6WyIvVXNlcnMvZG9taW5pY3JhbmdoaWFzY2kvdmVyaWxleC1sYW5kaW5nL2FwcHMvaW50YWtlL3BhZ2VzL2FwaS9pbnRha2Uvc3VibWl0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xuaW1wb3J0IHsgc3VwYWJhc2VBZG1pbiB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2xpYi9zZXJ2ZXIvc3VwYWJhc2VBZG1pbic7XG5pbXBvcnQgeyB2ZXJpZnlJbnRha2VUb2tlbiB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2xpYi9zZXJ2ZXIvaW50YWtlVG9rZW4nO1xuaW1wb3J0IHsgR0FfRElWT1JDRV9DVVNUT0RZX1YxIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vbGliL2ludGFrZS9zY2hlbWEvZ2FEaXZvcmNlQ3VzdG9keVYxJztcbmltcG9ydCB7IG5vcm1hbGl6ZVBheWxvYWRUb0RvY3hWMSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2xpYi9pbnRha2Uvbm9ybWFsaXplUGF5bG9hZCc7XG5pbXBvcnQgeyBydW5Xb3JrZmxvdzNSdWxlcyB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3NyYy93b3JrZmxvdzMvcnVuV29ya2Zsb3czUnVsZXMnO1xuaW1wb3J0IHsgcnVuV2Y0IH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vc3JjL3dvcmtmbG93cy93ZjQvcnVuV2Y0JztcbmltcG9ydCB7XG4gIGdldFJlcXVlc3RJZCxcbiAgbG9nUmVxdWVzdFN0YXJ0LFxuICBwYXJzZUpzb25Cb2R5LFxuICByZXF1aXJlTWV0aG9kLFxuICBzZW5kRXJyb3IsXG59IGZyb20gJ0AvbGliL2FwaVV0aWxzJztcblxuY29uc3QgYWxsb3dlZEZpZWxkS2V5cyA9IG5ldyBTZXQoXG4gIEdBX0RJVk9SQ0VfQ1VTVE9EWV9WMS5zZWN0aW9ucy5mbGF0TWFwKChzZWN0aW9uKSA9PlxuICAgIHNlY3Rpb24uZmllbGRzLmZpbHRlcigoZmllbGQpID0+ICFmaWVsZC5pc1N5c3RlbSkubWFwKChmaWVsZCkgPT4gZmllbGQua2V5KSxcbiAgKSxcbik7XG5cbmZ1bmN0aW9uIGV4dHJhY3RUb2tlbihyZXE6IE5leHRBcGlSZXF1ZXN0LCBib2R5PzogeyB0b2tlbj86IHN0cmluZyB9IHwgbnVsbCk6IHN0cmluZyB7XG4gIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xuICBpZiAoYXV0aEhlYWRlcj8uc3RhcnRzV2l0aCgnQmVhcmVyICcpKSB7XG4gICAgcmV0dXJuIGF1dGhIZWFkZXIuc2xpY2UoJ0JlYXJlciAnLmxlbmd0aCkudHJpbSgpO1xuICB9XG5cbiAgY29uc3QgaGVhZGVyVG9rZW4gPSByZXEuaGVhZGVyc1sneC1pbnRha2UtdG9rZW4nXTtcbiAgaWYgKHR5cGVvZiBoZWFkZXJUb2tlbiA9PT0gJ3N0cmluZycgJiYgaGVhZGVyVG9rZW4udHJpbSgpKSB7XG4gICAgcmV0dXJuIGhlYWRlclRva2VuLnRyaW0oKTtcbiAgfVxuXG4gIGNvbnN0IHF1ZXJ5VG9rZW4gPSByZXEucXVlcnkudG9rZW47XG4gIGlmICh0eXBlb2YgcXVlcnlUb2tlbiA9PT0gJ3N0cmluZycgJiYgcXVlcnlUb2tlbi50cmltKCkpIHtcbiAgICByZXR1cm4gcXVlcnlUb2tlbi50cmltKCk7XG4gIH1cblxuICBjb25zdCBib2R5VG9rZW4gPSBib2R5Py50b2tlbjtcbiAgaWYgKHR5cGVvZiBib2R5VG9rZW4gPT09ICdzdHJpbmcnICYmIGJvZHlUb2tlbi50cmltKCkpIHtcbiAgICByZXR1cm4gYm9keVRva2VuLnRyaW0oKTtcbiAgfVxuXG4gIHJldHVybiAnJztcbn1cblxuZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcbiAgcmV0dXJuIEJvb2xlYW4odmFsdWUpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgIUFycmF5LmlzQXJyYXkodmFsdWUpO1xufVxuXG5mdW5jdGlvbiBzYW5pdGl6ZVBhdGNoKGlucHV0OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikge1xuICBjb25zdCB1bmtub3duS2V5czogc3RyaW5nW10gPSBbXTtcbiAgY29uc3Qgc2FuaXRpemVkOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9O1xuXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGlucHV0KSkge1xuICAgIGlmICghYWxsb3dlZEZpZWxkS2V5cy5oYXMoa2V5KSkge1xuICAgICAgdW5rbm93bktleXMucHVzaChrZXkpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzYW5pdGl6ZWRba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IHNhbml0aXplZCwgdW5rbm93bktleXMgfTtcbn1cblxuZnVuY3Rpb24gdG9TdHJpbmdPck51bGwodmFsdWU6IHVua25vd24pOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHJldHVybiBudWxsO1xuICBjb25zdCB0cmltbWVkID0gdmFsdWUudHJpbSgpO1xuICByZXR1cm4gdHJpbW1lZC5sZW5ndGggPiAwID8gdHJpbW1lZCA6IG51bGw7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkQ2xpZW50RGlzcGxheU5hbWUocGF5bG9hZDogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBzdHJpbmcgfCBudWxsIHtcbiAgY29uc3QgZmlyc3QgPSB0b1N0cmluZ09yTnVsbChwYXlsb2FkLmNsaWVudF9maXJzdF9uYW1lKTtcbiAgY29uc3QgbGFzdCA9IHRvU3RyaW5nT3JOdWxsKHBheWxvYWQuY2xpZW50X2xhc3RfbmFtZSk7XG4gIGlmICghZmlyc3QgJiYgIWxhc3QpIHJldHVybiBudWxsO1xuICByZXR1cm4gW2ZpcnN0LCBsYXN0XS5maWx0ZXIoQm9vbGVhbikuam9pbignICcpLnRyaW0oKSB8fCBudWxsO1xufVxuXG50eXBlIFN1Ym1pdEJvZHkgPSB7XG4gIGludGFrZUlkPzogc3RyaW5nO1xuICBwYXRjaD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICB0b2tlbj86IHN0cmluZztcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgY29uc3QgcmVxdWVzdElkID0gZ2V0UmVxdWVzdElkKHJlcSk7XG4gIGxvZ1JlcXVlc3RTdGFydChyZXEsIHJlcXVlc3RJZCk7XG5cbiAgaWYgKCFyZXF1aXJlTWV0aG9kKHJlcSwgcmVzLCBbJ1BPU1QnXSwgcmVxdWVzdElkKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGJvZHlSZXN1bHQgPSBwYXJzZUpzb25Cb2R5PFN1Ym1pdEJvZHk+KHJlcSwgcmVxdWVzdElkKTtcbiAgaWYgKCFib2R5UmVzdWx0Lm9rKSB7XG4gICAgc2VuZEVycm9yKHJlcywgYm9keVJlc3VsdC5zdGF0dXMsIGJvZHlSZXN1bHQuZXJyb3IsIHJlcXVlc3RJZCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBleHRyYWN0VG9rZW4ocmVxLCBib2R5UmVzdWx0LmRhdGEpO1xuICBpZiAoIXRva2VuKSB7XG4gICAgc2VuZEVycm9yKHJlcywgNDAxLCAnTWlzc2luZyBpbnRha2UgdG9rZW4nLCByZXF1ZXN0SWQpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHRva2VuUmVzdWx0ID0gdmVyaWZ5SW50YWtlVG9rZW4odG9rZW4pO1xuICBpZiAoIXRva2VuUmVzdWx0Lm9rKSB7XG4gICAgc2VuZEVycm9yKHJlcywgdG9rZW5SZXN1bHQuc3RhdHVzLCB0b2tlblJlc3VsdC5lcnJvciwgcmVxdWVzdElkKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBib2R5ID0gYm9keVJlc3VsdC5kYXRhID8/IHt9O1xuICBjb25zdCBpbnRha2VJZCA9IHR5cGVvZiBib2R5LmludGFrZUlkID09PSAnc3RyaW5nJyA/IGJvZHkuaW50YWtlSWQgOiAnJztcbiAgaWYgKCFpbnRha2VJZCkge1xuICAgIHNlbmRFcnJvcihyZXMsIDQwMCwgJ2ludGFrZUlkIGlzIHJlcXVpcmVkJywgcmVxdWVzdElkKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGludGFrZUlkICE9PSB0b2tlblJlc3VsdC5wYXlsb2FkLmludGFrZV9pZCkge1xuICAgIHNlbmRFcnJvcihyZXMsIDQwMywgJ0ludGFrZSB0b2tlbiBkb2VzIG5vdCBtYXRjaCBpbnRha2UnLCByZXF1ZXN0SWQpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHBhdGNoSW5wdXQgPSBib2R5LnBhdGNoID8/IHt9O1xuICBpZiAoIWlzUGxhaW5PYmplY3QocGF0Y2hJbnB1dCkpIHtcbiAgICBzZW5kRXJyb3IocmVzLCA0MDAsICdwYXRjaCBtdXN0IGJlIGFuIG9iamVjdCcsIHJlcXVlc3RJZCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgeyBzYW5pdGl6ZWQsIHVua25vd25LZXlzIH0gPSBzYW5pdGl6ZVBhdGNoKHBhdGNoSW5wdXQpO1xuICBpZiAodW5rbm93bktleXMubGVuZ3RoID4gMCkge1xuICAgIHNlbmRFcnJvcihyZXMsIDQwMCwgYFVua25vd24gaW50YWtlIGZpZWxkczogJHt1bmtub3duS2V5cy5qb2luKCcsICcpfWAsIHJlcXVlc3RJZCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgeyBkYXRhOiBpbnRha2UsIGVycm9yOiBpbnRha2VFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdpbnRha2VzJylcbiAgICAuc2VsZWN0KCdpZCwgZmlybV9pZCwgc3RhdHVzLCBzdWJtaXR0ZWRfYXQsIHJhd19wYXlsb2FkJylcbiAgICAuZXEoJ2lkJywgaW50YWtlSWQpXG4gICAgLmVxKCdmaXJtX2lkJywgdG9rZW5SZXN1bHQucGF5bG9hZC5maXJtX2lkKVxuICAgIC5tYXliZVNpbmdsZSgpO1xuXG4gIGlmIChpbnRha2VFcnJvcikge1xuICAgIHNlbmRFcnJvcihyZXMsIDUwMCwgJ1VuYWJsZSB0byBsb2FkIGludGFrZScsIHJlcXVlc3RJZCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFpbnRha2UpIHtcbiAgICBzZW5kRXJyb3IocmVzLCA0MDQsICdJbnRha2Ugbm90IGZvdW5kJywgcmVxdWVzdElkKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoaW50YWtlLnN1Ym1pdHRlZF9hdCB8fCBpbnRha2Uuc3RhdHVzID09PSAnc3VibWl0dGVkJykge1xuICAgIGxldCB3ZjNSZXN1bHQ6IHsgZXh0cmFjdGlvbl9pZD86IHN0cmluZyB9IHwgbnVsbCA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIHdmM1Jlc3VsdCA9IGF3YWl0IHJ1bldvcmtmbG93M1J1bGVzKHsgaW50YWtlX2lkOiBpbnRha2UuaWQsIGZpcm1faWQ6IGludGFrZS5maXJtX2lkIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbd2YzXSBzdWJtaXQgaG9vayBmYWlsZWQgaW50YWtlX2lkPSR7aW50YWtlLmlkfWAsIGVycm9yKTtcbiAgICB9XG4gICAgaWYgKHdmM1Jlc3VsdD8uZXh0cmFjdGlvbl9pZCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgcnVuV2Y0KHsgaW50YWtlSWQ6IGludGFrZS5pZCwgd2YzUnVuSWQ6IHdmM1Jlc3VsdC5leHRyYWN0aW9uX2lkIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW3dmNF0gc3VibWl0IGhvb2sgZmFpbGVkIGludGFrZV9pZD0ke2ludGFrZS5pZH1gLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IG9rOiB0cnVlLCBsb2NrZWQ6IHRydWUsIHN1Ym1pdHRlZF9hdDogaW50YWtlLnN1Ym1pdHRlZF9hdCB9KTtcbiAgfVxuXG4gIGNvbnN0IHVwZGF0ZVJvdzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7XG4gICAgc3RhdHVzOiAnc3VibWl0dGVkJyxcbiAgICBzdWJtaXR0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgfTtcblxuICBpZiAoT2JqZWN0LmtleXMoc2FuaXRpemVkKS5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZXhpc3RpbmdQYXlsb2FkID0gaXNQbGFpbk9iamVjdChpbnRha2UucmF3X3BheWxvYWQpID8gaW50YWtlLnJhd19wYXlsb2FkIDoge307XG4gICAgY29uc3QgbmV4dFBheWxvYWQgPSBub3JtYWxpemVQYXlsb2FkVG9Eb2N4VjEoeyAuLi5leGlzdGluZ1BheWxvYWQsIC4uLnNhbml0aXplZCB9KTtcbiAgICB1cGRhdGVSb3cucmF3X3BheWxvYWQgPSBuZXh0UGF5bG9hZDtcblxuICAgIGlmIChzYW5pdGl6ZWQuaW50YWtlX2NoYW5uZWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlUm93LmludGFrZV9jaGFubmVsID0gdG9TdHJpbmdPck51bGwoc2FuaXRpemVkLmludGFrZV9jaGFubmVsKTtcbiAgICB9XG4gICAgaWYgKHNhbml0aXplZC5tYXR0ZXJfdHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVSb3cubWF0dGVyX3R5cGUgPSB0b1N0cmluZ09yTnVsbChzYW5pdGl6ZWQubWF0dGVyX3R5cGUpO1xuICAgIH1cbiAgICBpZiAoc2FuaXRpemVkLnVyZ2VuY3lfbGV2ZWwgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdXBkYXRlUm93LnVyZ2VuY3lfbGV2ZWwgPSB0b1N0cmluZ09yTnVsbChzYW5pdGl6ZWQudXJnZW5jeV9sZXZlbCk7XG4gICAgfVxuICAgIGlmIChzYW5pdGl6ZWQubGFuZ3VhZ2VfcHJlZmVyZW5jZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1cGRhdGVSb3cubGFuZ3VhZ2VfcHJlZmVyZW5jZSA9IHRvU3RyaW5nT3JOdWxsKHNhbml0aXplZC5sYW5ndWFnZV9wcmVmZXJlbmNlKTtcbiAgICB9XG5cbiAgICBjb25zdCBkaXNwbGF5TmFtZSA9IGJ1aWxkQ2xpZW50RGlzcGxheU5hbWUobmV4dFBheWxvYWQpO1xuICAgIGlmIChkaXNwbGF5TmFtZSkge1xuICAgICAgdXBkYXRlUm93LmNsaWVudF9kaXNwbGF5X25hbWUgPSBkaXNwbGF5TmFtZTtcbiAgICB9XG4gIH1cblxuICBjb25zdCB7IGRhdGE6IHVwZGF0ZWQsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgIC5mcm9tKCdpbnRha2VzJylcbiAgICAudXBkYXRlKHVwZGF0ZVJvdylcbiAgICAuZXEoJ2lkJywgaW50YWtlSWQpXG4gICAgLmVxKCdmaXJtX2lkJywgdG9rZW5SZXN1bHQucGF5bG9hZC5maXJtX2lkKVxuICAgIC5pcygnc3VibWl0dGVkX2F0JywgbnVsbClcbiAgICAuc2VsZWN0KCdpZCwgc3VibWl0dGVkX2F0JylcbiAgICAubWF5YmVTaW5nbGUoKTtcblxuICBpZiAodXBkYXRlRXJyb3IpIHtcbiAgICBpZiAodXBkYXRlRXJyb3IubWVzc2FnZS5pbmNsdWRlcygnSU5UQUtFX0lNTVVUQUJMRScpKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDkpLmpzb24oeyBvazogZmFsc2UsIGxvY2tlZDogdHJ1ZSwgcmVxdWVzdElkIH0pO1xuICAgIH1cbiAgICBzZW5kRXJyb3IocmVzLCA1MDAsICdVbmFibGUgdG8gc3VibWl0IGludGFrZScsIHJlcXVlc3RJZCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmICghdXBkYXRlZCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwOSkuanNvbih7IG9rOiBmYWxzZSwgbG9ja2VkOiB0cnVlLCByZXF1ZXN0SWQgfSk7XG4gIH1cblxuICBsZXQgd2YzUmVzdWx0OiB7IGV4dHJhY3Rpb25faWQ/OiBzdHJpbmcgfSB8IG51bGwgPSBudWxsO1xuICB0cnkge1xuICAgIHdmM1Jlc3VsdCA9IGF3YWl0IHJ1bldvcmtmbG93M1J1bGVzKHsgaW50YWtlX2lkOiBpbnRha2VJZCwgZmlybV9pZDogdG9rZW5SZXN1bHQucGF5bG9hZC5maXJtX2lkIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYFt3ZjNdIHN1Ym1pdCBob29rIGZhaWxlZCBpbnRha2VfaWQ9JHtpbnRha2VJZH1gLCBlcnJvcik7XG4gIH1cbiAgaWYgKHdmM1Jlc3VsdD8uZXh0cmFjdGlvbl9pZCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBydW5XZjQoeyBpbnRha2VJZCwgd2YzUnVuSWQ6IHdmM1Jlc3VsdC5leHRyYWN0aW9uX2lkIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBbd2Y0XSBzdWJtaXQgaG9vayBmYWlsZWQgaW50YWtlX2lkPSR7aW50YWtlSWR9YCwgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IG9rOiB0cnVlLCBsb2NrZWQ6IHRydWUsIHN1Ym1pdHRlZF9hdDogdXBkYXRlZC5zdWJtaXR0ZWRfYXQgfSk7XG59XG4iXSwibmFtZXMiOlsic3VwYWJhc2VBZG1pbiIsInZlcmlmeUludGFrZVRva2VuIiwiR0FfRElWT1JDRV9DVVNUT0RZX1YxIiwibm9ybWFsaXplUGF5bG9hZFRvRG9jeFYxIiwicnVuV29ya2Zsb3czUnVsZXMiLCJydW5XZjQiLCJnZXRSZXF1ZXN0SWQiLCJsb2dSZXF1ZXN0U3RhcnQiLCJwYXJzZUpzb25Cb2R5IiwicmVxdWlyZU1ldGhvZCIsInNlbmRFcnJvciIsImFsbG93ZWRGaWVsZEtleXMiLCJTZXQiLCJzZWN0aW9ucyIsImZsYXRNYXAiLCJzZWN0aW9uIiwiZmllbGRzIiwiZmlsdGVyIiwiZmllbGQiLCJpc1N5c3RlbSIsIm1hcCIsImtleSIsImV4dHJhY3RUb2tlbiIsInJlcSIsImJvZHkiLCJhdXRoSGVhZGVyIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJzdGFydHNXaXRoIiwic2xpY2UiLCJsZW5ndGgiLCJ0cmltIiwiaGVhZGVyVG9rZW4iLCJxdWVyeVRva2VuIiwicXVlcnkiLCJ0b2tlbiIsImJvZHlUb2tlbiIsImlzUGxhaW5PYmplY3QiLCJ2YWx1ZSIsIkJvb2xlYW4iLCJBcnJheSIsImlzQXJyYXkiLCJzYW5pdGl6ZVBhdGNoIiwiaW5wdXQiLCJ1bmtub3duS2V5cyIsInNhbml0aXplZCIsIk9iamVjdCIsImVudHJpZXMiLCJoYXMiLCJwdXNoIiwidW5kZWZpbmVkIiwidG9TdHJpbmdPck51bGwiLCJ0cmltbWVkIiwiYnVpbGRDbGllbnREaXNwbGF5TmFtZSIsInBheWxvYWQiLCJmaXJzdCIsImNsaWVudF9maXJzdF9uYW1lIiwibGFzdCIsImNsaWVudF9sYXN0X25hbWUiLCJqb2luIiwiaGFuZGxlciIsInJlcyIsInJlcXVlc3RJZCIsImJvZHlSZXN1bHQiLCJvayIsInN0YXR1cyIsImVycm9yIiwiZGF0YSIsInRva2VuUmVzdWx0IiwiaW50YWtlSWQiLCJpbnRha2VfaWQiLCJwYXRjaElucHV0IiwicGF0Y2giLCJpbnRha2UiLCJpbnRha2VFcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsImZpcm1faWQiLCJtYXliZVNpbmdsZSIsInN1Ym1pdHRlZF9hdCIsIndmM1Jlc3VsdCIsImlkIiwiY29uc29sZSIsImV4dHJhY3Rpb25faWQiLCJ3ZjNSdW5JZCIsImpzb24iLCJsb2NrZWQiLCJ1cGRhdGVSb3ciLCJEYXRlIiwidG9JU09TdHJpbmciLCJrZXlzIiwiZXhpc3RpbmdQYXlsb2FkIiwicmF3X3BheWxvYWQiLCJuZXh0UGF5bG9hZCIsImludGFrZV9jaGFubmVsIiwibWF0dGVyX3R5cGUiLCJ1cmdlbmN5X2xldmVsIiwibGFuZ3VhZ2VfcHJlZmVyZW5jZSIsImRpc3BsYXlOYW1lIiwiY2xpZW50X2Rpc3BsYXlfbmFtZSIsInVwZGF0ZWQiLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsImlzIiwibWVzc2FnZSIsImluY2x1ZGVzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/intake/submit.ts\n");

/***/ }),

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fintake%2Fsubmit&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fintake%2Fsubmit.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();