(()=>{var a={};a.id=620,a.ids=[220,620,636],a.modules={361:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},2015:a=>{"use strict";a.exports=require("react")},2326:a=>{"use strict";a.exports=require("react-dom")},3873:a=>{"use strict";a.exports=require("path")},3939:a=>{"use strict";a.exports=require("@supabase/supabase-js")},4075:a=>{"use strict";a.exports=require("zlib")},6060:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},7910:a=>{"use strict";a.exports=require("stream")},8444:(a,b,c)=>{"use strict";c.r(b),c.d(b,{config:()=>v,default:()=>r,getServerSideProps:()=>u,getStaticPaths:()=>t,getStaticProps:()=>s,handler:()=>D,reportWebVitals:()=>w,routeModule:()=>C,unstable_getServerProps:()=>A,unstable_getServerSideProps:()=>B,unstable_getStaticParams:()=>z,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>x});var d={};c.r(d),c.d(d,{default:()=>p});var e=c(2636),f=c(4850),g=c(3410),h=c(9382),i=c(2627),j=c(8732),k=c(9247),l=c.n(k),m=c(8038),n=c(2015),o=c(484);function p(){let a=(0,m.useRouter)(),[b,c]=(0,n.useState)("auth"),[d,e]=(0,n.useState)("Finishing sign-in…"),[f,g]=(0,n.useState)("signIn"),h=(0,n.useCallback)(async()=>{c("auth"),e("Finishing sign-in…"),g("signIn");try{let{accessToken:b,refreshToken:d}=(a=>{let b=new URLSearchParams(a.startsWith("#")?a.slice(1):a);return{accessToken:b.get("access_token")??void 0,refreshToken:b.get("refresh_token")??void 0}})(window.location.hash);if(b&&d){let{error:a}=await o.N.auth.setSession({access_token:b,refresh_token:d}),{data:c}=await o.N.auth.getSession();if(!c.session)throw Error(a?.message?`Unable to complete sign-in: ${a.message}`:"Unable to complete sign-in. Please try the invite link again.");window.history.replaceState({},document.title,window.location.pathname+window.location.search)}else{let a=o.N.auth.exchangeCodeForSession;if("function"==typeof a){let{error:b}=await a(window.location.href);if(b)throw b}let{data:b}=await o.N.auth.getSession();if(!b.session)throw Error("We could not complete sign-in. Please try the invite link again.")}c("claim"),e("Claiming firm access…"),g("claim");let{error:f}=await o.N.rpc("claim_firm_membership");if(f)throw f;g("redirect"),a.replace("/myclient/app")}catch(a){console.error("Auth callback error",a),c("error"),e(a instanceof Error?a.message:"Unable to finish sign-in. Please try again.")}},[a]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(l(),{children:(0,j.jsx)("title",{children:"MyClient"})}),(0,j.jsx)("div",{className:"min-h-screen bg-[var(--surface-0)] px-6 py-20 text-[color:var(--text-1)]",children:(0,j.jsxs)("div",{className:"mx-auto max-w-md rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8 text-center shadow-2xl",children:[(0,j.jsx)("p",{className:"text-sm uppercase tracking-[0.35em] text-[color:var(--accent-soft)]",children:"MyClient"}),(0,j.jsx)("h1",{className:"mt-4 text-3xl font-semibold text-white",children:"error"===b?"Setup failed":"Finishing setup"}),(0,j.jsxs)("p",{className:"mt-3 text-xs uppercase tracking-[0.2em] text-[color:var(--text-2)]",children:["Step: ",f]}),(0,j.jsx)("p",{className:"mt-4 text-[color:var(--text-2)]",children:d}),"error"===b&&(0,j.jsx)("button",{onClick:h,className:"mt-6 w-full rounded-lg bg-[color:var(--accent-light)] px-4 py-2 font-semibold text-white hover:bg-[color:var(--accent)] transition",children:"Try again"})]})})]})}var q=c(6104);let r=(0,g.M)(d,"default"),s=(0,g.M)(d,"getStaticProps"),t=(0,g.M)(d,"getStaticPaths"),u=(0,g.M)(d,"getServerSideProps"),v=(0,g.M)(d,"config"),w=(0,g.M)(d,"reportWebVitals"),x=(0,g.M)(d,"unstable_getStaticProps"),y=(0,g.M)(d,"unstable_getStaticPaths"),z=(0,g.M)(d,"unstable_getStaticParams"),A=(0,g.M)(d,"unstable_getServerProps"),B=(0,g.M)(d,"unstable_getServerSideProps"),C=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/auth/callback",pathname:"/auth/callback",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:i.default,Document:h.default},userland:d}),D=(0,q.U)({srcPage:"/auth/callback",config:v,userland:d,routeModule:C,getStaticPaths:t,getStaticProps:s,getServerSideProps:u})},8732:a=>{"use strict";a.exports=require("react/jsx-runtime")},9021:a=>{"use strict";a.exports=require("fs")},9247:(a,b,c)=>{a.exports=c(6186)},9382:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(8732),e=c(6030);function f(){return(0,d.jsxs)(e.Html,{lang:"en",children:[(0,d.jsx)(e.Head,{children:(0,d.jsx)("link",{rel:"icon",href:"/favicon.svg",type:"image/svg+xml"})}),(0,d.jsxs)("body",{children:[(0,d.jsx)(e.Main,{}),(0,d.jsx)(e.NextScript,{})]})]})}}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[978,708,30,791,627],()=>b(b.s=8444));module.exports=c})();