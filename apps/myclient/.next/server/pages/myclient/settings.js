(()=>{var a={};a.id=653,a.ids=[220,636,653],a.modules={361:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},2015:a=>{"use strict";a.exports=require("react")},2326:a=>{"use strict";a.exports=require("react-dom")},3873:a=>{"use strict";a.exports=require("path")},3939:a=>{"use strict";a.exports=require("@supabase/supabase-js")},4075:a=>{"use strict";a.exports=require("zlib")},4325:(a,b,c)=>{"use strict";c.r(b),c.d(b,{config:()=>A,default:()=>w,getServerSideProps:()=>z,getStaticPaths:()=>y,getStaticProps:()=>x,handler:()=>I,reportWebVitals:()=>B,routeModule:()=>H,unstable_getServerProps:()=>F,unstable_getServerSideProps:()=>G,unstable_getStaticParams:()=>E,unstable_getStaticPaths:()=>D,unstable_getStaticProps:()=>C});var d={};c.r(d),c.d(d,{default:()=>u});var e=c(2636),f=c(4850),g=c(3410),h=c(9382),i=c(2627),j=c(8732),k=c(9247),l=c.n(k),m=c(953),n=c.n(m),o=c(2015),p=c(8038),q=c(484),r=c(6955),s=c(5833),t=c(8688);function u(){(0,p.useRouter)();let{state:a}=(0,r._)(),[b,c]=(0,o.useState)(null),[d,e]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!1),[h,i]=(0,o.useState)(null),[k,m]=(0,o.useState)(!1),[u,v]=(0,o.useState)(""),[w,x]=(0,o.useState)(!1),y=async()=>{b?.id&&navigator.clipboard&&(await navigator.clipboard.writeText(b.id),x(!0),setTimeout(()=>x(!1),1500))},z=async()=>{if(!b||!a.firmId)return;g(!0),m(!1),i(null);let d=u.trim(),{error:e}=await q.N.from("firms").update({name:d}).eq("id",a.firmId);if(e){i(e.message.toLowerCase().includes("permission")?"You do not have permission to update firm settings.":e.message),g(!1);return}await (0,t.M)(q.N,{firm_id:a.firmId,event_type:"firm_updated",message:"Firm name updated",metadata:{old_name:b.name,new_name:d}}),c({...b,name:d}),m(!0),g(!1)};return a.loading?(0,j.jsx)("p",{className:"text-[color:var(--text-2)]",children:"Loading..."}):a.authed?(0,s.jR)(a.role)?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(l(),{children:(0,j.jsx)("title",{children:"MyClient | Firm Settings"})}),(0,j.jsxs)("div",{className:"mx-auto max-w-4xl space-y-6",children:[(0,j.jsxs)("div",{children:[(0,j.jsx)(n(),{href:"/myclient/app",className:"text-sm text-[color:var(--text-2)] hover:text-white transition",children:"← Back"}),(0,j.jsx)("h1",{className:"mt-3 text-3xl font-semibold text-white",children:"Firm Settings"})]}),(0,j.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8 shadow-2xl",children:[(0,j.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Firm Profile"}),(0,j.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-2)]",children:"Update the details that appear across MyClient."}),d?(0,j.jsx)("p",{className:"mt-6 text-sm text-[color:var(--text-2)]",children:"Loading firm profile..."}):b?(0,j.jsxs)("div",{className:"mt-6 grid gap-6",children:[(0,j.jsxs)("label",{className:"grid gap-2 text-sm text-[color:var(--text-2)]",children:["Firm name",(0,j.jsx)("input",{value:u,onChange:a=>v(a.target.value),className:"rounded-lg border border-white/10 bg-[var(--surface-0)] px-4 py-2 text-base text-white outline-none focus:ring-2 focus:ring-[color:var(--accent)]"})]}),(0,j.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,j.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-[var(--surface-0)] p-4",children:[(0,j.jsx)("p",{className:"text-xs uppercase tracking-wide text-[color:var(--text-2)]",children:"Firm ID"}),(0,j.jsx)("p",{className:"mt-2 text-sm text-white",children:b.id}),(0,j.jsx)("button",{type:"button",onClick:y,className:"mt-3 text-xs text-[color:var(--accent-light)] hover:text-white transition",children:w?"Copied":"Copy"})]}),(0,j.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-[var(--surface-0)] p-4",children:[(0,j.jsx)("p",{className:"text-xs uppercase tracking-wide text-[color:var(--text-2)]",children:"Created"}),(0,j.jsx)("p",{className:"mt-2 text-sm text-white",children:new Date(b.created_at).toLocaleDateString()})]})]}),h&&(0,j.jsx)("div",{className:"rounded-lg border border-red-400/30 bg-red-500/10 px-4 py-2 text-sm text-red-200",children:h}),k&&(0,j.jsx)("p",{className:"text-sm text-emerald-300",children:"Saved"}),(0,j.jsx)("div",{children:(0,j.jsx)("button",{type:"button",onClick:z,disabled:f||!u.trim(),className:"rounded-lg bg-[color:var(--accent-light)] px-4 py-2 text-sm font-semibold text-white hover:bg-[color:var(--accent)] disabled:cursor-not-allowed disabled:opacity-60",children:f?"Saving...":"Save changes"})})]}):(0,j.jsx)("p",{className:"mt-6 text-sm text-[color:var(--text-2)]",children:"Firm profile not found."})]}),(0,j.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8",children:[(0,j.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Coming soon"}),(0,j.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-2)]",children:"Defaults and presets will land here next."}),(0,j.jsxs)("ul",{className:"mt-4 grid gap-3 text-sm text-[color:var(--text-2)]",children:[(0,j.jsx)("li",{children:"Default jurisdiction"}),(0,j.jsx)("li",{children:"Document type presets"}),(0,j.jsx)("li",{children:"Firm branding"})]})]})]})]}):(0,j.jsxs)("div",{className:"mx-auto max-w-3xl rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8",children:[(0,j.jsx)(n(),{href:"/myclient/app",className:"text-sm text-[color:var(--text-2)] hover:text-white transition",children:"← Back"}),(0,j.jsx)("h1",{className:"mt-4 text-2xl font-semibold text-white",children:"Firm Settings"}),(0,j.jsx)("p",{className:"mt-3 text-sm text-[color:var(--text-2)]",children:"Admin only. Please contact your firm admin."}),(0,j.jsx)(n(),{href:"/myclient/app",className:"mt-6 inline-flex items-center justify-center rounded-lg border border-white/10 px-4 py-2 text-sm text-white hover:bg-white/5",children:"Return to dashboard"})]}):(0,j.jsx)("p",{className:"text-[color:var(--text-2)]",children:"Redirecting to sign in..."})}var v=c(6104);let w=(0,g.M)(d,"default"),x=(0,g.M)(d,"getStaticProps"),y=(0,g.M)(d,"getStaticPaths"),z=(0,g.M)(d,"getServerSideProps"),A=(0,g.M)(d,"config"),B=(0,g.M)(d,"reportWebVitals"),C=(0,g.M)(d,"unstable_getStaticProps"),D=(0,g.M)(d,"unstable_getStaticPaths"),E=(0,g.M)(d,"unstable_getStaticParams"),F=(0,g.M)(d,"unstable_getServerProps"),G=(0,g.M)(d,"unstable_getServerSideProps"),H=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/myclient/settings",pathname:"/myclient/settings",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:i.default,Document:h.default},userland:d}),I=(0,v.U)({srcPage:"/myclient/settings",config:A,userland:d,routeModule:H,getStaticPaths:y,getStaticProps:x,getServerSideProps:z})},5833:(a,b,c)=>{"use strict";function d(a){if("string"!=typeof a)return null;let b=a.toLowerCase();return"admin"===b||"attorney"===b||"staff"===b?b:null}function e(a){let b=d(a);return"admin"===b||"attorney"===b}function f(a){let b=d(a);return"admin"===b||"attorney"===b}function g(a){let b=d(a);return"admin"===b||"attorney"===b}function h(a){return"admin"===d(a)}c.d(b,{TX:()=>f,Ue:()=>e,gL:()=>g,jR:()=>h})},6060:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},7910:a=>{"use strict";a.exports=require("stream")},8688:(a,b,c)=>{"use strict";async function d(a,b){try{await a.from("case_activity").insert({firm_id:b.firm_id,case_id:b.case_id??null,actor_user_id:b.actor_user_id??null,event_type:b.event_type,message:b.message,metadata:b.metadata??{}})}catch{}}c.d(b,{M:()=>d})},8732:a=>{"use strict";a.exports=require("react/jsx-runtime")},9021:a=>{"use strict";a.exports=require("fs")},9247:(a,b,c)=>{a.exports=c(6186)},9382:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(8732),e=c(6030);function f(){return(0,d.jsxs)(e.Html,{lang:"en",children:[(0,d.jsx)(e.Head,{children:(0,d.jsx)("link",{rel:"icon",href:"/favicon.svg",type:"image/svg+xml"})}),(0,d.jsxs)("body",{children:[(0,d.jsx)(e.Main,{}),(0,d.jsx)(e.NextScript,{})]})]})}}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[978,708,30,791,627],()=>b(b.s=4325));module.exports=c})();