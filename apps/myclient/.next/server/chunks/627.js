exports.id=627,exports.ids=[627],exports.modules={484:(a,b,c)=>{"use strict";c.d(b,{N:()=>g});var d=c(3939);let e=process.env.NEXT_PUBLIC_SUPABASE_URL,f=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;if(!e||!f)throw Error("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY");let g=(0,d.createClient)(e,f,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},2627:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>t});var d=c(8732),e=c(8038);c(9063);var f=c(6955),g=c(968),h=c.n(g),i=c(953),j=c.n(i),k=c(2015),l=c(7574),m=c(484);function n({user:a,role:b,firmName:c,firmId:e,onSignOut:f}){let[g,h]=(0,k.useState)(!1),i=(0,k.useRef)(null),l=a?.full_name?.trim()||(a?.email?a.email.split("@")[0]:""),m=a?.full_name?.trim().split(/\s+/)[0],n=m?`Hello, ${m}`:"Hello",o=c?.trim()||"—",p=e?e.slice(0,8):"—";return(0,d.jsxs)("div",{ref:i,className:"relative",children:[(0,d.jsx)("button",{type:"button",onClick:()=>h(a=>!a),className:"flex items-center gap-2 rounded-full border border-white/15 bg-[var(--surface-0)] px-2 py-1.5 text-sm text-white hover:bg-white/10","aria-haspopup":"menu","aria-expanded":g,children:a?.avatar_url?(0,d.jsx)("img",{src:a.avatar_url,alt:l,className:"h-8 w-8 rounded-full object-cover"}):(0,d.jsx)("span",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-[color:var(--accent)] text-xs font-semibold text-white",children:function(a){let b=a?.full_name?.trim();if(b){let a=b.split(/\s+/),c=a[0]?.[0]??"",d=a.length>1?a[a.length-1]?.[0]??"":"";return`${c}${d}`.toUpperCase()||"U"}return((a?.email??"").split("@")[0]??"").slice(0,2).toUpperCase()||"U"}(a)})}),g&&(0,d.jsxs)("div",{className:"absolute right-0 mt-3 w-64 rounded-2xl border border-white/10 bg-[var(--surface-1)] p-4 text-sm text-[color:var(--text-1)] shadow-2xl",role:"menu",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{className:"text-base font-semibold text-white",children:n}),(0,d.jsx)("div",{className:"text-xs text-[color:var(--text-2)]",children:l||"User"}),a?.email&&(0,d.jsx)("div",{className:"text-xs text-[color:var(--text-2)]",children:a.email}),b&&(0,d.jsx)("span",{className:"inline-flex rounded-full border border-white/15 px-2 py-0.5 text-[10px] uppercase tracking-wide text-[color:var(--text-2)]",children:b})]}),(0,d.jsxs)("div",{className:"mt-4 rounded-xl border border-white/10 bg-[var(--surface-0)] p-3",children:[(0,d.jsx)("div",{className:"text-xs uppercase tracking-wide text-[color:var(--text-2)]",children:"Firm"}),(0,d.jsx)("div",{className:"mt-1 text-sm text-white",children:o}),(0,d.jsxs)("div",{className:"mt-1 text-xs text-[color:var(--text-2)]",children:["Firm ID: ",p]})]}),(0,d.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,d.jsx)(j(),{href:"/myclient/profile",className:"block rounded-lg px-3 py-2 hover:bg-white/5",role:"menuitem",children:"Edit Profile"}),(0,d.jsx)(j(),{href:"/myclient/members",className:"block rounded-lg px-3 py-2 hover:bg-white/5",role:"menuitem",children:"My Team"}),(0,d.jsx)(j(),{href:"/myclient/settings",className:"block rounded-lg px-3 py-2 hover:bg-white/5",role:"menuitem",children:"Settings"}),(0,d.jsx)(j(),{href:"/myclient/upgrade",className:"block rounded-lg border border-[color:var(--accent-light)] bg-[color:var(--accent-light)]/10 px-3 py-2 text-[color:var(--accent-soft)] hover:bg-[color:var(--accent-light)] hover:text-white",role:"menuitem",children:"Upgrade"})]}),(0,d.jsx)("div",{className:"my-4 h-px bg-white/10"}),(0,d.jsx)("button",{type:"button",onClick:f,className:"w-full rounded-lg px-3 py-2 text-left text-sm text-red-200 hover:bg-white/5",role:"menuitem",children:"Sign out"})]})]})}let o=[{href:"/myclient/app",label:"Dashboard",icon:l.HxJ},{href:"/myclient/cases",label:"Active Cases",icon:l.ZHz},{href:"/myclient/intake",label:"New Intake",icon:l.PEg},{href:"/myclient/documents",label:"Documents",icon:l.BmN},{href:"/myclient/members",label:"My Team",icon:l.zWC},{href:"/myclient/settings",label:"Settings",icon:l.wB_},{href:"/myclient/upgrade",label:"Upgrade",icon:l.sUz,highlight:!0}];function p({currentPath:a,mode:b="desktop",open:c=!1,onClose:e}){let[f,g]=(0,k.useState)(!1),h="mobile"===b,i=h||f;return(0,d.jsxs)(d.Fragment,{children:[h&&(0,d.jsx)("button",{type:"button","aria-label":"Close navigation",onClick:e,className:["fixed inset-0 z-30 bg-black/40 backdrop-blur-[1px] transition-opacity",c?"opacity-100":"pointer-events-none opacity-0"].join(" ")}),(0,d.jsx)("aside",{onMouseEnter:()=>{h||g(!0)},onMouseLeave:()=>{h||g(!1)},className:["fixed left-0 top-16 z-40 h-[calc(100vh-64px)] border-r border-[color:var(--border)] bg-[rgba(10,10,12,0.92)] backdrop-blur transition-all duration-200 ease-out",h?"w-64":i?"w-56":"w-16",h?c?"translate-x-0":"-translate-x-full":"translate-x-0"].join(" "),children:(0,d.jsx)("div",{className:"flex h-full flex-col gap-3 px-3 py-4",children:(0,d.jsx)("nav",{className:"flex flex-1 flex-col gap-1",children:o.map(b=>{let c=a===b.href,f=b.icon;return(0,d.jsxs)(j(),{href:b.href,title:i?void 0:b.label,className:["relative flex items-center gap-3 rounded-xl px-3 py-2 text-sm transition",c?"bg-white/10 text-white":"text-[color:var(--muted)] hover:text-white hover:bg-white/5",b.highlight?"border border-[color:var(--accent-light)]/60 text-[color:var(--accent-soft)]":""].join(" "),onClick:h?e:void 0,children:[(0,d.jsx)("span",{className:["absolute left-1 top-1/2 h-5 w-0.5 -translate-y-1/2 rounded-full bg-[color:var(--accent)] transition-opacity",c?"opacity-100":"opacity-0"].join(" ")}),(0,d.jsx)("span",{className:["relative flex h-8 w-8 items-center justify-center rounded-lg transition",c&&!i?"bg-[color:var(--accent)]/15 text-white":""].join(" "),children:(0,d.jsx)(f,{className:"h-4 w-4"})}),(0,d.jsx)("span",{className:["whitespace-nowrap transition-opacity duration-200",i?"opacity-100":"opacity-0"].join(" "),children:b.label})]},b.href)})})})})]})}function q({limit:a=10}){let{state:b}=(0,f._)(),[c,e]=(0,k.useState)([]),[g,h]=(0,k.useState)(null);return b.firmId?g?(0,d.jsx)("p",{className:"text-xs text-red-300",children:g}):0===c.length?(0,d.jsx)("p",{className:"text-sm text-[color:var(--text-2)]",children:"No recent activity."}):(0,d.jsx)("ul",{className:"space-y-3 text-sm text-[color:var(--text-2)]",children:c.map(a=>(0,d.jsx)("li",{className:"rounded-xl border border-white/10 bg-[var(--surface-0)] px-3 py-2",children:(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[a.case_id?(0,d.jsx)(j(),{href:`/myclient/cases/${a.case_id}`,className:"text-white hover:text-[color:var(--accent-soft)]",children:a.message}):(0,d.jsx)("p",{className:"text-white",children:a.message}),(0,d.jsx)("span",{className:"text-xs text-[color:var(--text-2)]",children:new Date(a.created_at).toLocaleString()})]})},a.id))}):(0,d.jsx)("p",{className:"text-sm text-[color:var(--text-2)]",children:"No activity yet."})}function r({open:a,onClose:b}){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{type:"button","aria-label":"Close activity",className:["fixed inset-0 z-40 bg-black/40 backdrop-blur-[1px] transition-opacity",a?"opacity-100":"pointer-events-none opacity-0"].join(" "),onClick:b}),(0,d.jsx)("aside",{"aria-label":"Activity panel",className:["fixed right-0 top-16 z-50 h-[calc(100vh-64px)] w-full max-w-[420px] border-l border-[color:var(--border)] bg-[var(--surface-0)] shadow-2xl transition-transform duration-300",a?"translate-x-0":"translate-x-full pointer-events-none"].join(" "),children:(0,d.jsxs)("div",{className:"flex h-full flex-col",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between border-b border-[color:var(--border)] px-5 py-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Activity"}),(0,d.jsx)(j(),{href:"/myclient/activity",onClick:b,className:"rounded-lg border border-white/15 px-2.5 py-1 text-xs text-[color:var(--muted)] hover:text-white",children:"View all"})]}),(0,d.jsx)("button",{type:"button","aria-label":"Close activity",onClick:b,className:"rounded-lg border border-white/10 p-1.5 text-[color:var(--muted)] hover:text-white",children:(0,d.jsx)(l.X,{className:"h-4 w-4"})})]}),(0,d.jsx)("div",{className:"flex-1 overflow-y-auto px-5 py-6",children:(0,d.jsx)(q,{limit:10})})]})})]})}function s({children:a}){let b=(0,e.useRouter)(),{state:c}=(0,f._)(),[g,i]=(0,k.useState)(null),[o,q]=(0,k.useState)(null),[s,t]=(0,k.useState)(!1),[u,v]=(0,k.useState)(!1),[w,x]=(0,k.useState)(!1),y=async()=>{await m.N.auth.signOut(),b.replace("/auth/sign-in")},z=c.authed&&(!g?.user?.full_name||!g.user.full_name.trim());return(0,d.jsxs)("div",{className:"min-h-screen bg-[var(--surface-0)] text-[color:var(--text-1)]",children:[(0,d.jsx)("header",{className:"fixed left-0 right-0 top-0 z-50 h-16 border-b border-[color:var(--border)] bg-[rgba(10,10,12,0.88)] backdrop-blur",children:(0,d.jsxs)("div",{className:"flex h-full items-center justify-between px-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[c.authed&&(0,d.jsx)("button",{type:"button","aria-label":"Open navigation",onClick:()=>x(!0),className:"rounded-full border border-[color:var(--border)] bg-white/5 p-2 text-[color:var(--muted)] hover:text-white md:hidden",children:(0,d.jsx)(l.W1t,{className:"h-4 w-4"})}),(0,d.jsxs)(j(),{href:"/myclient/app",className:"relative flex items-center",children:[(0,d.jsx)(h(),{src:"/verilex-logo-name-lightmode.svg",alt:"VeriLex",width:140,height:36,priority:!0,className:"object-contain transition-opacity duration-300 dark:opacity-0"}),(0,d.jsx)(h(),{src:"/verilex-logo-name-darkmode.svg",alt:"VeriLex",width:140,height:36,priority:!0,className:"absolute inset-0 object-contain opacity-0 transition-opacity duration-300 dark:opacity-100"})]})]}),c.authed&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("button",{type:"button","aria-label":"Open activity",onClick:()=>t(!0),className:"rounded-full border border-[color:var(--border)] bg-[var(--surface-0)] p-2 text-[color:var(--muted)] hover:text-white hover:bg-white/10",children:(0,d.jsx)(l.BZB,{className:"h-4 w-4"})}),(0,d.jsx)(n,{user:g?.user??null,role:g?.membership?.role??c.role??null,firmName:g?.firm?.name??null,firmId:g?.membership?.firm_id??c.firmId??null,onSignOut:y})]})]})}),(0,d.jsxs)("div",{className:"flex min-h-screen pt-16",children:[c.authed&&(0,d.jsx)(p,{currentPath:b.pathname,mode:u?"mobile":"desktop",open:w,onClose:()=>x(!1)}),(0,d.jsxs)("div",{className:"flex min-h-screen flex-1 flex-col",children:[c.authed&&(0,d.jsx)(r,{open:s,onClose:()=>t(!1)}),c.authed?(0,d.jsxs)("main",{className:"py-10 pr-4 pl-4 md:pr-6 md:pl-16",children:[o&&(0,d.jsx)("div",{className:"mx-auto mb-6 max-w-6xl rounded-2xl border border-red-400/30 bg-red-500/10 px-4 py-3 text-sm text-red-200",children:o}),z&&(0,d.jsxs)("div",{className:"mx-auto mb-6 flex max-w-6xl flex-col items-start justify-between gap-4 rounded-2xl border border-[color:var(--border)] bg-[var(--surface-1)] px-6 py-4 text-sm text-[color:var(--muted)] sm:flex-row sm:items-center",children:[(0,d.jsx)("span",{children:"Finish setting up your profile to personalize VeriLex."}),(0,d.jsx)(j(),{href:"/myclient/profile",className:"inline-flex items-center justify-center rounded-lg bg-[color:var(--accent-light)] px-4 py-2 text-xs font-semibold text-white hover:bg-[color:var(--accent)] transition",children:"Complete Profile"})]}),a]}):(0,d.jsx)("main",{className:"px-6 py-20",children:(0,d.jsxs)("div",{className:"mx-auto max-w-md rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8 text-center shadow-2xl",children:[(0,d.jsx)("h1",{className:"text-3xl font-semibold text-white",children:"MyClient Portal"}),(0,d.jsx)("p",{className:"mt-4 text-[color:var(--text-2)]",children:"Sign in to access your firm workspace."}),(0,d.jsx)("div",{className:"mt-6 flex justify-center",children:(0,d.jsx)(j(),{href:"/auth/sign-in",className:"inline-flex items-center justify-center rounded-lg bg-[color:var(--accent-light)] px-5 py-2.5 font-semibold text-white hover:bg-[color:var(--accent)] transition",children:"Sign in"})})]})})]})]})]})}function t({Component:a,pageProps:b}){return(0,e.useRouter)().pathname.startsWith("/myclient")?(0,d.jsx)(f.e,{children:(0,d.jsx)(s,{children:(0,d.jsx)(a,{...b})})}):(0,d.jsx)(a,{...b})}},6955:(a,b,c)=>{"use strict";c.d(b,{e:()=>i,_:()=>j});var d=c(8732),e=c(2015),f=c(484);let g={loading:!0,authed:!1,email:null,userId:null,firmId:null,role:null,error:null},h=(0,e.createContext)(null);function i({children:a}){let{state:b,refresh:c}=function(){let[a,b]=(0,e.useState)(g);return{state:a,refresh:(0,e.useCallback)(async()=>{b(a=>({...a,loading:!0,error:null}));let{data:a,error:c}=await f.N.auth.getSession();if(c||!a.session?.user)return void b({loading:!1,authed:!1,email:null,userId:null,firmId:null,role:null,error:c?c.message:null});let d=a.session.user.id,e=a.session.user.email??null,{data:g,error:h}=await f.N.from("firm_members").select("firm_id, role").eq("user_id",d).limit(1),i=Array.isArray(g)&&g.length>0?g[0]:null;b({loading:!1,authed:!0,email:e,userId:d,firmId:i?.firm_id??null,role:i?.role??null,error:h?h.message:null})},[])}}();return(0,d.jsx)(h.Provider,{value:{state:b,refresh:c},children:a})}function j(){let a=(0,e.useContext)(h);if(!a)throw Error("useFirm must be used within FirmProvider");return a}},9063:()=>{}};