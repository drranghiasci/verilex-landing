(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{3263:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/myclient/profile",function(){return l(5236)}])},5236:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>u});var s=l(6029),r=l(5669),a=l.n(r),n=l(2203),i=l.n(n),o=l(5729),c=l(5054);function u(){let[e,t]=(0,o.useState)(!0),[l,r]=(0,o.useState)(null),[n,u]=(0,o.useState)(null),[d,m]=(0,o.useState)(""),[x,h]=(0,o.useState)(null),[f,p]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=!0;return(async()=>{var l,s,a,n;t(!0),p(null);let{data:i,error:o}=await c.N.auth.getSession();if(o||!(null==(l=i.session)?void 0:l.user)){e&&(p((null==o?void 0:o.message)||"Please sign in."),t(!1));return}let d=i.session.user.id,{data:x,error:h}=await c.N.from("profiles").select("id, email, full_name").eq("id",d).limit(1);if(!e)return;if(h){p(h.message),t(!1);return}let f=Array.isArray(x)&&x.length>0?x[0]:null;r(null!=(a=null!=(s=null==f?void 0:f.email)?s:i.session.user.email)?a:null),u(d),m(null!=(n=null==f?void 0:f.full_name)?n:""),t(!1)})(),()=>{e=!1}},[]);let v=async()=>{var e;h(null),p(null);let{data:t,error:l}=await c.N.auth.getSession();if(l||!(null==(e=t.session)?void 0:e.access_token))return void p((null==l?void 0:l.message)||"Please sign in.");let s=await fetch("/api/myclient/profile/update",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.session.access_token)},body:JSON.stringify({full_name:d})}),r=await s.json().catch(()=>({}));if(!s.ok||!r.ok)return void p(r.error||"Unable to update profile.");h("Saved")};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a(),{children:(0,s.jsx)("title",{children:"MyClient | Profile"})}),(0,s.jsxs)("div",{className:"mx-auto max-w-6xl rounded-2xl border border-[color:var(--border)] bg-[var(--surface-1)] p-8 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsx)(i(),{href:"/myclient/app",className:"text-sm text-[color:var(--muted)] hover:text-white transition",children:"â† Back"}),(0,s.jsx)("h1",{className:"text-3xl font-semibold text-white",children:"Profile"})]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-[color:var(--muted)]",children:"Update your display name for your firm."}),e?(0,s.jsx)("p",{className:"mt-6 text-[color:var(--muted)]",children:"Loading..."}):(0,s.jsxs)("div",{className:"mt-6 space-y-4",children:[l&&(0,s.jsxs)("p",{className:"text-sm text-[color:var(--muted)]",children:["Signed in as ",l]}),n&&(0,s.jsxs)("p",{className:"text-sm text-[color:var(--muted)]",children:["User ID: ",n.slice(0,8)]}),(0,s.jsxs)("label",{className:"block text-sm font-semibold text-white",children:["Full name",(0,s.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"mt-2 w-full rounded-lg border border-[color:var(--border)] bg-[var(--surface-0)] px-4 py-3 text-white outline-none focus:ring-2 focus:ring-[color:var(--accent)]",placeholder:"Your name"})]}),(0,s.jsx)("button",{onClick:v,className:"rounded-lg bg-[color:var(--accent-light)] px-4 py-2 text-sm font-semibold text-white hover:bg-[color:var(--accent)]",children:"Save"}),x&&(0,s.jsx)("p",{className:"text-sm text-green-300",children:x}),f&&(0,s.jsx)("p",{className:"text-sm text-red-300",children:f})]})]})]})}},5669:(e,t,l)=>{e.exports=l(4807)}},e=>{e.O(0,[636,593,792],()=>e(e.s=3263)),_N_E=e.O()}]);