(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{1320:(e,t,r)=>{"use strict";function a(e){if("string"!=typeof e)return null;let t=e.toLowerCase();return"admin"===t||"attorney"===t||"staff"===t?t:null}function s(e){let t=a(e);return"admin"===t||"attorney"===t}function i(e){let t=a(e);return"admin"===t||"attorney"===t}function n(e){let t=a(e);return"admin"===t||"attorney"===t}function l(e){return"admin"===a(e)}r.d(t,{TX:()=>i,Ue:()=>s,gL:()=>n,jR:()=>l})},5669:(e,t,r)=>{e.exports=r(4807)},6638:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(6029),s=r(5669),i=r.n(s),n=r(2203),l=r.n(n),d=r(5729),c=r(1278),o=r(5054),m=r(8638),x=r(1320),u=r(9845);function h(){let e=(0,c.useRouter)(),{state:t}=(0,m._)(),[r,s]=(0,d.useState)(null),[n,h]=(0,d.useState)(!1),[p,f]=(0,d.useState)(!1),[g,v]=(0,d.useState)(null),[b,j]=(0,d.useState)(!1),[w,N]=(0,d.useState)(""),[y,_]=(0,d.useState)(!1);(0,d.useEffect)(()=>{t.loading||t.authed||e.replace("/auth/sign-in")},[e,t.authed,t.loading]),(0,d.useEffect)(()=>{if(!t.authed||!t.firmId)return;let e=!0;return(async()=>{h(!0),v(null);let{data:r,error:a}=await o.N.from("firms").select("id, name, created_at").eq("id",t.firmId).single();if(e){if(a)v(a.message),s(null);else{var i;s(r),N(null!=(i=null==r?void 0:r.name)?i:"")}h(!1)}})(),()=>{e=!1}},[t.authed,t.firmId]);let S=async()=>{(null==r?void 0:r.id)&&navigator.clipboard&&(await navigator.clipboard.writeText(r.id),_(!0),setTimeout(()=>_(!1),1500))},C=async()=>{if(!r||!t.firmId)return;f(!0),j(!1),v(null);let e=w.trim(),{error:a}=await o.N.from("firms").update({name:e}).eq("id",t.firmId);if(a){v(a.message.toLowerCase().includes("permission")?"You do not have permission to update firm settings.":a.message),f(!1);return}await (0,u.M)(o.N,{firm_id:t.firmId,event_type:"firm_updated",message:"Firm name updated",metadata:{old_name:r.name,new_name:e}}),s({...r,name:e}),j(!0),f(!1)};return t.loading?(0,a.jsx)("p",{className:"text-[color:var(--text-2)]",children:"Loading..."}):t.authed?(0,x.jR)(t.role)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"MyClient | Firm Settings"})}),(0,a.jsxs)("div",{className:"mx-auto max-w-4xl space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(l(),{href:"/myclient/app",className:"text-sm text-[color:var(--text-2)] hover:text-white transition",children:"← Back"}),(0,a.jsx)("h1",{className:"mt-3 text-3xl font-semibold text-white",children:"Firm Settings"})]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8 shadow-2xl",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Firm Profile"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-2)]",children:"Update the details that appear across MyClient."}),n?(0,a.jsx)("p",{className:"mt-6 text-sm text-[color:var(--text-2)]",children:"Loading firm profile..."}):r?(0,a.jsxs)("div",{className:"mt-6 grid gap-6",children:[(0,a.jsxs)("label",{className:"grid gap-2 text-sm text-[color:var(--text-2)]",children:["Firm name",(0,a.jsx)("input",{value:w,onChange:e=>N(e.target.value),className:"rounded-lg border border-white/10 bg-[var(--surface-0)] px-4 py-2 text-base text-white outline-none focus:ring-2 focus:ring-[color:var(--accent)]"})]}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-[var(--surface-0)] p-4",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-[color:var(--text-2)]",children:"Firm ID"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-white",children:r.id}),(0,a.jsx)("button",{type:"button",onClick:S,className:"mt-3 text-xs text-[color:var(--accent-light)] hover:text-white transition",children:y?"Copied":"Copy"})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-[var(--surface-0)] p-4",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-[color:var(--text-2)]",children:"Created"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-white",children:new Date(r.created_at).toLocaleDateString()})]})]}),g&&(0,a.jsx)("div",{className:"rounded-lg border border-red-400/30 bg-red-500/10 px-4 py-2 text-sm text-red-200",children:g}),b&&(0,a.jsx)("p",{className:"text-sm text-emerald-300",children:"Saved"}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"button",onClick:C,disabled:p||!w.trim(),className:"rounded-lg bg-[color:var(--accent-light)] px-4 py-2 text-sm font-semibold text-white hover:bg-[color:var(--accent)] disabled:cursor-not-allowed disabled:opacity-60",children:p?"Saving...":"Save changes"})})]}):(0,a.jsx)("p",{className:"mt-6 text-sm text-[color:var(--text-2)]",children:"Firm profile not found."})]}),(0,a.jsxs)("section",{className:"rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white",children:"Coming soon"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-[color:var(--text-2)]",children:"Defaults and presets will land here next."}),(0,a.jsxs)("ul",{className:"mt-4 grid gap-3 text-sm text-[color:var(--text-2)]",children:[(0,a.jsx)("li",{children:"Default jurisdiction"}),(0,a.jsx)("li",{children:"Document type presets"}),(0,a.jsx)("li",{children:"Firm branding"})]})]})]})]}):(0,a.jsxs)("div",{className:"mx-auto max-w-3xl rounded-3xl border border-white/10 bg-[var(--surface-1)] p-8",children:[(0,a.jsx)(l(),{href:"/myclient/app",className:"text-sm text-[color:var(--text-2)] hover:text-white transition",children:"← Back"}),(0,a.jsx)("h1",{className:"mt-4 text-2xl font-semibold text-white",children:"Firm Settings"}),(0,a.jsx)("p",{className:"mt-3 text-sm text-[color:var(--text-2)]",children:"Admin only. Please contact your firm admin."}),(0,a.jsx)(l(),{href:"/myclient/app",className:"mt-6 inline-flex items-center justify-center rounded-lg border border-white/10 px-4 py-2 text-sm text-white hover:bg-white/5",children:"Return to dashboard"})]}):(0,a.jsx)("p",{className:"text-[color:var(--text-2)]",children:"Redirecting to sign in..."})}},7549:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/myclient/settings",function(){return r(6638)}])},9845:(e,t,r)=>{"use strict";async function a(e,t){try{var r,a,s;await e.from("case_activity").insert({firm_id:t.firm_id,case_id:null!=(r=t.case_id)?r:null,actor_user_id:null!=(a=t.actor_user_id)?a:null,event_type:t.event_type,message:t.message,metadata:null!=(s=t.metadata)?s:{}})}catch(e){}}r.d(t,{M:()=>a})}},e=>{e.O(0,[636,593,792],()=>e(e.s=7549)),_N_E=e.O()}]);